_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[49],{AVMw:function(t,e,n){"use strict";n.d(e,"a",(function(){return j}));var a=n("+P9B"),r=n.n(a),i=n("xvhg"),s=n("q1tI"),o=n.n(s),c=n("G7Ku"),u=n("jmRU"),l=n("qw/b"),d=n("3Yy8"),p=n("oun0"),h=n("vWxj"),b=n("nKUr");function j(t){var e=t.onConfirm,n=t.onCancel,a=t.title,s=t.message,j=t.id,f=o.a.useState(!1),x=Object(i.a)(f,2),m=x[0],v=x[1],g=function(){v(!1)},O=function(){n(),g()};return Object(b.jsxs)("div",{children:[Object(b.jsxs)("button",{className:"hover:bg-red-400 text-red-600 hover:text-white transition-colors  text-xs font-normal py-2 px-2 rounded-md",onClick:function(){v(!0)},children:[Object(b.jsx)(r.a,{className:"mr-2 mt-0.5 float float-left"})," Hapus"]}),Object(b.jsxs)(u.a,{open:m,onClose:O,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(b.jsxs)(h.a,{id:"alert-dialog-title",className:"font-bold",children:[" ",a]}),Object(b.jsx)(d.a,{children:Object(b.jsx)(p.a,{id:"alert-dialog-description",children:s})}),Object(b.jsxs)(l.a,{children:[Object(b.jsx)(c.a,{onClick:O,children:"Tidak"}),Object(b.jsx)(c.a,{onClick:function(){e(j),g()},className:"text-red-500",children:"Ya"})]})]})]})}},ctRN:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/pembelian/order_pembelian",function(){return n("ovxt")}])},ovxt:function(t,e,n){"use strict";n.r(e);var a=n("rR1Q"),r=n.n(a),i=n("iJl9"),s=n.n(i),o=n("rg98"),c=n("vJKn"),u=n.n(c),l=n("g4pe"),d=n.n(l),p=n("q1tI"),h=n("kM/w"),b=n("0Jbt"),j=n("PKTO"),f=n("aOJk"),x=n.n(f),m=n("EQeY"),v=n.n(m),g=n("MUZu"),O=n.n(g),k=n("3YMB"),y=n.n(k),w=n("wIya"),C=n.n(w),N=n("FAat"),P=n.n(N),T=n("d76Q"),_=n.n(T),S=n("AVMw"),D=n("20a2"),E=n("nKUr");function B(t){var e,n,a=t.data,r=t.onDelete,i=t.onUpdate,s=t.onPageChange,o=t.onChangeStatusPengiriman,c=t.onChangeStatus,u=Object(D.useRouter)(),l=P.a.Option,d=function(t){console.log(t),r(t)},p=function(){console.log("onCancel")};new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",maximumFractionDigits:0});var h=function(t){return Object(E.jsxs)("div",{children:[Object(E.jsx)("div",{children:Object(E.jsxs)("button",{onClick:function(){return function(t){u.push("order_pembelian/print/"+t.id)}(t)},className:" hover:text-cyan-700 transition-colors  text-xs font-normal py-2 px-2 rounded-md ",children:[Object(E.jsx)(C.a,{className:"mr-2 mt-0.5 float float-left"}),"Cetak"]})}),Object(E.jsx)("div",{children:Object(E.jsxs)("button",{onClick:function(){return function(t){u.push("order_pembelian/print/"+t.id)}(t)},className:" hover:text-cyan-700 transition-colors  text-xs font-normal py-2 px-2 rounded-md ",children:[Object(E.jsx)(y.a,{className:"mr-2 mt-0.5 float float-left"}),"Lihat"]})}),"Diterima"===t.attributes.status?Object(E.jsx)("div",{}):Object(E.jsxs)("button",{onClick:function(){return e=t.id,void i(e);var e},className:" hover:text-cyan-700 transition-colors  text-xs font-normal py-2 px-2 rounded-md ",children:[Object(E.jsx)(O.a,{className:"mr-2 mt-0.5 float float-left"}),"Edit"]}),Object(E.jsx)(S.a,{onCancel:p,onConfirm:d,title:"Hapus Kategori",message:"Kategori yang dihapus tidak dapat dikembalikan lagi. Lanjutkan?",id:t.id})]})},b=[{name:"Tanggal",width:"150px",selector:function(t){var e;return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"id-ID";return new Date(t).toLocaleDateString(e)}(null===(e=t.attributes)||void 0===e?void 0:e.order_date)}},{name:"NO PO",width:"180px",selector:function(t){var e,n;return null!==(e=null===(n=t.attributes)||void 0===n?void 0:n.no_po)&&void 0!==e?e:"-"}},{name:"Lokasi",width:"200px",selector:function(t){var e;return null===(e=t.attributes)||void 0===e?void 0:e.location.data.attributes.name}},{name:Object(E.jsx)("div",{className:"ml-6",children:"Status"}),width:"150px",selector:function(t){return Object(E.jsxs)(P.a,{defaultValue:t.attributes.status,bordered:!1,disabled:"Diterima"===t.attributes.status,onChange:function(e){return c(e,t)},children:[Object(E.jsx)(l,{value:"Dipesan",children:Object(E.jsx)(v.a,{color:"default",children:"Dipesan"})}),Object(E.jsx)(l,{value:"Diterima",children:Object(E.jsx)(v.a,{color:"success",children:"Diterima"})})]})}},{name:"Status Pengiriman",width:"150px",selector:function(t){return Object(E.jsx)(E.Fragment,{children:Object(E.jsxs)(P.a,{defaultValue:t.attributes.delivery_status,bordered:!1,disabled:"Terkirim"===t.attributes.delivery_status,onChange:function(e){return o(e,t)},children:[Object(E.jsx)(l,{value:"Loading",children:Object(E.jsx)(v.a,{color:"default",children:"Loading"})}),Object(E.jsx)(l,{value:"Pending",children:Object(E.jsx)(v.a,{color:"warning",children:"Pending"})}),Object(E.jsx)(l,{value:"Antrian",children:Object(E.jsx)(v.a,{color:"processing",children:"Antrian"})}),Object(E.jsx)(l,{value:"Terkirim",children:Object(E.jsx)(v.a,{color:"success",children:"Terkirim"})})]})})}},{name:"Ditambahkan Oleh",width:"150px",sortable:!0,selector:function(t){var e,n;return null!==(e=null===(n=t.attributes)||void 0===n?void 0:n.added_by)&&void 0!==e?e:"-"}},{name:"Tindakan",width:"250px",selector:function(t){return Object(E.jsx)(E.Fragment,{children:Object(E.jsx)(x.a,{content:h(t),placement:"bottom",trigger:"click",children:Object(E.jsx)("button",{className:" text-cyan-700  transition-colors  text-xs font-normal py-2 rounded-md ",children:"Tindakan"})})})}}];return Object(E.jsx)(_.a,{customStyles:{headerStyle:{textAlign:"center"},headCells:{style:{color:"white",background:"#036B82"}}},onChangePage:s,paginationRowsPerPageOptions:[10],paginationTotalRows:null===a||void 0===a||null===(e=a.meta)||void 0===e||null===(n=e.pagination)||void 0===n?void 0:n.total,columns:b,data:a.data,pagination:!0,noDataComponent:"Belum ada data Order Pembelian"})}var A=n("xBBV"),I=n("NyWP"),R=n.n(I);J.getInitialProps=function(){var t=Object(o.a)(u.a.mark((function t(e){var n,a,r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=R.a.get(e),t.next=3,F(n);case 3:return r=t.sent,t.next=6,r.json();case 6:return a=t.sent,t.abrupt("return",{props:{data:a}});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();var F=function(){var t=Object(o.a)(u.a.mark((function t(e){var n,a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"https://js-strapi.keelola.net/api/purchases?populate=deep",n={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e.token}},t.next=4,fetch("https://js-strapi.keelola.net/api/purchases?populate=deep",n);case 4:return a=t.sent,t.abrupt("return",a);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();function J(t){var e=t.props.data,n=Object(p.useState)(e),a=n[0],i=n[1],c=Object(p.useState)(!1),l=c[0],f=c[1],x=s.a.Search,m=Object(D.useRouter)(),v=function(){var t=Object(o.a)(u.a.mark((function t(e){var n,a,r,s,o;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="https://js-strapi.keelola.net/api/purchases/"+e,a=R.a.get(null,"token"),r={method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer "+a.token}},t.next=5,fetch(n,r);case 5:return s=t.sent,t.next=8,s.json();case 8:if(!t.sent){t.next=15;break}return t.next=12,C(a);case 12:o=t.sent,w("success","Berhasil menghapus data","Order Pembelian yang dipilih telah berhasil dihapus. Silahkan cek kembali Order Pembelian"),i(o);case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),g=function(){var t=Object(o.a)(u.a.mark((function t(e){var n,a,r,s,o;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=R.a.get(null,"token"),a="https://js-strapi.keelola.net/api/purchases?pagination[page]="+e,r={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+n.token}},t.prev=3,t.next=6,fetch(a,r);case 6:return s=t.sent,t.next=9,s.json();case 9:(o=t.sent)?i((function(t){return{data:filterDuplicateData(t.data.concat(o.data)),meta:t.meta}})):console.log("something is wrong"),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(3),console.log(t.t0);case 16:case"end":return t.stop()}}),t,null,[[3,13]])})));return function(e){return t.apply(this,arguments)}}(),O=function(){var t=Object(o.a)(u.a.mark((function t(n){var a,r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n.target.value.length>=2)){t.next=12;break}return f(!0),t.next=4,k(n.target.value);case 4:return a=t.sent,t.next=7,a.json();case 7:r=t.sent,i(r),f(!1),t.next=14;break;case 12:i(e),f(!1);case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),k=function(){var t=Object(o.a)(u.a.mark((function t(e){var n,a,r,i;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="https://js-strapi.keelola.net/api/purchases?filters[$or][0][added_by][$contains]="+e+"&filters[$or][1][no_po][$contains]="+e+"&populate=*",a=R.a.get(null,"token"),r={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+a.token}},t.next=5,fetch(n,r);case 5:return i=t.sent,t.abrupt("return",i);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),y=function(){var t=Object(o.a)(u.a.mark((function t(e,n){var a,r,s,o,c,l,d,p,h,b,j,f,x,m;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(c in e.attributes)null!==e.attributes[c]&&void 0!==e.attributes[c]||delete e.attributes[c];return null!==(null===(a=e.attributes)||void 0===a||null===(r=a.document)||void 0===r?void 0:r.data)&&void 0!==(null===(s=e.attributes)||void 0===s||null===(o=s.document)||void 0===o?void 0:o.data)||null===(l=e.attributes)||void 0===l||delete l.document,d=[],e.attributes.purchase_details.data.forEach((function(t){d.push({id:t.id})})),e.attributes.supplier={id:e.attributes.supplier.data.id},e.attributes.location={id:e.attributes.location.data.id},e.attributes.purchase_details=d,p={data:e.attributes},h=JSON.stringify(p),b=R.a.get(null,"token"),j="https://js-strapi.keelola.net/api/purchases/"+n,f={method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer "+b.token},body:h},t.next=14,fetch(j,f);case 14:return x=t.sent,t.next=17,x.json();case 17:if(t.sent,200!==x.status){t.next=26;break}return t.next=21,C(b);case 21:m=t.sent,i(m),w("success","Status berhasil dirubah","Status berhasil dirubah. Silahkan cek detail order pembelian"),t.next=27;break;case 26:w("error","Status gagal dirubah","Tedapat kesalahan yang menyebabkan status tidak dapat dirubah");case 27:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),w=function(t,e,n){r.a[t]({message:e,description:n})},C=function(){var t=Object(o.a)(u.a.mark((function t(e){var n,a,r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"https://js-strapi.keelola.net/api/purchases?populate=deep",n={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e.token}},t.next=4,fetch("https://js-strapi.keelola.net/api/purchases?populate=deep",n);case 4:return a=t.sent,r=a.json(),t.abrupt("return",r);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(d.a,{children:Object(E.jsx)("title",{children:"Order Pembelian"})}),Object(E.jsx)(b.a,{children:Object(E.jsxs)(j.a,{style:{},children:[Object(E.jsx)(A.a,{titleText:"Order Pembelian"}),Object(E.jsxs)(h.a,{children:[Object(E.jsxs)("div",{className:"w-full flex justify-between",children:[Object(E.jsx)(x,{className:"",loading:l,onChange:function(t){return O(t)},placeholder:"Cari Pembelian",style:{width:200}}),Object(E.jsx)("button",{onClick:function(){m.push("/dashboard/pembelian/order_pembelian/tambah")},type:"button",className:"bg-cyan-700 rounded px-5 py-2 hover:bg-cyan-800  shadow-sm flex float-right mb-5",children:Object(E.jsx)("div",{className:"text-white text-center text-sm font-bold",children:Object(E.jsx)("a",{className:"text-white no-underline text-xs sm:text-xs",children:"+ Tambah"})})})]}),Object(E.jsx)(B,{data:a,onUpdate:function(t){w("info","Work In Progress","Hai, Fitur ini sedang dikerjakan. Silahkan tunggu pembaruan selanjutnya")},onDelete:v,onPageChange:g,onChangeStatus:function(t,e){e.attributes.status=t,y(e,e.id)},onChangeStatusPengiriman:function(t,e){e.attributes.delivery_status=t,y(e,e.id)}})]})]})})]})}e.default=J},rg98:function(t,e,n){"use strict";function a(t,e,n,a,r,i,s){try{var o=t[i](s),c=o.value}catch(u){return void n(u)}o.done?e(c):Promise.resolve(c).then(a,r)}function r(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var s=t.apply(e,n);function o(t){a(s,r,i,o,c,"next",t)}function c(t){a(s,r,i,o,c,"throw",t)}o(void 0)}))}}n.d(e,"a",(function(){return r}))}},[["ctRN",0,1,13,2,3,4,5,6,7,9,8,10,12,11,14,17,18,19,20,23]]]);