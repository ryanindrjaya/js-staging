_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[69],{Ubvz:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/pengguna/edit/[id]",function(){return n("l8Dz")}])},l8Dz:function(e,t,n){"use strict";n.r(t);var r=n("4IMT"),a=n.n(r),s=n("MM9K"),i=n.n(s),o=n("FAat"),c=n.n(o),l=n("z19R"),u=n.n(l),p=n("iJl9"),d=n.n(p),j=n("SNDM"),b=n.n(j),m=n("cpVT"),h=n("rg98"),f=n("qu0K"),O=n.n(f),x=n("xvhg"),v=n("vJKn"),g=n.n(v),w=n("NyWP"),y=n.n(w),k=n("q1tI"),T=n("g4pe"),P=n.n(T),N=n("kM/w"),_=n("0Jbt"),I=n("PKTO"),z=n("xBBV"),E=n("FGyW"),S=n("20a2"),A=n("0Ize"),D=n("nKUr");function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){Object(m.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var B=function(e){var t,n=e.props,r=O.a.useForm(),s=Object(x.a)(r,1)[0],o=Object(k.useState)(!1),l=o[0],p=o[1],j=Object(k.useState)({}),m=(j[0],j[1]),f=y.a.get(null,"token"),v=Object(S.useRouter)(),w=null===n||void 0===n||null===(t=n.role)||void 0===t?void 0:t.roles,T=null===n||void 0===n?void 0:n.user,V=null===n||void 0===n?void 0:n.user.role,B=null===n||void 0===n?void 0:n.user.locations,G=null===n||void 0===n?void 0:n.locations,J=function(){var e=Object(h.a)(g.a.mark((function e(t){var n,r,a,s,i,o,c,l;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),e.next=3,M(t.role_id);case 3:return n=e.sent,r=q(q({},t),{},{role:n,deleteAble:!0}),a="https://js-strapi.keelola.net/api/users/"+T.id,s=JSON.stringify(r),i={method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer "+f.token},body:s},e.next=10,fetch(a,i);case 10:return o=e.sent,e.next=13,o.json();case 13:c=e.sent,200===o.status?(v.back(),E.b.success("Data Pengguna berhasil diperbarui!",{position:E.b.POSITION.TOP_RIGHT})):null===(l=c.error)||void 0===l||l.details.errors.map((function(e){E.b.error("Tidak dapat memperbarui Pengguna",{position:E.b.POSITION.TOP_RIGHT})})),p(!1);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M=function(){var e=Object(h.a)(g.a.mark((function e(t){var n,r,a,s;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="https://js-strapi.keelola.net/api/users-permissions/roles/"+t,r={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+f.token}},e.next=4,fetch(n,r);case 4:return a=e.sent,e.next=7,a.json();case 7:return s=e.sent,e.abrupt("return",s.role);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(P.a,{children:Object(D.jsx)("title",{children:"Tambahkan Pengguna"})}),Object(D.jsx)(_.a,{children:Object(D.jsxs)(I.a,{style:{},children:[Object(D.jsx)(z.a,{titleText:"Tambahkan Pengguna"}),Object(D.jsx)(N.a,{children:Object(D.jsxs)(O.a,{form:s,name:"add_user",initialValues:{remember:!0},onFinish:J,children:[Object(D.jsxs)("div",{className:"flex flex-wrap -mx-3 mb-6",children:[Object(D.jsx)("div",{className:"w-full md:w-1/3 px-3 mb-2 md:mb-0",children:Object(D.jsx)(O.a.Item,{initialValue:T.username,name:"username",rules:[{required:!0,message:"Username tidak boleh kosong!"}],children:Object(D.jsx)(d.a,{disabled:!0,style:{height:"50px"},prefix:Object(D.jsx)(b.a,{style:{fontSize:"150%"},className:"site-form-item-icon mr-5"}),placeholder:"Username"})})}),Object(D.jsx)("div",{className:"w-full md:w-1/3 px-3 mb-2 md:mb-0",children:Object(D.jsx)(O.a.Item,{initialValue:T.name,name:"name",rules:[{required:!0,message:"Nama tidak boleh kosong!"}],children:Object(D.jsx)(d.a,{style:{height:"50px"},prefix:Object(D.jsx)(b.a,{style:{fontSize:"150%"},className:"site-form-item-icon mr-5"}),placeholder:"Nama"})})}),Object(D.jsx)("div",{className:"w-full md:w-1/3 px-3 mb-2 md:mb-0",children:Object(D.jsx)(O.a.Item,{name:"email",initialValue:T.email,rules:[{required:!0,message:"Email tidak boleh kosong!"}],children:Object(D.jsx)(d.a,{style:{height:"50px"},prefix:Object(D.jsx)(u.a,{style:{fontSize:"150%"},className:"site-form-item-icon mr-5"}),placeholder:"Email"})})})]}),Object(D.jsx)(A.a,{data:G,onSelect:m,initialValue:B,errMsg:"Harap pilih lokasi user",required:!0}),Object(D.jsx)(O.a.Item,{name:"role_id",className:"w-1/4 mb-5 ml-1",initialValue:V.id,children:Object(D.jsx)(c.a,{placeholder:"Role",children:w.map((function(e){return"Authenticated"===e.name||"Public"===e.name?Object(D.jsx)(c.a.Option,{hidden:!0,disabled:!0,value:e.id,children:e.name}):Object(D.jsx)(c.a.Option,{value:e.id,children:e.name})}))})}),Object(D.jsx)(O.a.Item,{children:l?Object(D.jsx)("div",{className:" flex float-left ml-3",children:Object(D.jsx)(i.a,{})}):Object(D.jsx)(a.a,{htmlType:"submit",className:" hover:text-white hover:bg-cyan-700 border border-cyan-700 ml-1",children:"Submit"})})]})})]})})]})};B.getInitialProps=function(){var e=Object(h.a)(g.a.mark((function e(t){var n,r,a,s,i,o,c,l,u,p;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=y.a.get(t),r=t.query.id,a="https://js-strapi.keelola.net/api/users/"+r+"?populate=*",s={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+n.token}},e.next=6,fetch(a,s);case 6:return i=e.sent,e.next=9,i.json();case 9:return o=e.sent,e.next=12,G(n);case 12:return c=e.sent,e.next=15,c.json();case 15:return l=e.sent,e.next=18,J(n,"/locations");case 18:return u=e.sent,e.next=21,u.json();case 21:return p=e.sent,e.abrupt("return",{props:{user:o,role:l,locations:p}});case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var G=function(){var e=Object(h.a)(g.a.mark((function e(t){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://js-strapi.keelola.net/api/users-permissions/roles",n={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=4,fetch("https://js-strapi.keelola.net/api/users-permissions/roles",n);case 4:return r=e.sent,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=Object(h.a)(g.a.mark((function e(t,n){var r,a,s;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="https://js-strapi.keelola.net/api"+n,a={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=4,fetch(r,a);case 4:return s=e.sent,e.abrupt("return",s);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();t.default=B}},[["Ubvz",0,1,13,2,3,4,5,6,7,9,8,10,12,11,14,15,19,31]]]);