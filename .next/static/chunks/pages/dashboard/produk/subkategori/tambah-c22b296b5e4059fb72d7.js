_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[91],{ChPt:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/produk/subkategori/tambah",function(){return r("twLP")}])},twLP:function(e,t,r){"use strict";r.r(t);var a=r("4IMT"),n=r.n(a),s=r("MM9K"),c=r.n(s),i=r("FAat"),o=r.n(i),l=r("cpVT"),u=r("rg98"),b=r("iJl9"),p=r.n(b),d=r("qu0K"),h=r.n(d),j=r("xvhg"),m=r("vJKn"),O=r.n(m),f=r("q1tI"),x=r("g4pe"),g=r.n(x),w=r("kM/w"),v=r("PKTO"),y=r("NyWP"),k=r.n(y),P=r("FGyW"),T=r("0Jbt"),S=r("xBBV"),_=(r("Vy9V"),r("nKUr"));function N(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function I(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?N(Object(r),!0).forEach((function(t){Object(l.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var K=function(e){var t,r=e.props,a=(null===r||void 0===r||null===(t=r.categories)||void 0===t||t.data,Object(f.useState)("")),s=(a[0],a[1],h.a.useForm()),i=Object(j.a)(s,1)[0],l=Object(f.useState)(!1),b=l[0],d=l[1],m=Object(f.useState)([]),x=m[0],y=m[1],N=Object(f.useState)(),K=N[0],E=N[1],D=k.a.get(null,"token"),A=p.a.TextArea,F=function(){var e=Object(u.a)(O.a.mark((function e(t){var r,a,n,s,c,o,l,u;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),r={id:K},delete t.category_id,a=I(I({},t),{},{category:r}),n={data:a},"https://js-strapi.keelola.net/api/sub-categories",s=JSON.stringify(n),c={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+D.token},body:s},e.next=10,fetch("https://js-strapi.keelola.net/api/sub-categories",c);case 10:return o=e.sent,e.next=13,o.json();case 13:l=e.sent,200===o.status?(i.resetFields(),P.b.success("Sub Kategori berhasil ditambahkan!",{position:P.b.POSITION.TOP_RIGHT})):null===(u=l.error)||void 0===u||u.details.errors.map((function(e){var t=e.path[0];P.b.error("sub_id"===t?"ID Sub Kategori udah digunakan":"Tidak dapat menambahkan Sub Kategori",{position:P.b.POSITION.TOP_RIGHT})})),d(!1);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=Object(u.a)(O.a.mark((function e(t,r,a){var n,s,c,i,o;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=4;break}r([]),e.next=19;break;case 4:return e.prev=4,n="https://js-strapi.keelola.net/api"+"/categories?filters[$or][0][name][$contains]=".concat(t,"&filters[$or][1][category_id][$contains]=").concat(t),s={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+D.token}},e.next=9,fetch(n,s);case 9:return c=e.sent,e.next=12,c.json();case 12:i=e.sent,200==c.status&&(o=i.data.map((function(e){return{label:"".concat(e.attributes.category_id," - ").concat(e.attributes.name),value:e.id}})),console.log(o),r(o)),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),console.log(e.t0);case 19:case"end":return e.stop()}}),e,null,[[4,16]])})));return function(t,r,a){return e.apply(this,arguments)}}(),J=x.map((function(e){return Object(_.jsx)(Option,{children:e.label},e.value)}));return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(g.a,{children:Object(_.jsx)("title",{children:"Tambahkan Sub Kategori"})}),Object(_.jsx)(T.a,{children:Object(_.jsxs)(v.a,{style:{},children:[Object(_.jsx)(S.a,{titleText:"Tambahkan Sub Kategori"}),Object(_.jsx)(w.a,{children:Object(_.jsxs)(h.a,{form:i,name:"add_category",initialValues:{remember:!0},onFinish:F,children:[Object(_.jsx)("div",{className:"flex flex-wrap -mx-3 mb-6",children:Object(_.jsx)(h.a.Item,{name:"category_id",className:"w-full md:w-1/3 px-3 mb-2 md:mb-0",children:Object(_.jsx)(o.a,{size:"large",showSearch:!0,value:K,showArrow:!1,placeholder:"Pilih Induk Kategori",onSearch:function(e){e?(C(e,y),console.log(x)):y([])},onChange:function(e){E(e)},filterOption:!1,defaultActiveFirstOption:!1,children:J})})}),Object(_.jsxs)("div",{className:"flex flex-wrap -mx-3 mb-6",children:[Object(_.jsx)("div",{className:"w-full md:w-1/2 px-3 mb-2 md:mb-0",children:Object(_.jsx)(h.a.Item,{name:"sub_id",rules:[{required:!0,message:"Sub ID tidak boleh kosong!"}],children:Object(_.jsx)(p.a,{style:{height:"50px"},placeholder:"Sub ID"})})}),Object(_.jsx)("div",{className:"w-full md:w-1/2 px-3 mb-2 md:mb-0",children:Object(_.jsx)(h.a.Item,{name:"name",rules:[{required:!0,message:"Nama Sub tidak boleh kosong!"}],children:Object(_.jsx)(p.a,{style:{height:"50px"},placeholder:"Nama Sub Kategori"})})}),Object(_.jsx)("div",{className:"w-full md:w-full px-3 mb-2 md:mb-0",children:Object(_.jsx)(h.a.Item,{name:"description",children:Object(_.jsx)(A,{rows:4,placeholder:"Deskripsi"})})})]}),Object(_.jsx)(h.a.Item,{children:b?Object(_.jsx)("div",{className:" flex float-left ml-3",children:Object(_.jsx)(c.a,{})}):Object(_.jsx)(n.a,{htmlType:"submit",className:" hover:text-white hover:bg-cyan-700 border border-cyan-700 ml-1",children:"Submit"})})]})})]})})]})};K.getInitialProps=function(){var e=Object(u.a)(O.a.mark((function e(t){var r,a,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=k.a.get(t),e.next=3,E(r);case 3:return n=e.sent,e.next=6,n.json();case 6:return a=e.sent,e.abrupt("return",{props:{categories:a}});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var E=function(){var e=Object(u.a)(O.a.mark((function e(t){var r,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://js-strapi.keelola.net/api/categories",r={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=4,fetch("https://js-strapi.keelola.net/api/categories",r);case 4:return a=e.sent,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();t.default=K}},[["ChPt",0,1,13,2,3,4,5,6,7,9,8,10,12,11,14,15,16,19,32]]]);