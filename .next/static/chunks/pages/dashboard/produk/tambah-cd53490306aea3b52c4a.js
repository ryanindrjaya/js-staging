_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[91],{FkZG:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/produk/tambah",function(){return n("wgPJ")}])},RnN9:function(e,t,n){"use strict";function r(e,t,n,r,a){if("unit_2"===r&&a){var s=t.unit_1_dp1||n.unit_1_dp1||null,i=t.unit_1_dp2||n.unit_1_dp2||null,u=t.unit_1_dp3||n.unit_1_dp3||null,c=t.pricelist_1||n.pricelist_1||0,o=t.disc_1_1||n.disc_1_1||0;e.setFieldsValue({unit_2_dp1:s,unit_2_dp2:i,unit_2_dp3:u,pricelist_2:c,disc_1_2:o})}else if("unit_3"===r&&a){var l=t.unit_1_dp1||n.unit_1_dp1||null,p=t.unit_1_dp2||n.unit_1_dp2||null,d=t.unit_1_dp3||n.unit_1_dp3||null,_=t.pricelist_1||n.pricelist_1||0,h=t.disc_1_1||n.disc_1_1||0;e.setFieldsValue({unit_3_dp1:l,unit_3_dp2:p,unit_3_dp3:d,pricelist_3:_,disc_1_3:h})}else if("unit_4"===r&&a){var b=t.unit_1_dp1||n.unit_1_dp1||null,j=t.unit_1_dp2||n.unit_1_dp2||null,f=t.unit_1_dp3||n.unit_1_dp3||null,m=t.pricelist_1||n.pricelist_1||0,O=t.disc_1_1||n.disc_1_1||0;e.setFieldsValue({unit_4_dp1:b,unit_4_dp2:j,unit_4_dp3:f,pricelist_4:m,disc_1_4:O})}else if("unit_5"===r&&a){var x=t.unit_1_dp1||n.unit_1_dp1||null,y=t.unit_1_dp2||n.unit_1_dp2||null,v=t.unit_1_dp3||n.unit_1_dp3||null,k=t.pricelist_1||n.pricelist_1||0,g=t.disc_1_1||n.disc_1_1||0;e.setFieldsValue({unit_5_dp1:x,unit_5_dp2:y,unit_5_dp3:v,pricelist_5:k,disc_1_5:g})}}n.r(t),n.d(t,"default",(function(){return r}))},lzg3:function(e,t,n){"use strict";function r(e,t,n,r,a){if("qty_2"===r&&a){var s=t.buy_price_1||n.buy_price_1||0,i=t.qty_2||t.qty_2||0,u=s/i,c=(t.purchase_discount_1||n.purchase_discount_1||null)/i,o=(t.sold_price_1||n.sold_price_1||0)/i;e.setFieldsValue({buy_price_2:null!==t.qty_2?Math.round(u):null,purchase_discount_2:null!==t.qty_2?Math.round(c):null,sold_price_2:null!==t.qty_2?Math.round(o):null})}else if("qty_3"===r&&a){var l=t.buy_price_2||n.buy_price_2||0,p=t.qty_3||t.qty_3||0,d=l/p,_=(t.purchase_discount_2||n.purchase_discount_2||null)/p,h=(t.sold_price_2||n.sold_price_2||0)/p;e.setFieldsValue({buy_price_3:null!==t.qty_3?Math.round(d):null,purchase_discount_3:null!==t.qty_3?Math.round(_):null,sold_price_3:null!==t.qty_3?Math.round(h):null})}else if("qty_4"===r&&a){var b=t.buy_price_3||n.buy_price_3||0,j=t.qty_4||t.qty_4||0,f=b/j,m=(t.purchase_discount_3||n.purchase_discount_3||null)/j,O=(t.sold_price_3||n.sold_price_3||0)/j;e.setFieldsValue({buy_price_4:null!==t.qty_4?Math.round(f):null,purchase_discount_4:null!==t.qty_4?Math.round(m):null,sold_price_4:null!==t.qty_4?O:null})}else if("qty_5"===r&&a){var x=t.buy_price_4||n.buy_price_4||0,y=t.qty_5||t.qty_5||0,v=x/y,k=(t.purchase_discount_4||n.purchase_discount_4||null)/y,g=(t.sold_price_4||n.sold_price_4||0)/y;e.setFieldsValue({buy_price_5:null!==t.qty_5?Math.round(v):null,purchase_discount_5:null!==t.qty_5?Math.round(k):null,sold_price_5:null!==t.qty_5?Math.round(g):null})}}n.r(t),n.d(t,"default",(function(){return r}))},wgPJ:function(e,t,n){"use strict";n.r(t),function(e){var r=n("4IMT"),a=n.n(r),s=n("MM9K"),i=n.n(s),u=n("Vti8"),c=n.n(u),o=n("cpVT"),l=n("QpBz"),p=n.n(l),d=n("rg98"),_=n("iJl9"),h=n.n(_),b=n("B8+X"),j=n.n(b),f=n("qu0K"),m=n.n(f),O=n("xvhg"),x=n("vJKn"),y=n.n(x),v=n("q1tI"),k=n("g4pe"),g=n.n(k),w=n("kM/w"),S=n("PKTO"),T=n("NyWP"),P=n.n(T),q=n("FGyW"),N=n("0Jbt"),C=n("xBBV"),F=n("zf01"),I=n("ml6N"),A=n("k1kd"),B=n("+zqw"),M=n("Sqsd"),E=n("20a2"),G=n("Aiso"),z=n.n(G),V=n("HAFu"),R=n("RnN9"),J=n("lzg3"),D=n("nKUr");function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var U=function(t){var n=t.props,r=Object(v.useState)(),s=r[0],u=r[1],o=Object(v.useState)(),l=o[0],_=o[1],b=Object(v.useState)(!0),f=b[0],x=b[1],k=Object(v.useState)([]),T=k[0],G=k[1],K=m.a.useForm(),U=Object(O.a)(K,1)[0],H=Object(v.useState)(!1),X=H[0],W=H[1],Z=Object(v.useState)(!0),Q=Z[0],Y=(Z[1],P.a.get(null,"token")),$=Object(E.useRouter)(),ee=j.a.Dragger,te=h.a.TextArea,ne=n.manufactures,re=n.groups,ae=n.locations,se=Object(v.useState)({}),ie=(se[0],se[1]),ue=Object(v.useState)({}),ce=(ue[0],ue[1]),oe=Object(v.useState)({}),le=(oe[0],oe[1]),pe=Object(v.useState)([]),de=pe[0],_e=pe[1],he=Object(v.useState)(),be=he[0],je=he[1],fe={name:"files",multiple:!1,fileList:T,showUploadList:{showDownloadIcon:!1,showRemoveIcon:!0},onRemove:function(e){x(!0),u(),G([])},onChange:function(e){return Object(d.a)(y.a.mark((function t(){var n,r,a,s,i;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(1!==e.fileList.length){t.next=18;break}if("https://js-strapi.keelola.net/api/upload",n=e.file.originFileObj,(r=new FormData).append("files",n),G(e.fileList),a={method:"POST",headers:{Authorization:"Bearer "+Y.token},body:r},!f){t.next=16;break}return x(!1),t.next=11,fetch("https://js-strapi.keelola.net/api/upload",a);case 11:return s=t.sent,t.next=14,s.json();case 14:i=t.sent,200===s.status?(u(i[0]),p.a.success("".concat(e.file.name," berhasil diupload"))):p.a.error("".concat(e.file.name," gagal upload"));case 16:t.next=19;break;case 18:0===e.fileList.length?p.a.info("Gambar berhasil dihapus"):p.a.error("Hanya dapat menambahkan 1 gambar");case 19:case"end":return t.stop()}}),t)})))()}},me=function(){var e=Object(d.a)(y.a.mark((function e(t){var n,r,a,i,u,c,o,l,p,d;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(W(!0),r={id:parseInt(null===t||void 0===t?void 0:t.category_id)},a={id:null===t||void 0===t?void 0:t.subCategories},i={id:null===t||void 0===t?void 0:t.manufactures},u={id:null===t||void 0===t?void 0:t.groups},c=[],o=0;o<t.locations.length;o++)c.push({id:t.locations[o]});return delete t.locations,delete t.category_id,delete t.subCategories,delete t.manufactures,delete t.groups,l=L({},t),p={category:r,sub_category:a,manufacture:i,group:u,locations:c,image:{id:null===s||void 0===s?void 0:s.id}},e.next=16,Oe(l);case 16:return d=e.sent,console.log(d),e.next=20,xe(null===d||void 0===d||null===(n=d.data)||void 0===n?void 0:n.id,p);case 20:W(!1);case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Oe=function(){var e=Object(d.a)(y.a.mark((function e(t){var n,r,a,s,i;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://js-strapi.keelola.net/api/products",n={data:t},r=JSON.stringify(n),a={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+Y.token},body:r},e.next=6,fetch("https://js-strapi.keelola.net/api/products",a);case 6:return s=e.sent,e.next=9,s.json();case 9:return i=e.sent,e.abrupt("return",i);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),xe=function(){var e=Object(d.a)(y.a.mark((function e(t,n){var r,a,s,i,c,o,l,p,d;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a in r="https://js-strapi.keelola.net/api/products/"+t,n)void 0!==n[a].id&&NaN!==n[a].id||delete n[a];return console.log(r),s={data:n},i=JSON.stringify(s),c={method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer "+Y.token},body:i},e.prev=6,e.next=9,fetch(r,c);case 9:return o=e.sent,e.next=12,o.json();case 12:l=e.sent,200===o.status?(u(),U.resetFields(),q.b.success("Produk berhasil ditambahkan!",{position:q.b.POSITION.TOP_RIGHT}),$.reload()):null===l||void 0===l||null===(p=l.error)||void 0===p||null===(d=p.details)||void 0===d||d.errors.map((function(e){var t=e.path[0];q.b.error("SKU"===t?"SKU sudah digunakan":"Tidak dapat menambahkan Produk",{position:q.b.POSITION.TOP_RIGHT})})),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(6),q.b.error("Tidak dapat menambahkan Produk",{position:q.b.POSITION.TOP_RIGHT});case 19:case"end":return e.stop()}}),e,null,[[6,16]])})));return function(t,n){return e.apply(this,arguments)}}();return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(g.a,{children:Object(D.jsx)("title",{children:"Tambahkan Produk"})}),Object(D.jsx)(N.a,{children:Object(D.jsxs)(S.a,{style:{},children:[Object(D.jsx)(C.a,{titleText:"Tambahkan Produk"}),Object(D.jsx)(w.a,{children:Object(D.jsxs)(m.a,{form:U,name:"add_product",initialValues:{remember:!0},onFinish:me,onValuesChange:function(e,t){var n=Object.keys(e)[0];n.split("_")[1]>1&&(Object(R.default)(U,e,t,n,Q),Object(J.default)(U,e,t,n,Q))},children:[Object(D.jsxs)("div",{className:"flex flex-wrap -mx-3 mb-3",children:[Object(D.jsxs)("div",{className:"w-full md:w-1/3 px-3 mb-2 md:mb-0",children:[Object(D.jsx)(m.a.Item,{name:"name",rules:[{required:!0,message:"Nama Produk tidak boleh kosong!"}],children:Object(D.jsx)(h.a,{style:{height:"40px"},placeholder:"Nama Produk"})}),Object(D.jsx)(F.a,{selectedCategory:l,onSelectCategory:_,setSubCategories:_e,setSelectedSubCategory:je,selectedSubCategory:be}),Object(D.jsx)(A.a,{subCategories:de,onSelect:je,selectedSubCategory:be}),Object(D.jsx)(m.a.Item,{name:"description",children:Object(D.jsx)(te,{rows:4,placeholder:"Deskripsi"})})]}),Object(D.jsxs)("div",{className:"w-full md:w-1/3 px-3 mb-2 md:mb-0",children:[Object(D.jsx)(I.a,{data:ne.data,onSelect:ie}),Object(D.jsx)(B.a,{data:re,onSelect:ce}),Object(D.jsx)(M.a,{data:ae,onSelect:le})]}),Object(D.jsx)("div",{className:"w-full md:w-1/3 px-3 mb-2 md:mb-0",children:Object(D.jsx)(ee,L(L({},fe),{},{children:null==s?Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)("p",{className:"ant-upload-drag-icon",children:Object(D.jsx)(c.a,{})}),Object(D.jsx)("p",{className:"ant-upload-text",children:"Klik atau tarik gambar ke kotak ini"}),Object(D.jsx)("p",{className:"ant-upload-hint  m-3",children:"Gambar akan digunakan sebagai contoh tampilan produk"})]}):Object(D.jsx)(z.a,{layout:"fill",loader:function(t){t.src;return e.env.BASE_URL+(null===s||void 0===s?void 0:s.url)},src:e.env.BASE_URL+(null===s||void 0===s?void 0:s.url)})}))})]}),Object(D.jsx)("div",{children:Object(D.jsx)("h6",{className:"",children:"HARGA"})}),Object(D.jsx)(V.a,{}),Object(D.jsx)(m.a.Item,{className:"mt-5",children:X?Object(D.jsx)("div",{className:" flex float-left ml-3 ",children:Object(D.jsx)(i.a,{})}):Object(D.jsx)(a.a,{htmlType:"submit",className:" hover:text-white hover:bg-cyan-700 border border-cyan-700 ml-1",children:"Simpan"})})]})})]})})]})};U.getInitialProps=function(){var e=Object(d.a)(y.a.mark((function e(t){var n,r,a,s,i,u,c,o,l,p,d;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=P.a.get(t),e.next=3,H(n);case 3:return r=e.sent,e.next=6,r.json();case 6:return a=e.sent,e.next=9,Z(n);case 9:return s=e.sent,e.next=12,s.json();case 12:return i=e.sent,e.next=15,Q(n);case 15:return u=e.sent,e.next=18,u.json();case 18:return c=e.sent,e.next=21,X(n);case 21:return o=e.sent,e.next=24,o.json();case 24:return l=e.sent,e.next=27,W(n);case 27:return p=e.sent,e.next=30,p.json();case 30:return d=e.sent,e.abrupt("return",{props:{categories:a,groups:i,locations:c,manufactures:l,subCategories:d}});case 32:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var H=function(){var e=Object(d.a)(y.a.mark((function e(t){var n,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://js-strapi.keelola.net/api/categories",n={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=4,fetch("https://js-strapi.keelola.net/api/categories",n);case 4:return r=e.sent,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),X=function(){var e=Object(d.a)(y.a.mark((function e(t){var n,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://js-strapi.keelola.net/api/manufactures",n={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=4,fetch("https://js-strapi.keelola.net/api/manufactures",n);case 4:return r=e.sent,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=Object(d.a)(y.a.mark((function e(t){var n,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://js-strapi.keelola.net/api/sub-categories",n={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=4,fetch("https://js-strapi.keelola.net/api/sub-categories",n);case 4:return r=e.sent,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=Object(d.a)(y.a.mark((function e(t){var n,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://js-strapi.keelola.net/api/groups",n={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=4,fetch("https://js-strapi.keelola.net/api/groups",n);case 4:return r=e.sent,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=Object(d.a)(y.a.mark((function e(t){var n,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://js-strapi.keelola.net/api/locations",n={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=4,fetch("https://js-strapi.keelola.net/api/locations",n);case 4:return r=e.sent,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();t.default=U}.call(this,n("8oxB"))}},[["FkZG",0,1,13,2,3,4,5,6,7,9,8,10,12,11,14,15,16,17,18,19,20,22,25,26,30]]]);