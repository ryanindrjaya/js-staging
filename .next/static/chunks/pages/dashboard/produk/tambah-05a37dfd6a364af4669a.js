_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[92],{"12ph":function(e,t,a){"use strict";function n(e,t,a){var n;return function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];var c=function(){n=null,a||e.apply(void 0,s)},i=a&&!n;clearTimeout(n),n=setTimeout(c,t),i&&e.apply(void 0,s)}}a.r(t),a.d(t,"default",(function(){return n}))},FkZG:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/produk/tambah",function(){return a("wgPJ")}])},wgPJ:function(e,t,a){"use strict";a.r(t),function(e){var n=a("4IMT"),r=a.n(n),s=a("MM9K"),o=a.n(s),c=a("Vti8"),i=a.n(c),u=a("cpVT"),l=a("QpBz"),p=a.n(l),d=a("rg98"),h=a("iJl9"),b=a.n(h),j=a("B8+X"),f=a.n(j),m=a("qu0K"),O=a.n(m),x=a("xvhg"),k=a("vJKn"),v=a.n(k),g=a("q1tI"),w=a("g4pe"),y=a.n(w),S=a("kM/w"),T=a("PKTO"),P=a("NyWP"),N=a.n(P),_=a("FGyW"),C=a("0Jbt"),K=a("xBBV"),I=a("zf01"),U=a("ml6N"),A=a("k1kd"),B=a("+zqw"),E=a("Sqsd"),G=a("20a2"),z=a("Aiso"),F=a.n(z),R=a("HAFu"),J=a("RnN9"),D=a("lzg3"),q=a("n6RN"),L=a("12ph"),H=a("nKUr");function M(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function V(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?M(Object(a),!0).forEach((function(t){Object(u.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):M(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var X=function(t){var a=t.props,n=Object(g.useState)(),s=n[0],c=n[1],u=Object(g.useState)(),l=u[0],h=u[1],j=Object(g.useState)(!0),m=j[0],k=j[1],w=Object(g.useState)([]),P=w[0],z=w[1],M=Object(g.useState)({status:"",message:""}),X=M[0],W=M[1],Z=O.a.useForm(),Q=Object(x.a)(Z,1)[0],$=Object(g.useState)(!1),Y=$[0],ee=$[1],te=Object(g.useState)(!0),ae=te[0],ne=(te[1],N.a.get(null,"token")),re=Object(G.useRouter)(),se=Object(g.useRef)(),oe=f.a.Dragger,ce=b.a.TextArea,ie=a.manufactures,ue=a.groups,le=a.locations,pe=Object(g.useState)({}),de=pe[0],he=pe[1],be=Object(g.useState)({}),je=be[0],fe=be[1],me=Object(g.useState)({}),Oe=(me[0],me[1]),xe=Object(g.useState)([]),ke=xe[0],ve=xe[1],ge=Object(g.useState)(),we=ge[0],ye=ge[1],Se={name:"files",multiple:!1,fileList:P,showUploadList:{showDownloadIcon:!1,showRemoveIcon:!0},onRemove:function(e){k(!0),c(),z([])},onChange:function(e){return Object(d.a)(v.a.mark((function t(){var a,n,r,s,o;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(1!==e.fileList.length){t.next=18;break}if("https://js-strapi.keelola.net/api/upload",a=e.file.originFileObj,(n=new FormData).append("files",a),z(e.fileList),r={method:"POST",headers:{Authorization:"Bearer "+ne.token},body:n},!m){t.next=16;break}return k(!1),t.next=11,fetch("https://js-strapi.keelola.net/api/upload",r);case 11:return s=t.sent,t.next=14,s.json();case 14:o=t.sent,200===s.status?(c(o[0]),p.a.success("".concat(e.file.name," berhasil diupload"))):p.a.error("".concat(e.file.name," gagal upload"));case 16:t.next=19;break;case 18:0===e.fileList.length?p.a.info("Gambar berhasil dihapus"):p.a.error("Hanya dapat menambahkan 1 gambar");case 19:case"end":return t.stop()}}),t)})))()}},Te=function(){var e=Object(d.a)(v.a.mark((function e(t){var a,n,r,o,c,i,u,l,p;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ee(!0),n={id:parseInt(null===t||void 0===t?void 0:t.category_id)},r={id:null===t||void 0===t?void 0:t.subCategories},o={id:null===t||void 0===t?void 0:t.manufactures},c={id:null===t||void 0===t?void 0:t.groups},i=t.locations.map((function(e){return e})),delete t.locations,delete t.category_id,delete t.subCategories,delete t.manufactures,delete t.groups,u=V(V({},t),{},{locations:i}),l={category:n,sub_category:r,manufacture:o,group:c,locations:i,image:{id:null===s||void 0===s?void 0:s.id}},console.log("put data",l),e.next=16,Pe(u);case 16:return p=e.sent,console.log(p),e.next=20,Ne(null===p||void 0===p||null===(a=p.data)||void 0===a?void 0:a.id,l);case 20:ee(!1);case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Pe=function(){var e=Object(d.a)(v.a.mark((function e(t){var a,n,r,s,o;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://js-strapi.keelola.net/api/products",a={data:t},n=JSON.stringify(a),r={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+ne.token},body:n},e.next=6,fetch("https://js-strapi.keelola.net/api/products",r);case 6:return s=e.sent,e.next=9,s.json();case 9:return o=e.sent,e.abrupt("return",o);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ne=function(){var e=Object(d.a)(v.a.mark((function e(t,a){var n,r,s,o,i,u,l,p,d;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r in n="https://js-strapi.keelola.net/api/products/"+t,a)void 0!==a[r].id&&NaN!==a[r].id||delete a[r];return console.log(n),s={data:a},o=JSON.stringify(s),i={method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer "+ne.token},body:o},e.prev=6,e.next=9,fetch(n,i);case 9:return u=e.sent,e.next=12,u.json();case 12:l=e.sent,200===u.status?(c(),Q.resetFields(),_.b.success("Produk berhasil ditambahkan!",{position:_.b.POSITION.TOP_RIGHT}),re.reload()):null===l||void 0===l||null===(p=l.error)||void 0===p||null===(d=p.details)||void 0===d||d.errors.map((function(e){var t=e.path[0];_.b.error("SKU"===t?"SKU sudah digunakan":"Tidak dapat menambahkan Produk",{position:_.b.POSITION.TOP_RIGHT})})),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(6),_.b.error("Tidak dapat menambahkan Produk",{position:_.b.POSITION.TOP_RIGHT});case 19:case"end":return e.stop()}}),e,null,[[6,16]])})));return function(t,a){return e.apply(this,arguments)}}(),_e=function(){var e=Object(d.a)(v.a.mark((function e(t){var a,n,r,s;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return W({status:"validating",message:""}),a="https://js-strapi.keelola.net/api/products?filters[SKU][$eq]="+t,n={method:"GET",headers:{Authorization:"Bearer "+ne.token}},e.next=5,fetch(a,n);case 5:return r=e.sent,e.next=8,r.json();case 8:s=e.sent,200===r.status?s.data.length>0?W({status:"error",message:"SKU sudah digunakan"}):W({status:"success",message:""}):W({status:"error",message:"Error ketika mengambil data SKU"});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ce=function(){var e=Object(d.a)(v.a.mark((function e(t,a){var n,r,s;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Object.keys(t)[0],r=n.split("_"),s=r[r.length-1],"SKU"===n&&""!==a.SKU?Object(L.default)(_e,1e3)(a.SKU):"SKU"===n&&""===a.SKU&&W({status:"error",message:"SKU tidak boleh kosong"}),Object(J.default)(Q,t,a,n,ae),Object(D.default)(Q,t,a,s,ae);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}();return Object(H.jsxs)(H.Fragment,{children:[Object(H.jsx)(y.a,{children:Object(H.jsx)("title",{children:"Tambahkan Produk"})}),Object(H.jsx)(C.a,{children:Object(H.jsxs)(T.a,{style:{},children:[Object(H.jsx)(K.a,{titleText:"Tambahkan Produk"}),Object(H.jsx)(S.a,{children:Object(H.jsxs)(O.a,{form:Q,name:"add_product",initialValues:{remember:!0},onFinish:Te,onValuesChange:Ce,children:[Object(H.jsxs)("div",{className:"flex flex-wrap -mx-3 mb-3",children:[Object(H.jsxs)("div",{className:"w-full md:w-1/3 px-3 mb-2 md:mb-0",children:[Object(H.jsx)(O.a.Item,{name:"name",rules:[{required:!0,message:"Nama Produk tidak boleh kosong!"}],children:Object(H.jsx)(b.a,{style:{height:"40px"},placeholder:"Nama Produk"})}),Object(H.jsx)(I.a,{selectedCategory:l,onSelectCategory:h,setSubCategories:ve,setSelectedSubCategory:ye,selectedSubCategory:we}),Object(H.jsx)(A.a,{subCategories:ke,onSelect:ye,selectedSubCategory:we}),Object(H.jsx)(O.a.Item,{name:"description",children:Object(H.jsx)(ce,{rows:4,placeholder:"Deskripsi"})})]}),Object(H.jsxs)("div",{className:"w-full md:w-1/3 px-3 mb-2 md:mb-0",children:[Object(H.jsx)(O.a.Item,{name:"SKU",hasFeedback:!0,validateStatus:X.status,help:X.message,rules:[{required:!0,message:"SKU tidak boleh kosong!"}],children:Object(H.jsx)(b.a,{style:{height:"40px"},placeholder:"SKU"})}),Object(H.jsx)(U.a,{data:ie.data,selectedManufactures:de,onSelect:he}),Object(H.jsx)(B.a,{data:ue,selectedGroups:je,onSelect:fe}),Object(H.jsx)(E.a,{data:le,onSelect:Oe})]}),Object(H.jsx)("div",{className:"w-full md:w-1/3 px-3 mb-2 md:mb-0",children:Object(H.jsx)(oe,V(V({},Se),{},{children:null==s?Object(H.jsxs)(H.Fragment,{children:[Object(H.jsx)("p",{className:"ant-upload-drag-icon",children:Object(H.jsx)(i.a,{})}),Object(H.jsx)("p",{className:"ant-upload-text",children:"Klik atau tarik gambar ke kotak ini"}),Object(H.jsx)("p",{className:"ant-upload-hint  m-3",children:"Gambar akan digunakan sebagai contoh tampilan produk"})]}):Object(H.jsx)(F.a,{layout:"fill",loader:function(t){t.src;return e.env.BASE_URL+(null===s||void 0===s?void 0:s.url)},src:e.env.BASE_URL+(null===s||void 0===s?void 0:s.url)})}))})]}),Object(H.jsx)("div",{children:Object(H.jsx)("h6",{className:"",children:"HARGA"})}),Object(H.jsx)(R.a,{}),Object(H.jsx)(O.a.Item,{className:"mt-5",children:Y?Object(H.jsx)("div",{className:" flex float-left ml-3 ",children:Object(H.jsx)(o.a,{})}):Object(H.jsxs)(H.Fragment,{children:[Object(H.jsx)(q.a,{onConfirm:function(){var e;return null===se||void 0===se||null===(e=se.current)||void 0===e?void 0:e.click()},onCancel:function(){},title:"Tambah Produk",message:"Apakah anda yakin ingin menambahkan produk ini?",component:Object(H.jsx)(r.a,{className:" hover:text-white hover:bg-cyan-700 border border-cyan-700 ml-1",children:"Simpan"})}),Object(H.jsx)(r.a,{htmlType:"submit",ref:se})]})})]})})]})})]})};X.getInitialProps=function(){var e=Object(d.a)(v.a.mark((function e(t){var a,n,r,s,o,c,i,u,l,p,d;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=N.a.get(t),e.next=3,W(a);case 3:return n=e.sent,e.next=6,n.json();case 6:return r=e.sent,e.next=9,$(a);case 9:return s=e.sent,e.next=12,s.json();case 12:return o=e.sent,e.next=15,Y(a);case 15:return c=e.sent,e.next=18,c.json();case 18:return i=e.sent,e.next=21,Z(a);case 21:return u=e.sent,e.next=24,u.json();case 24:return l=e.sent,e.next=27,Q(a);case 27:return p=e.sent,e.next=30,p.json();case 30:return d=e.sent,e.abrupt("return",{props:{categories:r,groups:o,locations:i,manufactures:l,subCategories:d}});case 32:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var W=function(){var e=Object(d.a)(v.a.mark((function e(t){var a,n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://js-strapi.keelola.net/api/categories",a={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=4,fetch("https://js-strapi.keelola.net/api/categories",a);case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=Object(d.a)(v.a.mark((function e(t){var a,n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://js-strapi.keelola.net/api/manufactures",a={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=4,fetch("https://js-strapi.keelola.net/api/manufactures",a);case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=Object(d.a)(v.a.mark((function e(t){var a,n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://js-strapi.keelola.net/api/sub-categories",a={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=4,fetch("https://js-strapi.keelola.net/api/sub-categories",a);case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$=function(){var e=Object(d.a)(v.a.mark((function e(t){var a,n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://js-strapi.keelola.net/api/groups",a={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=4,fetch("https://js-strapi.keelola.net/api/groups",a);case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=Object(d.a)(v.a.mark((function e(t){var a,n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://js-strapi.keelola.net/api/locations",a={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=4,fetch("https://js-strapi.keelola.net/api/locations",a);case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();t.default=X}.call(this,a("8oxB"))}},[["FkZG",0,1,13,2,3,4,5,6,7,9,8,10,12,11,14,15,16,17,18,19,21,22,25,26,30]]]);