_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[76],{BZEI:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/produk/edit/[id]",function(){return a("bAmt")}])},bAmt:function(e,t,a){"use strict";a.r(t),function(e){var n=a("4IMT"),r=a.n(n),o=a("MM9K"),i=a.n(o),s=a("Vti8"),c=a.n(s),u=a("cpVT"),l=a("QpBz"),d=a.n(l),p=a("rg98"),b=a("iJl9"),j=a.n(b),h=a("B8+X"),v=a.n(h),f=a("qu0K"),m=a.n(f),g=a("xvhg"),O=a("vJKn"),x=a.n(O),k=a("q1tI"),y=a("g4pe"),w=a.n(y),S=a("kM/w"),_=a("PKTO"),T=a("NyWP"),C=a.n(T),N=a("FGyW"),P=a("20a2"),E=a("Aiso"),I=a.n(E),A=a("0Jbt"),B=a("xBBV"),V=a("zf01"),z=a("ml6N"),G=a("k1kd"),R=a("+zqw"),K=a("Sqsd"),F=a("HAFu"),U=a("n6RN"),q=a("lzg3"),D=a("RnN9"),L=a("nKUr");function J(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function H(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?J(Object(a),!0).forEach((function(t){Object(u.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):J(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var M=function(t){var a,n,o,s,u,l,b,h,f,O,y,T,E,J,M,X,W,Z,Q,$,Y,ee,te,ae=t.props,ne=null===ae||void 0===ae?void 0:ae.product.data.id,re=null===ae||void 0===ae||null===(a=ae.product)||void 0===a?void 0:a.data,oe=null===ae||void 0===ae?void 0:ae.manufactures,ie=null===ae||void 0===ae?void 0:ae.groups,se=null===ae||void 0===ae?void 0:ae.locations,ce=null===re||void 0===re||null===(n=re.attributes)||void 0===n||null===(o=n.category)||void 0===o?void 0:o.data,ue=null===re||void 0===re||null===(s=re.attributes)||void 0===s||null===(u=s.sub_category)||void 0===u?void 0:u.data,le=Object(k.useState)(null!==(l=re.attributes)&&void 0!==l&&null!==(b=l.image)&&void 0!==b&&b.data?null===(h=re.attributes)||void 0===h||null===(f=h.image)||void 0===f?void 0:f.data[0].attributes:null),de=le[0],pe=le[1],be=Object(k.useState)(),je=be[0],he=be[1],ve=Object(k.useState)(ce.id),fe=ve[0],me=(ve[1],Object(k.useState)(!0)),ge=me[0],Oe=me[1],xe=Object(k.useState)([]),ke=xe[0],ye=xe[1],we=Object(k.useState)(!0),Se=we[0],_e=(we[1],m.a.useForm()),Te=Object(g.a)(_e,1)[0],Ce=Object(k.useState)(!1),Ne=Ce[0],Pe=Ce[1],Ee=C.a.get(null,"token"),Ie=Object(P.useRouter)(),Ae=Object(k.useRef)(),Be=v.a.Dragger,Ve=j.a.TextArea,ze=Object(k.useState)({}),Ge=(ze[0],ze[1]),Re=Object(k.useState)({}),Ke=(Re[0],Re[1]),Fe=Object(k.useState)(),Ue=(Fe[0],Fe[1]),qe=Object(k.useState)([]),De=qe[0],Le=qe[1],Je=Object(k.useState)(),He=Je[0],Me=Je[1];var Xe={name:"files",multiple:!1,fileList:ke,showUploadList:{showDownloadIcon:!1,showRemoveIcon:!0},onRemove:function(e){Oe(!0),pe(),ye([])},onChange:function(e){return Object(p.a)(x.a.mark((function t(){var a,n,r,o,i;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(1!==e.fileList.length){t.next=18;break}if("https://js-strapi.keelola.net/api/upload",a=e.file.originFileObj,(n=new FormData).append("files",a),ye(e.fileList),r={method:"POST",headers:{Authorization:"Bearer "+Ee.token},body:n},!ge){t.next=16;break}return Oe(!1),t.next=11,fetch("https://js-strapi.keelola.net/api/upload",r);case 11:return o=t.sent,t.next=14,o.json();case 14:i=t.sent,200===o.status?(pe(i[0]),d.a.success("".concat(e.file.name," berhasil diupload"))):d.a.error("".concat(e.file.name," gagal upload"));case 16:t.next=19;break;case 18:0===e.fileList.length?d.a.info("Gambar berhasil dihapus"):d.a.error("Hanya dapat menambahkan 1 gambar");case 19:case"end":return t.stop()}}),t)})))()}},We=function(e){return e.category_id==="".concat(ce.attributes.category_id," - ").concat(ce.attributes.name)?(console.log("category tidak berubah. jadikan id"),e.category_id=fe):(console.log("category berubah. jadikan tipe int"),e.category_id=parseInt(e.category_id)),e},Ze=function(e){return console.log("checker ",e.subCategories,ue),e.subCategories===(null===ue||void 0===ue?void 0:ue.attributes.name)?(console.log("sub category tidak berubah. jadikan id"),e.subCategories=ue.id):ue?(console.log("sub category berubah. jadikan tipe int"),e.subCategories=parseInt(e.subCategories)):console.log("tidak ada datanya cuy"),e},Qe=function(){var e=Object(p.a)(x.a.mark((function e(t){var a,n,r,o,i,s,c,u,l,d,p,b,j,h,v,f,m,g,O,k,y,w;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(j in console.log("values",t),Pe(!0),t=We(t),t=Ze(t),u={id:parseInt(null===(a=t)||void 0===a?void 0:a.category_id)},l={id:null!==(n=null===(r=t)||void 0===r?void 0:r.subCategories)&&void 0!==n?n:null},d={id:null===(o=t)||void 0===o?void 0:o.manufactures},p={id:null===(i=t)||void 0===i?void 0:i.groups},t.locations=(null===(s=t)||void 0===s||null===(c=s.locations)||void 0===c?void 0:c.map((function(e){return e.value?{id:e.value}:{id:e}})))||[],delete t.category_id,delete t.subCategories,delete t.manufactures,delete t.groups,""===(b={category:u,sub_category:l,manufacture:d,group:p,image:{id:null===de||void 0===de?void 0:de.id}}).sub_category.id&&delete b.sub_category,console.log("tester",b),t)void 0!==t[j]&&null!==t[j]||delete t[j];for(h in b)void 0!==b[h].id&&NaN!==b[h].id||delete b[h];for(v=H(H({},t),b),console.log("data",v),f=1;f<6;f++)"-"===v["purchase_discount_".concat(f)]&&delete v["purchase_discount_".concat(f)];return m={data:v},g=JSON.stringify(m),O={method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer "+Ee.token},body:g},k="https://js-strapi.keelola.net/api/products/"+ne,e.next=27,fetch(k,O);case 27:return y=e.sent,e.next=30,y.json();case 30:w=e.sent,console.log("dataput ",m),console.log(y),console.log(w),200===y.status?(N.b.success("Produk berhasil diperbarui!",{position:N.b.POSITION.TOP_RIGHT}),Ie.push("/dashboard/produk")):(console.log(w),N.b.error("Tidak dapat memperbarui Produk",{position:N.b.POSITION.TOP_RIGHT})),Pe(!1);case 36:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(w.a,{children:Object(L.jsx)("title",{children:"Edit Produk"})}),Object(L.jsx)(A.a,{children:Object(L.jsxs)(_.a,{style:{},children:[Object(L.jsx)(B.a,{titleText:"Edit Produk"}),Object(L.jsx)(S.a,{children:Object(L.jsxs)(m.a,{form:Te,name:"edit_product",initialValues:{remember:!0},onFinish:Qe,onValuesChange:function(e,t){var a=Object.keys(e)[0],n=a.split("_"),r=n[n.length-1];Object(D.default)(Te,e,t,a,Se),Object(q.default)(Te,e,t,r,Se)},children:[Object(L.jsxs)("div",{className:"flex flex-wrap -mx-3 mb-3",children:[Object(L.jsxs)("div",{className:"w-full md:w-1/3 px-3 mb-2 md:mb-0",children:[Object(L.jsx)(m.a.Item,{name:"name",initialValue:null===re||void 0===re||null===(O=re.attributes)||void 0===O?void 0:O.name,rules:[{required:!0,message:"Nama Produk tidak boleh kosong!"}],children:Object(L.jsx)(j.a,{style:{height:"40px"},placeholder:"Nama Produk"})}),Object(L.jsx)(V.a,{initialValue:"".concat(ce.attributes.category_id," - ").concat(ce.attributes.name),selectedCategory:je,onSelectCategory:he,setSubCategories:Le,setSelectedSubCategory:Me,selectedSubCategory:He}),Object(L.jsx)(G.a,{subCategories:De,onSelect:Me,selectedSubCategory:He,initialValue:"".concat(null!==(y=null===(T=re.attributes)||void 0===T||null===(E=T.sub_category)||void 0===E||null===(J=E.data)||void 0===J?void 0:J.attributes.name)&&void 0!==y?y:"")}),Object(L.jsx)(m.a.Item,{name:"description",initialValue:null!==(M=null===(X=re.attributes)||void 0===X?void 0:X.description)&&void 0!==M?M:"",children:Object(L.jsx)(Ve,{rows:4,placeholder:"Deskripsi"})})]}),Object(L.jsxs)("div",{className:"w-full md:w-1/3 px-3 mb-2 md:mb-0",children:[Object(L.jsx)(m.a.Item,{name:"SKU",rules:[{required:!0,message:"SKU tidak boleh kosong!"}],initialValue:null!==(W=null===(Z=re.attributes)||void 0===Z?void 0:Z.SKU)&&void 0!==W?W:"",children:Object(L.jsx)(j.a,{style:{height:"40px"},placeholder:"SKU"})}),Object(L.jsx)(z.a,{data:oe.data,initialValue:null===(Q=re.attributes)||void 0===Q||null===($=Q.manufacture)||void 0===$?void 0:$.data,onSelect:Ge}),Object(L.jsx)(R.a,{data:ie,onSelect:Ke,initialValue:null===(Y=re.attributes)||void 0===Y||null===(ee=Y.group)||void 0===ee?void 0:ee.data}),Object(L.jsx)(K.a,{data:se,onSelect:Ue,initialValue:null===(te=re.attributes)||void 0===te?void 0:te.locations.data})]}),Object(L.jsx)("div",{className:"w-full md:w-1/3 px-3 mb-2 md:mb-0",children:Object(L.jsx)(Be,H(H({},Xe),{},{children:null==de?Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)("p",{className:"ant-upload-drag-icon",children:Object(L.jsx)(c.a,{})}),Object(L.jsx)("p",{className:"ant-upload-text",children:"Klik atau tarik gambar ke kotak ini"}),Object(L.jsx)("p",{className:"ant-upload-hint  m-3",children:"Gambar akan digunakan sebagai contoh tampilan produk"})]}):Object(L.jsx)(I.a,{layout:"fill",loader:function(t){t.src;return e.env.BASE_URL+(null===de||void 0===de?void 0:de.url)},src:e.env.BASE_URL+(null===de||void 0===de?void 0:de.url)})}))})]}),Object(L.jsx)("div",{children:Object(L.jsx)("h6",{className:"",children:"HARGA"})}),Object(L.jsx)(F.a,{initialValue:re.attributes}),Object(L.jsx)(m.a.Item,{children:Ne?Object(L.jsx)("div",{className:" flex float-left ml-3 ",children:Object(L.jsx)(i.a,{})}):Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(U.a,{onConfirm:function(){var e;return null===Ae||void 0===Ae||null===(e=Ae.current)||void 0===e?void 0:e.click()},onCancel:function(){},title:"Edit Produk",message:"Apakah anda yakin ingin mengedit produk ini?",component:Object(L.jsx)(r.a,{className:" hover:text-white hover:bg-cyan-700 border border-cyan-700 ml-1",children:"Simpan"})}),Object(L.jsx)(r.a,{htmlType:"submit",ref:Ae})]})})]})})]})})]})};M.getInitialProps=function(){var e=Object(p.a)(x.a.mark((function e(t){var a,n,r,o,i,s,c,u,l,d,p,b,j,h,v;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=C.a.get(t),e.next=3,X(n,t);case 3:return r=e.sent,e.next=6,r.json();case 6:return o=e.sent,console.log({product:o}),i=null===(a=o.data.attributes.category.data)||void 0===a?void 0:a.id,e.next=11,W(n);case 11:return s=e.sent,e.next=14,s.json();case 14:return c=e.sent,e.next=17,$(n);case 17:return u=e.sent,e.next=20,u.json();case 20:return l=e.sent,e.next=23,Y(n);case 23:return d=e.sent,e.next=26,d.json();case 26:return p=e.sent,e.next=29,Z(n);case 29:return b=e.sent,e.next=32,b.json();case 32:return j=e.sent,e.next=35,Q(n,i);case 35:return h=e.sent,e.next=38,h.json();case 38:return v=e.sent,e.abrupt("return",{props:{product:o,categories:c,groups:l,locations:p,manufactures:j,subCategories:v}});case 40:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var X=function(){var e=Object(p.a)(x.a.mark((function e(t,a){var n,r,o,i;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.query.id,r="https://js-strapi.keelola.net/api/products/"+n+"?populate=*",o={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=5,fetch(r,o);case 5:return i=e.sent,e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),W=function(){var e=Object(p.a)(x.a.mark((function e(t){var a,n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://js-strapi.keelola.net/api/categories",a={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=4,fetch("https://js-strapi.keelola.net/api/categories",a);case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=Object(p.a)(x.a.mark((function e(t){var a,n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://js-strapi.keelola.net/api/manufactures",a={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=4,fetch("https://js-strapi.keelola.net/api/manufactures",a);case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=Object(p.a)(x.a.mark((function e(t,a){var n,r,o;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="https://js-strapi.keelola.net/api/sub-categories?populate[category][filters][id][$eq]="+a,r={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=4,fetch(n,r);case 4:return o=e.sent,e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),$=function(){var e=Object(p.a)(x.a.mark((function e(t){var a,n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://js-strapi.keelola.net/api/groups",a={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=4,fetch("https://js-strapi.keelola.net/api/groups",a);case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=Object(p.a)(x.a.mark((function e(t){var a,n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://js-strapi.keelola.net/api/locations",a={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=4,fetch("https://js-strapi.keelola.net/api/locations",a);case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();t.default=M}.call(this,a("8oxB"))}},[["BZEI",0,1,13,2,3,4,5,6,7,9,8,10,12,11,14,15,16,17,18,19,21,22,25,26,30]]]);