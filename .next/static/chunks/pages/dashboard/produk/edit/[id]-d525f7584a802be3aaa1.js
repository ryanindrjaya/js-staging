_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[76],{BZEI:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/produk/edit/[id]",function(){return n("bAmt")}])},bAmt:function(e,t,n){"use strict";n.r(t);var a=n("4IMT"),r=n.n(a),i=n("MM9K"),o=n.n(i),s=n("Vti8"),u=n.n(s),c=n("rR1Q"),l=n.n(c),d=n("cpVT"),p=n("QpBz"),b=n.n(p),j=n("rg98"),v=n("iJl9"),h=n.n(v),f=n("B8+X"),m=n.n(f),g=n("qu0K"),O=n.n(g),x=n("xvhg"),y=n("vJKn"),k=n.n(y),_=n("q1tI"),w=n("g4pe"),S=n.n(w),C=n("kM/w"),N=n("PKTO"),T=n("NyWP"),E=n.n(T),P=(n("FGyW"),n("20a2")),q=n("Aiso"),I=n.n(q),A=n("0Jbt"),V=n("xBBV"),B=n("zf01"),F=n("ml6N"),z=n("k1kd"),K=n("+zqw"),G=n("Sqsd"),D=n("HAFu"),U=n("n6RN"),R=n("lzg3"),J=n("RnN9"),L=n("nKUr");function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){Object(d.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var X=function(e){var t,n,a,i,s,c,d,p,v,f,g,y,w,T,q,M,X,Q,W,Z,$,Y,ee,te,ne,ae,re,ie=e.props,oe=(null===ie||void 0===ie||ie.product.data.id,null===ie||void 0===ie||null===(t=ie.product)||void 0===t?void 0:t.data),se=null===ie||void 0===ie?void 0:ie.manufactures,ue=null===ie||void 0===ie?void 0:ie.groups,ce=null===ie||void 0===ie?void 0:ie.locations,le=null===oe||void 0===oe||null===(n=oe.attributes)||void 0===n||null===(a=n.category)||void 0===a?void 0:a.data,de=null===oe||void 0===oe||null===(i=oe.attributes)||void 0===i||null===(s=i.sub_category)||void 0===s?void 0:s.data,pe=null===oe||void 0===oe||null===(c=oe.attributes)||void 0===c||null===(d=c.manufacture)||void 0===d?void 0:d.data,be=null===oe||void 0===oe||null===(p=oe.attributes)||void 0===p||null===(v=p.group)||void 0===v?void 0:v.data,je=Object(_.useState)(null!==(f=oe.attributes)&&void 0!==f&&null!==(g=f.image)&&void 0!==g&&g.data?null===(y=oe.attributes)||void 0===y||null===(w=y.image)||void 0===w?void 0:w.data[0].attributes:null),ve=je[0],he=je[1],fe=Object(_.useState)(),me=fe[0],ge=fe[1],Oe=Object(_.useState)(le.id),xe=Oe[0],ye=(Oe[1],Object(_.useState)(pe.id)),ke=(ye[0],ye[1],Object(_.useState)(!0)),_e=ke[0],we=ke[1],Se=Object(_.useState)([]),Ce=Se[0],Ne=Se[1],Te=Object(_.useState)(!0),Ee=Te[0],Pe=(Te[1],O.a.useForm()),qe=Object(x.a)(Pe,1)[0],Ie=Object(_.useState)(!1),Ae=Ie[0],Ve=Ie[1],Be=E.a.get(null,"token"),Fe=(Object(P.useRouter)(),Object(_.useRef)()),ze=m.a.Dragger,Ke=h.a.TextArea,Ge=Object(_.useState)({}),De=(Ge[0],Ge[1]),Ue=Object(_.useState)({}),Re=(Ue[0],Ue[1]),Je=Object(_.useState)(),Le=(Je[0],Je[1]),Me=Object(_.useState)([]),He=Me[0],Xe=Me[1],Qe=Object(_.useState)(),We=Qe[0],Ze=Qe[1],$e=Object(_.useState)(),Ye=$e[0],et=$e[1];var tt={name:"files",multiple:!1,fileList:Ce,showUploadList:{showDownloadIcon:!1,showRemoveIcon:!0},onRemove:function(e){we(!0),he(),Ne([])},onChange:function(e){return Object(j.a)(k.a.mark((function t(){var n,a,r,i,o;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(1!==e.fileList.length){t.next=18;break}if("https://js-strapi.keelola.net/api/upload",n=e.file.originFileObj,(a=new FormData).append("files",n),Ne(e.fileList),r={method:"POST",headers:{Authorization:"Bearer "+Be.token},body:a},!_e){t.next=16;break}return we(!1),t.next=11,fetch("https://js-strapi.keelola.net/api/upload",r);case 11:return i=t.sent,t.next=14,i.json();case 14:o=t.sent,200===i.status?(he(o[0]),b.a.success("".concat(e.file.name," berhasil diupload"))):b.a.error("".concat(e.file.name," gagal upload"));case 16:t.next=19;break;case 18:0===e.fileList.length?b.a.info("Gambar berhasil dihapus"):b.a.error("Hanya dapat menambahkan 1 gambar");case 19:case"end":return t.stop()}}),t)})))()}},nt=function(e){return e.category_id==="".concat(le.attributes.category_id," - ").concat(le.attributes.name)?e.category_id=xe:e.category_id=parseInt(e.category_id),e},at=function(e){return e.subCategories===(null===de||void 0===de?void 0:de.attributes.name)?e.subCategories=de.id:de&&(e.subCategories=parseInt(e.subCategories)),e},rt=function(e){return e.manufactures===(null===pe||void 0===pe?void 0:pe.attributes.name)?e.manufactures=pe.id:pe&&(e.manufactures=parseInt(e.manufactures)),e},it=function(e){return e.groups===(null===be||void 0===be?void 0:be.attributes.name)?e.groups=be.id:be&&(e.groups=parseInt(e.groups)),e},ot=function(){var e=Object(j.a)(k.a.mark((function e(t){var n,a,r,i,o,s,u,c,l,d,p,b,j,v,h,f,m,g;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(j in console.log("values",t),Ve(!0),t=nt(t),t=at(t),t=rt(t),t=it(t),c={id:parseInt(null===(n=t)||void 0===n?void 0:n.category_id)},l={id:null!==(a=parseInt(null===(r=t)||void 0===r?void 0:r.subCategories))&&void 0!==a?a:null},d={id:parseInt(null===(i=t)||void 0===i?void 0:i.manufactures)},p={id:parseInt(null===(o=t)||void 0===o?void 0:o.groups)},console.log(" checker",t),t.locations=(null===(s=t)||void 0===s||null===(u=s.locations)||void 0===u?void 0:u.map((function(e){return e.value?{id:e.value}:{id:e}})))||[],delete t.category_id,delete t.subCategories,delete t.manufactures,delete t.groups,""===(b={category:c,sub_category:l,manufacture:d,group:p,image:{id:null===ve||void 0===ve?void 0:ve.id}}).sub_category.id&&delete b.sub_category,console.log("tester",b),t)void 0!==t[j]&&null!==t[j]||delete t[j];for(v in b)void 0!==b[v].id&&NaN!==b[v].id||delete b[v];for(h=H(H({},t),b),f=1;f<6;f++)"-"===h["purchase_discount_".concat(f)]&&delete h["purchase_discount_".concat(f)];m={data:h},g=JSON.stringify(m),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer "+Be.token},body:g},console.log(m),Ve(!1);case 28:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(S.a,{children:Object(L.jsx)("title",{children:"Edit Produk"})}),Object(L.jsx)(A.a,{children:Object(L.jsxs)(N.a,{style:{},children:[Object(L.jsx)(V.a,{titleText:"Edit Produk"}),Object(L.jsx)(C.a,{children:Object(L.jsxs)(O.a,{form:qe,name:"edit_product",initialValues:{remember:!0},onFinish:ot,onFinishFailed:function(){qe.getFieldsError().forEach((function(e){if(0!==e.errors.length){var t=e.errors[0];l.a.error({message:"Field Masih Kosong",description:t})}}))},onValuesChange:function(e,t){var n=Object.keys(e)[0],a=n.split("_"),r=a[a.length-1];Object(J.default)(qe,e,t,n,Ee),Object(R.default)(qe,e,t,r,Ee)},children:[Object(L.jsxs)("div",{className:"flex flex-wrap -mx-3 mb-3",children:[Object(L.jsxs)("div",{className:"w-full md:w-1/3 px-3 mb-2 md:mb-0",children:[Object(L.jsx)(O.a.Item,{name:"name",initialValue:null===oe||void 0===oe||null===(T=oe.attributes)||void 0===T?void 0:T.name,rules:[{required:!0,message:"Nama Produk tidak boleh kosong!"}],children:Object(L.jsx)(h.a,{style:{height:"40px"},placeholder:"Nama Produk"})}),Object(L.jsx)(B.a,{initialValue:"".concat(le.attributes.category_id," - ").concat(le.attributes.name),selectedCategory:me,onSelectCategory:ge,setSubCategories:Xe,setSelectedSubCategory:Ze,selectedSubCategory:We}),Object(L.jsx)(z.a,{subCategories:He,onSelect:Ze,selectedSubCategory:We,initialValue:"".concat(null!==(q=null===(M=oe.attributes)||void 0===M||null===(X=M.sub_category)||void 0===X||null===(Q=X.data)||void 0===Q?void 0:Q.attributes.name)&&void 0!==q?q:"")}),Object(L.jsx)(O.a.Item,{name:"description",initialValue:null!==(W=null===(Z=oe.attributes)||void 0===Z?void 0:Z.description)&&void 0!==W?W:"",children:Object(L.jsx)(Ke,{rows:4,placeholder:"Deskripsi"})})]}),Object(L.jsxs)("div",{className:"w-full md:w-1/3 px-3 mb-2 md:mb-0",children:[Object(L.jsx)(O.a.Item,{name:"SKU",rules:[{required:!0,message:"SKU tidak boleh kosong!"}],initialValue:null!==($=null===(Y=oe.attributes)||void 0===Y?void 0:Y.SKU)&&void 0!==$?$:"",children:Object(L.jsx)(h.a,{style:{height:"40px"},placeholder:"SKU"})}),Object(L.jsx)(F.a,{data:se.data,initialValue:null===(ee=oe.attributes)||void 0===ee||null===(te=ee.manufacture)||void 0===te?void 0:te.data,onSelect:De}),Object(L.jsx)(K.a,{data:ue,onSelect:Re,initialValue:null===(ne=oe.attributes)||void 0===ne||null===(ae=ne.group)||void 0===ae?void 0:ae.data}),Object(L.jsx)(G.a,{required:!0,data:ce,onSelect:Le,initialValue:null===(re=oe.attributes)||void 0===re?void 0:re.locations.data})]}),Object(L.jsx)("div",{className:"w-full md:w-1/3 px-3 mb-2 md:mb-0",children:Object(L.jsx)(ze,H(H({},tt),{},{children:null==ve?Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)("p",{className:"ant-upload-drag-icon",children:Object(L.jsx)(u.a,{})}),Object(L.jsx)("p",{className:"ant-upload-text",children:"Klik atau tarik gambar ke kotak ini"}),Object(L.jsx)("p",{className:"ant-upload-hint  m-3",children:"Gambar akan digunakan sebagai contoh tampilan produk"})]}):Object(L.jsx)(I.a,{layout:"fill",loader:function(e){e.src;return"https://js-strapi.keelola.net/api"+(null===ve||void 0===ve?void 0:ve.url)},src:"https://js-strapi.keelola.net/api"+(null===ve||void 0===ve?void 0:ve.url)})}))})]}),Object(L.jsx)("div",{children:Object(L.jsx)("h6",{className:"",children:"HARGA"})}),Object(L.jsx)(D.a,{initialValue:oe.attributes,getDescUnit:function(){var e,t,n,a,r,i,o,s,u,c,l=qe.getFieldsValue(["unit_1","qty_1","unit_2","qty_2","unit_3","qty_3","unit_4","qty_4","unit_5","qty_5"]),d="".concat(null!==(e=l.qty_1)&&void 0!==e?e:""," ").concat(null!==(t=l.unit_1)&&void 0!==t?t:""," "),p="".concat(null!==(n=l.qty_2)&&void 0!==n?n:""," ").concat(null!==(a=l.unit_2)&&void 0!==a?a:""," "),b="".concat(null!==(r=l.qty_3)&&void 0!==r?r:""," ").concat(null!==(i=l.unit_3)&&void 0!==i?i:""," "),j="".concat(null!==(o=l.qty_4)&&void 0!==o?o:""," ").concat(null!==(s=l.unit_4)&&void 0!==s?s:""," "),v="".concat(null!==(u=l.qty_5)&&void 0!==u?u:""," ").concat(null!==(c=l.unit_5)&&void 0!==c?c:""," ");et(d+p+b+j+v)},descUnit:Ye}),Object(L.jsx)(O.a.Item,{children:Ae?Object(L.jsx)("div",{className:" flex float-left ml-3 ",children:Object(L.jsx)(o.a,{})}):Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(U.a,{onConfirm:function(){var e;return null===Fe||void 0===Fe||null===(e=Fe.current)||void 0===e?void 0:e.click()},onCancel:function(){},title:"Edit Produk",message:"Apakah anda yakin ingin mengedit produk ini?",component:Object(L.jsx)(r.a,{className:" hover:text-white hover:bg-cyan-700 border border-cyan-700 ml-1",children:"Simpan"})}),Object(L.jsx)(r.a,{htmlType:"submit",ref:Fe})]})})]})})]})})]})};X.getInitialProps=function(){var e=Object(j.a)(k.a.mark((function e(t){var n,a,r,i,o,s,u,c,l,d,p,b,j,v,h;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=E.a.get(t),e.next=3,Q(a,t);case 3:return r=e.sent,e.next=6,r.json();case 6:return i=e.sent,o=null===(n=i.data.attributes.category.data)||void 0===n?void 0:n.id,e.next=10,W(a);case 10:return s=e.sent,e.next=13,s.json();case 13:return u=e.sent,e.next=16,Y(a);case 16:return c=e.sent,e.next=19,c.json();case 19:return l=e.sent,e.next=22,ee(a);case 22:return d=e.sent,e.next=25,d.json();case 25:return p=e.sent,e.next=28,Z(a);case 28:return b=e.sent,e.next=31,b.json();case 31:return j=e.sent,e.next=34,$(a,o);case 34:return v=e.sent,e.next=37,v.json();case 37:return h=e.sent,e.abrupt("return",{props:{product:i,categories:u,groups:l,locations:p,manufactures:j,subCategories:h}});case 39:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var Q=function(){var e=Object(j.a)(k.a.mark((function e(t,n){var a,r,i,o;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.query.id,r="https://js-strapi.keelola.net/api/products/"+a+"?populate=*",i={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=5,fetch(r,i);case 5:return o=e.sent,e.abrupt("return",o);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),W=function(){var e=Object(j.a)(k.a.mark((function e(t){var n,a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://js-strapi.keelola.net/api/categories",n={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=4,fetch("https://js-strapi.keelola.net/api/categories",n);case 4:return a=e.sent,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=Object(j.a)(k.a.mark((function e(t){var n,a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://js-strapi.keelola.net/api/manufactures",n={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=4,fetch("https://js-strapi.keelola.net/api/manufactures",n);case 4:return a=e.sent,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$=function(){var e=Object(j.a)(k.a.mark((function e(t,n){var a,r,i;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="https://js-strapi.keelola.net/api/sub-categories?populate[category][filters][id][$eq]="+n,r={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=4,fetch(a,r);case 4:return i=e.sent,e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Y=function(){var e=Object(j.a)(k.a.mark((function e(t){var n,a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://js-strapi.keelola.net/api/groups",n={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=4,fetch("https://js-strapi.keelola.net/api/groups",n);case 4:return a=e.sent,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=Object(j.a)(k.a.mark((function e(t){var n,a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://js-strapi.keelola.net/api/locations",n={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=4,fetch("https://js-strapi.keelola.net/api/locations",n);case 4:return a=e.sent,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();t.default=X}},[["BZEI",0,1,13,2,3,4,5,6,7,9,8,10,12,11,14,15,16,17,18,19,21,22,25,26,30]]]);