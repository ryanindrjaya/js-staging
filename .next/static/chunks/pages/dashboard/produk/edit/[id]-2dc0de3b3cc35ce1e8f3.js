_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[75],{BZEI:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/produk/edit/[id]",function(){return a("bAmt")}])},bAmt:function(e,t,a){"use strict";a.r(t),function(e){var n=a("4IMT"),r=a.n(n),i=a("MM9K"),o=a.n(i),s=a("Vti8"),c=a.n(s),u=a("cpVT"),l=a("QpBz"),d=a.n(l),p=a("rg98"),b=a("iJl9"),j=a.n(b),h=a("B8+X"),v=a.n(h),f=a("qu0K"),m=a.n(f),g=a("xvhg"),x=a("vJKn"),O=a.n(x),k=a("q1tI"),y=a("g4pe"),w=a.n(y),S=a("kM/w"),_=a("PKTO"),T=a("NyWP"),N=a.n(T),P=a("FGyW"),C=a("20a2"),E=a("Aiso"),I=a.n(E),A=a("0Jbt"),B=a("xBBV"),V=a("zf01"),G=a("ml6N"),z=a("k1kd"),K=a("+zqw"),D=a("Sqsd"),F=a("HAFu"),R=a("nKUr");function U(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function q(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?U(Object(a),!0).forEach((function(t){Object(u.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):U(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var L=function(t){var a,n,i,s,u,l,b,h,f,x,y,T,E,U,L,J,H,M,X,W,Z,Q,$,Y,ee=t.props;console.log(ee);var te=null===ee||void 0===ee?void 0:ee.product.data.id,ae=null===ee||void 0===ee||null===(a=ee.product)||void 0===a?void 0:a.data,ne=null===ee||void 0===ee?void 0:ee.manufactures,re=null===ee||void 0===ee?void 0:ee.groups,ie=null===ee||void 0===ee?void 0:ee.locations,oe=null===ae||void 0===ae||null===(n=ae.attributes)||void 0===n||null===(i=n.category)||void 0===i?void 0:i.data,se=null===ae||void 0===ae||null===(s=ae.attributes)||void 0===s||null===(u=s.sub_category)||void 0===u?void 0:u.data,ce=Object(k.useState)(null!==(l=ae.attributes)&&void 0!==l&&null!==(b=l.image)&&void 0!==b&&b.data?null===(h=ae.attributes)||void 0===h||null===(f=h.image)||void 0===f?void 0:f.data[0].attributes:null),ue=ce[0],le=ce[1],de=Object(k.useState)(),pe=de[0],be=de[1],je=Object(k.useState)(oe.id),he=je[0],ve=(je[1],Object(k.useState)(!0)),fe=ve[0],me=ve[1],ge=Object(k.useState)([]),xe=ge[0],Oe=ge[1],ke=m.a.useForm(),ye=Object(g.a)(ke,1)[0],we=Object(k.useState)(!1),Se=we[0],_e=we[1],Te=N.a.get(null,"token"),Ne=Object(C.useRouter)(),Pe=v.a.Dragger,Ce=j.a.TextArea,Ee=Object(k.useState)({}),Ie=(Ee[0],Ee[1]),Ae=Object(k.useState)({}),Be=(Ae[0],Ae[1]),Ve=Object(k.useState)(),Ge=(Ve[0],Ve[1]),ze=Object(k.useState)([]),Ke=ze[0],De=ze[1],Fe=Object(k.useState)(),Re=Fe[0],Ue=Fe[1];var qe={name:"files",multiple:!1,fileList:xe,showUploadList:{showDownloadIcon:!1,showRemoveIcon:!0},onRemove:function(e){me(!0),le(),Oe([])},onChange:function(e){return Object(p.a)(O.a.mark((function t(){var a,n,r,i,o;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(1!==e.fileList.length){t.next=18;break}if("https://js-strapi.keelola.net/api/upload",a=e.file.originFileObj,(n=new FormData).append("files",a),Oe(e.fileList),r={method:"POST",headers:{Authorization:"Bearer "+Te.token},body:n},!fe){t.next=16;break}return me(!1),t.next=11,fetch("https://js-strapi.keelola.net/api/upload",r);case 11:return i=t.sent,t.next=14,i.json();case 14:o=t.sent,200===i.status?(le(o[0]),d.a.success("".concat(e.file.name," berhasil diupload"))):d.a.error("".concat(e.file.name," gagal upload"));case 16:t.next=19;break;case 18:0===e.fileList.length?d.a.info("Gambar berhasil dihapus"):d.a.error("Hanya dapat menambahkan 1 gambar");case 19:case"end":return t.stop()}}),t)})))()}},Le=function(e){return e.category_id==="".concat(oe.attributes.category_id," - ").concat(oe.attributes.name)?(console.log("category tidak berubah. jadikan id"),e.category_id=he):(console.log("category berubah. jadikan tipe int"),e.category_id=parseInt(e.category_id)),e},Je=function(e){return e.subCategories===se.attributes.name?(console.log("sub category tidak berubah. jadikan id"),e.subCategories=se.id):(console.log("sub category berubah. jadikan tipe int"),e.subCategories=parseInt(e.subCategories)),e},He=function(){var e=Object(p.a)(O.a.mark((function e(t){var a,n,r,i,o,s,c,u,l,d,p,b,j,h,v,f,m,g,x,k,y;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(_e(!0),console.log(t),t=Le(t),t=Je(t),o={id:parseInt(null===(a=t)||void 0===a?void 0:a.category_id)},s={id:null===(n=t)||void 0===n?void 0:n.subCategories},c={id:null===(r=t)||void 0===r?void 0:r.manufactures},u={id:null===(i=t)||void 0===i?void 0:i.groups},l=[],d=0;d<t.locations.length;d++)l.push({id:t.locations[d]});for(b in delete t.locations,delete t.category_id,delete t.subCategories,delete t.manufactures,delete t.groups,p={category:o,sub_category:s,manufacture:c,group:u,locations:l,image:{id:null===ue||void 0===ue?void 0:ue.id}},t)void 0!==t[b]&&null!==t[b]||delete t[b];for(j in p)void 0!==p[j].id&&NaN!==p[j].id||delete p[j];for(h=q(q({},t),p),v=1;v<6;v++)"-"===h["purchase_discount_".concat(v)]&&delete h["purchase_discount_".concat(v)];return f={data:h},m=JSON.stringify(f),g={method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer "+Te.token},body:m},x="https://js-strapi.keelola.net/api/products/"+te,e.next=26,fetch(x,g);case 26:return k=e.sent,e.next=29,k.json();case 29:y=e.sent,console.log("dataput ",f),console.log(k),console.log(y),200===k.status?(P.b.success("Produk berhasil diperbarui!",{position:P.b.POSITION.TOP_RIGHT}),Ne.push("/dashboard/produk")):P.b.error("Tidak dapat memperbarui Produk",{position:P.b.POSITION.TOP_RIGHT}),_e(!1);case 35:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(w.a,{children:Object(R.jsx)("title",{children:"Edit Produk"})}),Object(R.jsx)(A.a,{children:Object(R.jsxs)(_.a,{style:{},children:[Object(R.jsx)(B.a,{titleText:"Edit Produk"}),Object(R.jsx)(S.a,{children:Object(R.jsxs)(m.a,{form:ye,name:"edit_product",initialValues:{remember:!0},onFinish:He,children:[Object(R.jsxs)("div",{className:"flex flex-wrap -mx-3 mb-3",children:[Object(R.jsxs)("div",{className:"w-full md:w-1/3 px-3 mb-2 md:mb-0",children:[Object(R.jsx)(m.a.Item,{name:"name",initialValue:null===ae||void 0===ae||null===(x=ae.attributes)||void 0===x?void 0:x.name,rules:[{required:!0,message:"Nama Produk tidak boleh kosong!"}],children:Object(R.jsx)(j.a,{style:{height:"40px"},placeholder:"Nama Produk"})}),Object(R.jsx)(V.a,{initialValue:"".concat(oe.attributes.category_id," - ").concat(oe.attributes.name),selectedCategory:pe,onSelectCategory:be,setSubCategories:De,setSelectedSubCategory:Ue,selectedSubCategory:Re}),Object(R.jsx)(z.a,{subCategories:Ke,onSelect:Ue,selectedSubCategory:Re,initialValue:"".concat(null!==(y=null===(T=ae.attributes)||void 0===T||null===(E=T.sub_category)||void 0===E||null===(U=E.data)||void 0===U?void 0:U.attributes.name)&&void 0!==y?y:"")}),Object(R.jsx)(m.a.Item,{name:"description",initialValue:null!==(L=null===(J=ae.attributes)||void 0===J?void 0:J.description)&&void 0!==L?L:"",children:Object(R.jsx)(Ce,{rows:4,placeholder:"Deskripsi"})})]}),Object(R.jsxs)("div",{className:"w-full md:w-1/3 px-3 mb-2 md:mb-0",children:[Object(R.jsx)(m.a.Item,{name:"SKU",initialValue:null!==(H=null===(M=ae.attributes)||void 0===M?void 0:M.SKU)&&void 0!==H?H:"",children:Object(R.jsx)(j.a,{style:{height:"40px"},placeholder:"SKU"})}),Object(R.jsx)(G.a,{data:ne.data,initialValue:null===(X=ae.attributes)||void 0===X||null===(W=X.manufacture)||void 0===W||null===(Z=W.data)||void 0===Z?void 0:Z.id,onSelect:Ie}),Object(R.jsx)(K.a,{data:re,onSelect:Be,initialValue:null===(Q=ae.attributes)||void 0===Q||null===($=Q.group)||void 0===$||null===(Y=$.data)||void 0===Y?void 0:Y.id}),Object(R.jsx)(D.a,{data:ie,onSelect:Ge,initialValue:function(){var e=[];return ie.data.forEach((function(t){e.push(t.attributes.name)})),e}()})]}),Object(R.jsx)("div",{className:"w-full md:w-1/3 px-3 mb-2 md:mb-0",children:Object(R.jsx)(Pe,q(q({},qe),{},{children:null==ue?Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("p",{className:"ant-upload-drag-icon",children:Object(R.jsx)(c.a,{})}),Object(R.jsx)("p",{className:"ant-upload-text",children:"Klik atau tarik gambar ke kotak ini"}),Object(R.jsx)("p",{className:"ant-upload-hint  m-3",children:"Gambar akan digunakan sebagai contoh tampilan produk"})]}):Object(R.jsx)(I.a,{layout:"fill",loader:function(t){t.src;return e.env.BASE_URL+(null===ue||void 0===ue?void 0:ue.url)},src:e.env.BASE_URL+(null===ue||void 0===ue?void 0:ue.url)})}))})]}),Object(R.jsx)("div",{children:Object(R.jsx)("h6",{className:"",children:"HARGA"})}),Object(R.jsx)(F.a,{initialValue:ae.attributes}),Object(R.jsx)(m.a.Item,{className:"mt-5",children:Se?Object(R.jsx)("div",{className:" flex float-left ml-3 ",children:Object(R.jsx)(o.a,{})}):Object(R.jsx)(r.a,{htmlType:"submit",className:" hover:text-white hover:bg-cyan-700 border border-cyan-700 ml-1",children:"Simpan"})})]})})]})})]})};L.getInitialProps=function(){var e=Object(p.a)(O.a.mark((function e(t){var a,n,r,i,o,s,c,u,l,d,p,b,j,h,v;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=N.a.get(t),e.next=3,J(n,t);case 3:return r=e.sent,e.next=6,r.json();case 6:return i=e.sent,o=null===(a=i.data.attributes.category.data)||void 0===a?void 0:a.id,e.next=10,H(n);case 10:return s=e.sent,e.next=13,s.json();case 13:return c=e.sent,e.next=16,W(n);case 16:return u=e.sent,e.next=19,u.json();case 19:return l=e.sent,e.next=22,Z(n);case 22:return d=e.sent,e.next=25,d.json();case 25:return p=e.sent,e.next=28,M(n);case 28:return b=e.sent,e.next=31,b.json();case 31:return j=e.sent,e.next=34,X(n,o);case 34:return h=e.sent,e.next=37,h.json();case 37:return v=e.sent,e.abrupt("return",{props:{product:i,categories:c,groups:l,locations:p,manufactures:j,subCategories:v}});case 39:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var J=function(){var e=Object(p.a)(O.a.mark((function e(t,a){var n,r,i,o;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.query.id,r="https://js-strapi.keelola.net/api/products/"+n+"?populate=*",i={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=5,fetch(r,i);case 5:return o=e.sent,e.abrupt("return",o);case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),H=function(){var e=Object(p.a)(O.a.mark((function e(t){var a,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://js-strapi.keelola.net/api/categories",a={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=4,fetch("https://js-strapi.keelola.net/api/categories",a);case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M=function(){var e=Object(p.a)(O.a.mark((function e(t){var a,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://js-strapi.keelola.net/api/manufactures",a={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=4,fetch("https://js-strapi.keelola.net/api/manufactures",a);case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),X=function(){var e=Object(p.a)(O.a.mark((function e(t,a){var n,r,i;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="https://js-strapi.keelola.net/api/sub-categories?populate[category][filters][id][$eq]="+a,r={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=4,fetch(n,r);case 4:return i=e.sent,e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),W=function(){var e=Object(p.a)(O.a.mark((function e(t){var a,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://js-strapi.keelola.net/api/groups",a={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=4,fetch("https://js-strapi.keelola.net/api/groups",a);case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=Object(p.a)(O.a.mark((function e(t){var a,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://js-strapi.keelola.net/api/locations",a={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=4,fetch("https://js-strapi.keelola.net/api/locations",a);case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();t.default=L}.call(this,a("8oxB"))}},[["BZEI",0,1,13,2,3,4,5,6,7,9,8,10,12,11,14,15,16,17,18,19,20,22,25,26,30]]]);