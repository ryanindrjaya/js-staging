_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[92],{"12ph":function(e,t,a){"use strict";function n(e,t,a){var n;return function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];var i=function(){n=null,a||e.apply(void 0,s)},c=a&&!n;clearTimeout(n),n=setTimeout(i,t),c&&e.apply(void 0,s)}}a.r(t),a.d(t,"default",(function(){return n}))},FkZG:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/produk/tambah",function(){return a("wgPJ")}])},wgPJ:function(e,t,a){"use strict";a.r(t),function(e){var n=a("4IMT"),r=a.n(n),s=a("MM9K"),o=a.n(s),i=a("Vti8"),c=a.n(i),u=a("rR1Q"),l=a.n(u),d=a("cpVT"),p=a("QpBz"),b=a.n(p),h=a("rg98"),j=a("iJl9"),f=a.n(j),m=a("B8+X"),O=a.n(m),v=a("qu0K"),x=a.n(v),g=a("xvhg"),k=a("vJKn"),w=a.n(k),y=a("q1tI"),S=a("g4pe"),_=a.n(S),T=a("kM/w"),P=a("PKTO"),N=a("NyWP"),C=a.n(N),K=a("FGyW"),U=a("0Jbt"),I=a("xBBV"),q=a("zf01"),A=a("ml6N"),E=a("k1kd"),F=a("+zqw"),B=a("Sqsd"),G=a("20a2"),z=a("Aiso"),R=a.n(z),D=a("HAFu"),J=a("RnN9"),L=a("lzg3"),H=a("n6RN"),M=a("12ph"),V=a("nKUr");function X(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Q(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?X(Object(a),!0).forEach((function(t){Object(d.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):X(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var W=function(t){var a=t.props,n=Object(y.useState)(),s=n[0],i=n[1],u=Object(y.useState)(),d=u[0],p=u[1],j=Object(y.useState)(!0),m=j[0],v=j[1],k=Object(y.useState)([]),S=k[0],N=k[1],z=Object(y.useState)({status:"",message:""}),X=z[0],W=z[1],Z=x.a.useForm(),$=Object(g.a)(Z,1)[0],Y=Object(y.useState)(!1),ee=Y[0],te=Y[1],ae=Object(y.useState)(!0),ne=ae[0],re=(ae[1],C.a.get(null,"token")),se=Object(G.useRouter)(),oe=Object(y.useRef)(),ie=O.a.Dragger,ce=f.a.TextArea,ue=a.manufactures,le=a.groups,de=a.locations,pe=Object(y.useState)({}),be=pe[0],he=pe[1],je=Object(y.useState)({}),fe=je[0],me=je[1],Oe=Object(y.useState)({}),ve=(Oe[0],Oe[1]),xe=Object(y.useState)([]),ge=xe[0],ke=xe[1],we=Object(y.useState)(),ye=we[0],Se=we[1],_e=Object(y.useState)(),Te=_e[0],Pe=_e[1],Ne={name:"files",multiple:!1,fileList:S,showUploadList:{showDownloadIcon:!1,showRemoveIcon:!0},onRemove:function(e){v(!0),i(),N([])},onChange:function(e){return Object(h.a)(w.a.mark((function t(){var a,n,r,s,o;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(1!==e.fileList.length){t.next=18;break}if("https://strapi-js.keelola.web.id/api/upload",a=e.file.originFileObj,(n=new FormData).append("files",a),N(e.fileList),r={method:"POST",headers:{Authorization:"Bearer "+re.token},body:n},!m){t.next=16;break}return v(!1),t.next=11,fetch("https://strapi-js.keelola.web.id/api/upload",r);case 11:return s=t.sent,t.next=14,s.json();case 14:o=t.sent,200===s.status?(i(o[0]),b.a.success("".concat(e.file.name," berhasil diupload"))):b.a.error("".concat(e.file.name," gagal upload"));case 16:t.next=19;break;case 18:0===e.fileList.length?b.a.info("Gambar berhasil dihapus"):b.a.error("Hanya dapat menambahkan 1 gambar");case 19:case"end":return t.stop()}}),t)})))()}},Ce=function(){var e=Object(h.a)(w.a.mark((function e(t){var a,n,r,o,i,c,u,l,d;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return te(!0),n={id:parseInt(null===t||void 0===t?void 0:t.category_id)},r={id:null===t||void 0===t?void 0:t.subCategories},o={id:null===t||void 0===t?void 0:t.manufactures},i={id:null===t||void 0===t?void 0:t.groups},c=t.locations.map((function(e){return e})),delete t.locations,delete t.category_id,delete t.subCategories,delete t.manufactures,delete t.groups,u=Q(Q({},t),{},{locations:c}),l={category:n,sub_category:r,manufacture:o,group:i,locations:c,image:{id:null===s||void 0===s?void 0:s.id}},console.log("put data",l),e.next=16,Ke(u);case 16:return d=e.sent,console.log(d),e.next=20,Ue(null===d||void 0===d||null===(a=d.data)||void 0===a?void 0:a.id,l);case 20:te(!1);case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ke=function(){var e=Object(h.a)(w.a.mark((function e(t){var a,n,r,s,o;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://strapi-js.keelola.web.id/api/products",a={data:t},n=JSON.stringify(a),r={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+re.token},body:n},e.next=6,fetch("https://strapi-js.keelola.web.id/api/products",r);case 6:return s=e.sent,e.next=9,s.json();case 9:return o=e.sent,e.abrupt("return",o);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ue=function(){var e=Object(h.a)(w.a.mark((function e(t,a){var n,r,s,o,c,u,l,d,p;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r in n="https://strapi-js.keelola.web.id/api/products/"+t,a)void 0!==a[r].id&&NaN!==a[r].id||delete a[r];return s={data:a},o=JSON.stringify(s),c={method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer "+re.token},body:o},e.prev=5,e.next=8,fetch(n,c);case 8:return u=e.sent,e.next=11,u.json();case 11:l=e.sent,200===u.status?(i(),$.resetFields(),K.b.success("Produk berhasil ditambahkan!",{position:K.b.POSITION.TOP_RIGHT}),se.reload()):null===l||void 0===l||null===(d=l.error)||void 0===d||null===(p=d.details)||void 0===p||p.errors.map((function(e){var t=e.path[0];K.b.error("SKU"===t?"SKU sudah digunakan":"Tidak dapat menambahkan Produk",{position:K.b.POSITION.TOP_RIGHT})})),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),K.b.error("Tidak dapat menambahkan Produk",{position:K.b.POSITION.TOP_RIGHT});case 18:case"end":return e.stop()}}),e,null,[[5,15]])})));return function(t,a){return e.apply(this,arguments)}}(),Ie=function(){var e=Object(h.a)(w.a.mark((function e(t){var a,n,r,s;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return W({status:"validating",message:""}),a="https://strapi-js.keelola.web.id/api/products?filters[SKU][$eq]="+t,n={method:"GET",headers:{Authorization:"Bearer "+re.token}},e.next=5,fetch(a,n);case 5:return r=e.sent,e.next=8,r.json();case 8:s=e.sent,200===r.status?s.data.length>0?W({status:"error",message:"SKU sudah digunakan"}):W({status:"success",message:""}):W({status:"error",message:"Error ketika mengambil data SKU"});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),qe=function(){var e=Object(h.a)(w.a.mark((function e(t,a){var n,r,s;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Object.keys(t)[0],r=n.split("_"),s=r[r.length-1],"SKU"===n&&""!==a.SKU?Object(M.default)(Ie,1e3)(a.SKU):"SKU"===n&&""===a.SKU&&W({status:"error",message:"SKU tidak boleh kosong"}),Object(J.default)($,t,a,n,ne),Object(L.default)($,t,a,s,ne);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}();return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(_.a,{children:Object(V.jsx)("title",{children:"Tambahkan Produk"})}),Object(V.jsx)(U.a,{children:Object(V.jsxs)(P.a,{style:{},children:[Object(V.jsx)(I.a,{titleText:"Tambahkan Produk"}),Object(V.jsx)(T.a,{children:Object(V.jsxs)(x.a,{form:$,name:"add_product",initialValues:{remember:!0},onFinishFailed:function(){$.getFieldsError().forEach((function(e){if(0!==e.errors.length){var t=e.errors[0];l.a.error({message:"Field Masih Kosong",description:t})}}))},onFinish:Ce,onValuesChange:qe,children:[Object(V.jsxs)("div",{className:"flex flex-wrap -mx-3 mb-3",children:[Object(V.jsxs)("div",{className:"w-full md:w-1/3 px-3 mb-2 md:mb-0",children:[Object(V.jsx)(x.a.Item,{name:"name",rules:[{required:!0,message:"Nama Produk tidak boleh kosong!"}],children:Object(V.jsx)(f.a,{style:{height:"40px"},placeholder:"Nama Produk"})}),Object(V.jsx)(q.a,{selectedCategory:d,onSelectCategory:p,setSubCategories:ke,setSelectedSubCategory:Se,selectedSubCategory:ye}),Object(V.jsx)(E.a,{subCategories:ge,onSelect:Se,selectedSubCategory:ye}),Object(V.jsx)(x.a.Item,{name:"description",children:Object(V.jsx)(ce,{rows:4,placeholder:"Deskripsi"})})]}),Object(V.jsxs)("div",{className:"w-full md:w-1/3 px-3 mb-2 md:mb-0",children:[Object(V.jsx)(x.a.Item,{name:"SKU",hasFeedback:!0,validateStatus:X.status,help:X.message,rules:[{required:!0,message:"SKU tidak boleh kosong!"}],children:Object(V.jsx)(f.a,{style:{height:"40px"},placeholder:"SKU"})}),Object(V.jsx)(A.a,{data:ue.data,selectedManufactures:be,onSelect:he}),Object(V.jsx)(F.a,{data:le,selectedGroups:fe,onSelect:me}),Object(V.jsx)(B.a,{data:de,onSelect:ve,required:!0})]}),Object(V.jsx)("div",{className:"w-full md:w-1/3 px-3 mb-2 md:mb-0",children:Object(V.jsx)(ie,Q(Q({},Ne),{},{children:null==s?Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("p",{className:"ant-upload-drag-icon",children:Object(V.jsx)(c.a,{})}),Object(V.jsx)("p",{className:"ant-upload-text",children:"Klik atau tarik gambar ke kotak ini"}),Object(V.jsx)("p",{className:"ant-upload-hint  m-3",children:"Gambar akan digunakan sebagai contoh tampilan produk"})]}):Object(V.jsx)(R.a,{layout:"fill",loader:function(t){t.src;return e.env.BASE_URL+(null===s||void 0===s?void 0:s.url)},src:e.env.BASE_URL+(null===s||void 0===s?void 0:s.url)})}))})]}),Object(V.jsx)("div",{children:Object(V.jsx)("h6",{className:"",children:"HARGA"})}),Object(V.jsx)(D.a,{getDescUnit:function(){var e,t,a,n,r,s,o,i,c,u,l=$.getFieldsValue(["unit_1","qty_1","unit_2","qty_2","unit_3","qty_3","unit_4","qty_4","unit_5","qty_5"]),d="".concat(null!==(e=l.qty_1)&&void 0!==e?e:""," ").concat(null!==(t=l.unit_1)&&void 0!==t?t:""," "),p="".concat(null!==(a=l.qty_2)&&void 0!==a?a:""," ").concat(null!==(n=l.unit_2)&&void 0!==n?n:""," "),b="".concat(null!==(r=l.qty_3)&&void 0!==r?r:""," ").concat(null!==(s=l.unit_3)&&void 0!==s?s:""," "),h="".concat(null!==(o=l.qty_4)&&void 0!==o?o:""," ").concat(null!==(i=l.unit_4)&&void 0!==i?i:""," "),j="".concat(null!==(c=l.qty_5)&&void 0!==c?c:""," ").concat(null!==(u=l.unit_5)&&void 0!==u?u:""," ");Pe(d+p+b+h+j)},descUnit:Te}),Object(V.jsx)(x.a.Item,{className:"mt-5",children:ee?Object(V.jsx)("div",{className:" flex float-left ml-3 ",children:Object(V.jsx)(o.a,{})}):Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(H.a,{onConfirm:function(){var e;return null===oe||void 0===oe||null===(e=oe.current)||void 0===e?void 0:e.click()},onCancel:function(){},title:"Tambah Produk",message:"Apakah anda yakin ingin menambahkan produk ini?",component:Object(V.jsx)(r.a,{className:" hover:text-white hover:bg-cyan-700 border border-cyan-700 ml-1",children:"Simpan"})}),Object(V.jsx)(r.a,{htmlType:"submit",ref:oe})]})})]})})]})})]})};W.getInitialProps=function(){var e=Object(h.a)(w.a.mark((function e(t){var a,n,r,s,o,i,c,u,l,d,p;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=C.a.get(t),e.next=3,Z(a);case 3:return n=e.sent,e.next=6,n.json();case 6:return r=e.sent,e.next=9,ee(a);case 9:return s=e.sent,e.next=12,s.json();case 12:return o=e.sent,e.next=15,te(a);case 15:return i=e.sent,e.next=18,i.json();case 18:return c=e.sent,e.next=21,$(a);case 21:return u=e.sent,e.next=24,u.json();case 24:return l=e.sent,e.next=27,Y(a);case 27:return d=e.sent,e.next=30,d.json();case 30:return p=e.sent,e.abrupt("return",{props:{categories:r,groups:o,locations:c,manufactures:l,subCategories:p}});case 32:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var Z=function(){var e=Object(h.a)(w.a.mark((function e(t){var a,n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://strapi-js.keelola.web.id/api/categories",a={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=4,fetch("https://strapi-js.keelola.web.id/api/categories",a);case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$=function(){var e=Object(h.a)(w.a.mark((function e(t){var a,n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://strapi-js.keelola.web.id/api/manufactures",a={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=4,fetch("https://strapi-js.keelola.web.id/api/manufactures",a);case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=Object(h.a)(w.a.mark((function e(t){var a,n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://strapi-js.keelola.web.id/api/sub-categories",a={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=4,fetch("https://strapi-js.keelola.web.id/api/sub-categories",a);case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=Object(h.a)(w.a.mark((function e(t){var a,n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://strapi-js.keelola.web.id/api/groups",a={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=4,fetch("https://strapi-js.keelola.web.id/api/groups",a);case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),te=function(){var e=Object(h.a)(w.a.mark((function e(t){var a,n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://strapi-js.keelola.web.id/api/locations",a={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.token}},e.next=4,fetch("https://strapi-js.keelola.web.id/api/locations",a);case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();t.default=W}.call(this,a("8oxB"))}},[["FkZG",0,1,13,2,3,4,5,6,7,9,8,10,12,11,14,15,16,17,18,19,21,22,25,26,30]]]);