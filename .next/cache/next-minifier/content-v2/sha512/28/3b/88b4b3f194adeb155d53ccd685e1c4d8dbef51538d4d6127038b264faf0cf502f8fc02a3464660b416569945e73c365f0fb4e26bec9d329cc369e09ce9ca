{"code":"_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[54],{\"85bS\":function(t,e,a){\"use strict\";a.r(e);var n=a(\"rg98\"),r=a(\"vJKn\"),s=a.n(r),i=(a(\"q1tI\"),a(\"NyWP\")),o=a.n(i),c=(a(\"wd/R\"),o.a.get(null,\"token\"));var u=function(){var t=Object(n.a)(s.a.mark((function t(e,a,n){var r,i,o,u;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=\"https://js-strapi.keelola.net/api\"+\"/inventory-details?filters[locations][id][$eq]=\".concat(n,\"&filters[products][id][$eq]=\").concat(a,\"&filters[expired_date][$eq]=2024-10-01&populate=*\"),i={method:\"GET\",headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \"+c.token}},t.next=4,fetch(r,i);case 4:return o=t.sent,t.next=7,o.json();case 7:(u=t.sent).data.length>0?p(u.data[0],e,a,n):l(e,a,n),d(e);case 10:case\"end\":return t.stop()}}),t)})));return function(e,a,n){return t.apply(this,arguments)}}(),p=function(){var t=Object(n.a)(s.a.mark((function t(e,a,n,r){var i,o,u,p,l,d,f;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.attributes.stock,o=i+a.data.stock,e.attributes.stock=o,e.attributes.locations=a.data.locations,e.attributes.products=a.data.products,u={data:e.attributes},p=JSON.stringify(u),l=\"https://js-strapi.keelola.net/api/inventory-details/\"+e.id,d={method:\"PUT\",headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \"+c.token},body:p},t.next=11,fetch(l,d);case 11:return f=t.sent,t.next=14,f.json();case 14:t.sent,200===f.status&&h(r,n,a.data.stock,a);case 16:case\"end\":return t.stop()}}),t)})));return function(e,a,n,r){return t.apply(this,arguments)}}(),l=function(){var t=Object(n.a)(s.a.mark((function t(e,a,n){var r,i,o;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=JSON.stringify(e),\"https://js-strapi.keelola.net/api/inventory-details\",i={method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \"+c.token},body:r},t.next=5,fetch(\"https://js-strapi.keelola.net/api/inventory-details\",i);case 5:return o=t.sent,t.next=8,o.json();case 8:t.sent,200===o.status&&h(n,a,e.data.stock,e);case 10:case\"end\":return t.stop()}}),t)})));return function(e,a,n){return t.apply(this,arguments)}}(),d=function(){var t=Object(n.a)(s.a.mark((function t(e){var a,n,r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=JSON.stringify(e),\"https://js-strapi.keelola.net/api/inventory-histories\",n={method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \"+c.token},body:a},t.next=5,fetch(\"https://js-strapi.keelola.net/api/inventory-histories\",n);case 5:return r=t.sent,t.next=8,r.json();case 8:t.sent;case 9:case\"end\":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),h=function(){var t=Object(n.a)(s.a.mark((function t(e,a,n,r){var i,o,u,p,l;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=\"https://js-strapi.keelola.net/api\"+\"/inventories?filters[locations][id][$eq]=\".concat(e,\"&filters[products][id][$eq]=\").concat(a,\"&populate=locations\"),o={method:\"GET\",headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \"+c.token}},t.next=4,fetch(i,o);case 4:return u=t.sent,t.next=7,u.json();case 7:if(!((p=t.sent).data.length>0)){t.next=14;break}return l=p.data[0].attributes.total_stock+n,t.next=12,f(p.data[0].id,p.data[0].attributes,l);case 12:t.next=16;break;case 14:return t.next=16,b(r,e);case 16:case\"end\":return t.stop()}}),t)})));return function(e,a,n,r){return t.apply(this,arguments)}}(),f=function(){var t=Object(n.a)(s.a.mark((function t(e,a,n){var r,i,o,u;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.total_stock=n,a.locations={id:a.locations.data[0].id},r={data:a},i=JSON.stringify(r),o=\"https://js-strapi.keelola.net/api/inventories/\"+e,u={method:\"PUT\",headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \"+c.token},body:i},t.next=8,fetch(o,u);case 8:t.sent;case 9:case\"end\":return t.stop()}}),t)})));return function(e,a,n){return t.apply(this,arguments)}}(),b=function(){var t=Object(n.a)(s.a.mark((function t(e,a){var n,r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.data.total_stock=e.data.stock,e.data.locations={id:a},n=JSON.stringify(e),\"https://js-strapi.keelola.net/api/inventories\",r={method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \"+c.token},body:n},t.next=7,fetch(\"https://js-strapi.keelola.net/api/inventories\",r);case 7:t.sent;case 8:case\"end\":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}();e.default=function(t){t.attributes.purchasing_details.data.forEach((function(t){var e=new Date(t.attributes.expired_date),a=t.attributes.batch,n=t.attributes.unit_order,r=parseInt(t.attributes.total_order),s=t.attributes.product.data,i=function(t,e){for(var a=1,n=0,r=\"\",s=1;s<6;s++)e.attributes[\"unit_\".concat(s)]===t&&(n=s),e.attributes[\"unit_\".concat(s)]&&(r=e.attributes[\"unit_\".concat(s)]);for(var i=n+1;i<6;i++)0===(a*=e.attributes[\"qty_\".concat(i)])&&(a=1);return{total:a,productSmallestUnit:r}}(n,s),o=i.total*r,c=t.attributes.location.data,p={data:{expired_date:e,batch:a,products:{id:s.id},stock:o,smallest_unit:i.productSmallestUnit,locations:{id:c.id},keterangan:\"Pembelian\"}};u(p,s.id,c.id)}))}},AYpC:function(t,e,a){(window.__NEXT_P=window.__NEXT_P||[]).push([\"/dashboard/pembelian/pembelian_barang\",function(){return a(\"t4Ct\")}])},rg98:function(t,e,a){\"use strict\";function n(t,e,a,n,r,s,i){try{var o=t[s](i),c=o.value}catch(u){return void a(u)}o.done?e(c):Promise.resolve(c).then(n,r)}function r(t){return function(){var e=this,a=arguments;return new Promise((function(r,s){var i=t.apply(e,a);function o(t){n(i,r,s,o,c,\"next\",t)}function c(t){n(i,r,s,o,c,\"throw\",t)}o(void 0)}))}}a.d(e,\"a\",(function(){return r}))},t4Ct:function(t,e,a){\"use strict\";a.r(e);var n=a(\"rR1Q\"),r=a.n(n),s=a(\"iJl9\"),i=a.n(s),o=a(\"rg98\"),c=a(\"vJKn\"),u=a.n(c),p=a(\"g4pe\"),l=a.n(p),d=a(\"q1tI\"),h=a(\"kM/w\"),f=a(\"0Jbt\"),b=a(\"PKTO\"),j=a(\"20a2\"),v=a(\"xBBV\"),k=a(\"kc6U\"),x=a(\"NyWP\"),m=a.n(x),y=a(\"85bS\"),g=a(\"nKUr\");O.getInitialProps=function(){var t=Object(o.a)(u.a.mark((function t(e){var a,n,r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=m.a.get(e),t.next=3,w(a);case 3:return r=t.sent,t.next=6,r.json();case 6:return n=t.sent,t.abrupt(\"return\",{props:{data:n}});case 8:case\"end\":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();var w=function(){var t=Object(o.a)(u.a.mark((function t(e){var a,n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return\"https://js-strapi.keelola.net/api/purchasings?populate=deep\",a={method:\"GET\",headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \"+e.token}},t.next=4,fetch(\"https://js-strapi.keelola.net/api/purchasings?populate=deep\",a);case 4:return n=t.sent,t.abrupt(\"return\",n);case 6:case\"end\":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();function O(t){var e=t.props.data,a=Object(d.useState)(e),n=a[0],s=a[1],c=Object(d.useState)(!1),p=c[0],x=(c[1],i.a.Search),w=Object(j.useRouter)(),O=function(){var t=Object(o.a)(u.a.mark((function t(e){var a,n,r,i,o;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=m.a.get(null,\"token\"),n=\"https://js-strapi.keelola.net/api/purchases?pagination[page]=\"+e,r={method:\"GET\",headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \"+a.token}},t.prev=3,t.next=6,fetch(n,r);case 6:return i=t.sent,t.next=9,i.json();case 9:(o=t.sent)?s((function(t){return{data:filterDuplicateData(t.data.concat(o.data)),meta:t.meta}})):console.log(\"something is wrong\"),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(3),console.log(t.t0);case 16:case\"end\":return t.stop()}}),t,null,[[3,13]])})));return function(e){return t.apply(this,arguments)}}(),_=function(){var t=Object(o.a)(u.a.mark((function t(e){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case\"end\":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),T=function(){var t=Object(o.a)(u.a.mark((function t(e,a){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:S(\"Dibatalkan\",a);case 1:case\"end\":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),S=function(t,e){e.attributes.status=t;var a=e;\"Selesai\"===t&&Object(y.default)(e),P(a,a.id)},P=function(){var t=Object(o.a)(u.a.mark((function t(e,a){var n,r,i,o,c,p,l,d,h,f,b,j,v,k,x,y;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(c in delete e.attributes.purchase,e.attributes)null!==e.attributes[c]&&void 0!==e.attributes[c]||delete e.attributes[c];return null!==(null===(n=e.attributes)||void 0===n||null===(r=n.document)||void 0===r?void 0:r.data)&&void 0!==(null===(i=e.attributes)||void 0===i||null===(o=i.document)||void 0===o?void 0:o.data)||null===(p=e.attributes)||void 0===p||delete p.document,l=[],d=[],e.attributes.purchasing_details.data.forEach((function(t){l.push({id:t.id})})),e.attributes.purchasing_payments.data.forEach((function(t){d.push({id:t.id})})),e.attributes.supplier={id:e.attributes.supplier.data.id},e.attributes.location={id:e.attributes.location.data.id},e.attributes.purchasing_details=l,e.attributes.purchasing_payments=d,h={data:e.attributes},f=JSON.stringify(h),b=m.a.get(null,\"token\"),j=\"https://js-strapi.keelola.net/api/purchasings/\"+a,v={method:\"PUT\",headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \"+b.token},body:f},t.next=18,fetch(j,v);case 18:return k=t.sent,t.next=21,k.json();case 21:if(x=t.sent,200!==k.status){t.next=30;break}return t.next=25,C(b);case 25:y=t.sent,\"Dibatalkan\"===x.data.attributes.status?w.reload():s(y),N(\"success\",\"Status berhasil dirubah\",\"Status berhasil dirubah. Silahkan cek detail LPB\"),t.next=31;break;case 30:N(\"error\",\"Status gagal dirubah\",\"Tedapat kesalahan yang menyebabkan status tidak dapat dirubah\");case 31:case\"end\":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),C=function(){var t=Object(o.a)(u.a.mark((function t(e){var a,n,r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return\"https://js-strapi.keelola.net/api/purchasings?populate=deep\",a={method:\"GET\",headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \"+e.token}},t.next=4,fetch(\"https://js-strapi.keelola.net/api/purchasings?populate=deep\",a);case 4:return n=t.sent,r=n.json(),t.abrupt(\"return\",r);case 7:case\"end\":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),N=function(t,e,a){r.a[t]({message:e,description:a})};return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(l.a,{children:Object(g.jsx)(\"title\",{children:\"Pembelian Barang\"})}),Object(g.jsx)(f.a,{children:Object(g.jsxs)(b.a,{style:{},children:[Object(g.jsx)(v.a,{titleText:\"Lembar Pembelian Barang\"}),Object(g.jsxs)(h.a,{children:[Object(g.jsxs)(\"div\",{className:\"w-full flex justify-between\",children:[Object(g.jsx)(x,{className:\"\",loading:p,onChange:function(t){return _(t)},placeholder:\"Cari Pembelian\",style:{width:200}}),Object(g.jsx)(\"button\",{onClick:function(){w.push(\"/dashboard/pembelian/pembelian_barang/tambah\")},type:\"button\",className:\"bg-cyan-700 rounded px-5 py-2 hover:bg-cyan-800  shadow-sm flex float-right mb-5\",children:Object(g.jsx)(\"div\",{className:\"text-white text-center text-sm font-bold\",children:Object(g.jsx)(\"a\",{className:\"text-white no-underline text-xs sm:text-xs\",children:\"+ Tambah\"})})})]}),Object(g.jsx)(k.a,{data:n,onUpdate:function(t){N(\"info\",\"Work In Progress\",\"Hai, Fitur ini sedang dikerjakan. Silahkan tunggu pembaruan selanjutnya\")},onDelete:T,onPageChange:O,onChangeStatus:S})]})]})})]})}e.default=O}},[[\"AYpC\",0,1,13,20,2,3,4,5,6,7,9,8,10,12,11,14,16,17,18,19,24]]]);","map":{"version":3,"sources":["static/chunks/pages/dashboard/pembelian/pembelian_barang-ebabeaf06491183dd5cb.js"],"names":["_N_E","window","push","module","__webpack_exports__","__webpack_require__","r","_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__","_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__","_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default","n","nookies__WEBPACK_IMPORTED_MODULE_3__","nookies__WEBPACK_IMPORTED_MODULE_3___default","cookies","a","get","checkDetailStock","_ref","Object","mark","_callee","data","productId","locationId","endpoint","options","req","res","wrap","_context","prev","next","concat","method","headers","Authorization","token","fetch","sent","json","length","updateAPI","createAPI","createInventoryHistory","stop","_x","_x2","_x3","apply","this","arguments","_ref2","_callee2","resData","currentStock","finalStock","newData","JSONdata","_context2","attributes","stock","locations","products","JSON","stringify","id","body","status","createInventoryAPI","_x4","_x5","_x6","_x7","_ref3","_callee3","_context3","_x8","_x9","_x10","_ref4","_callee4","_context4","_x11","_ref5","_callee5","quantity","totalStock","_context5","total_stock","putExistingData","createNewData","_x12","_x13","_x14","_x15","_ref6","_callee6","putData","_context6","_x16","_x17","_x18","_ref7","_callee7","_context7","_x19","_x20","purchasing_details","forEach","element","expiredDate","Date","expired_date","batch","unitOrder","unit_order","totalOrder","parseInt","total_order","product","result","unit","total","productIndex","productSmallestUnit","index","_index","calculateTotalUnit","totalQty","location","smallest_unit","keterangan","AYpC","exports","__NEXT_P","rg98","asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","error","done","Promise","then","_asyncToGenerator","fn","self","args","err","undefined","d","t4Ct","antd_lib_notification__WEBPACK_IMPORTED_MODULE_0__","antd_lib_notification__WEBPACK_IMPORTED_MODULE_0___default","antd_lib_input__WEBPACK_IMPORTED_MODULE_1__","antd_lib_input__WEBPACK_IMPORTED_MODULE_1___default","_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__","_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3__","_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default","next_head__WEBPACK_IMPORTED_MODULE_4__","next_head__WEBPACK_IMPORTED_MODULE_4___default","react__WEBPACK_IMPORTED_MODULE_5__","_iso_components_utility_layoutContent__WEBPACK_IMPORTED_MODULE_6__","_containers_DashboardLayout_DashboardLayout__WEBPACK_IMPORTED_MODULE_7__","_iso_components_utility_layoutWrapper_js__WEBPACK_IMPORTED_MODULE_8__","next_router__WEBPACK_IMPORTED_MODULE_9__","_components_TitlePage_TitlePage__WEBPACK_IMPORTED_MODULE_10__","_components_ReactDataTable_Purchases_PurchasingTable__WEBPACK_IMPORTED_MODULE_11__","nookies__WEBPACK_IMPORTED_MODULE_12__","nookies__WEBPACK_IMPORTED_MODULE_12___default","_utility_createInventory__WEBPACK_IMPORTED_MODULE_13__","react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__","Pembelian","getInitialProps","context","fetchData","abrupt","props","_useState","purchase","setPurchase","_useState2","isSearching","Search","router","handlePageChange","page","prevData","filterDuplicateData","meta","console","log","t0","onSearch","e","handleCancel","row","onChangeStatus","dataStatus","handleChangeStatus","_ref8","values","_values$attributes","_values$attributes$do","_values$attributes2","_values$attributes2$d","_values$attributes3","purchasing_payments","newValues","response","document","supplier","reload","openNotificationWithIcon","_ref9","_callee8","_context8","type","title","message","description","children","style","titleText","className","loading","onChange","placeholder","width","onClick","onUpdate","onDelete","onPageChange"],"mappings":"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"},"name":"static/chunks/pages/dashboard/pembelian/pembelian_barang-ebabeaf06491183dd5cb.js","input":"_N_E =\n(window[\"webpackJsonp_N_E\"] = window[\"webpackJsonp_N_E\"] || []).push([[54],{\n\n/***/ \"85bS\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"rg98\");\n/* harmony import */ var _Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"vJKn\");\n/* harmony import */ var _Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"q1tI\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var nookies__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"NyWP\");\n/* harmony import */ var nookies__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(nookies__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(\"wd/R\");\n/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_4__);\n\n\n\n\n\n// In this scenario, we will look up for data in inventory details with params exp.date, productId, and LocationId\n// if data is already exist, then we should update the stock inventory details with the exp.date\n// if they are not, then we create a new inventory details\n// It happens with master inventory too. So basicly, we gonna check first. If exist, then UPDATE.\nvar cookies = nookies__WEBPACK_IMPORTED_MODULE_3___default.a.get(null, \"token\");\n\nvar calculateTotalUnit = function calculateTotalUnit(unit, product) {\n  var total = 1;\n  var productIndex = 0;\n  var productSmallestUnit = \"\";\n\n  for (var index = 1; index < 6; index++) {\n    if (product.attributes[\"unit_\".concat(index)] === unit) {\n      productIndex = index;\n    }\n\n    if (product.attributes[\"unit_\".concat(index)]) {\n      productSmallestUnit = product.attributes[\"unit_\".concat(index)];\n    }\n  }\n\n  for (var _index = productIndex + 1; _index < 6; _index++) {\n    total = total * product.attributes[\"qty_\".concat(_index)];\n\n    if (total === 0) {\n      total = 1;\n    }\n  }\n\n  return {\n    total: total,\n    productSmallestUnit: productSmallestUnit\n  };\n};\n\nfunction createInventory(data) {\n  var purchasingDetails = data.attributes.purchasing_details.data;\n  purchasingDetails.forEach(function (element) {\n    var expiredDate = new Date(element.attributes.expired_date);\n    var batch = element.attributes.batch;\n    var unitOrder = element.attributes.unit_order;\n    var totalOrder = parseInt(element.attributes.total_order);\n    var product = element.attributes.product.data;\n    var result = calculateTotalUnit(unitOrder, product);\n    var totalQty = result.total * totalOrder;\n    var location = element.attributes.location.data;\n    var data = {\n      data: {\n        expired_date: expiredDate,\n        batch: batch,\n        products: {\n          id: product.id\n        },\n        stock: totalQty,\n        smallest_unit: result.productSmallestUnit,\n        locations: {\n          id: location.id\n        },\n        keterangan: \"Pembelian\"\n      }\n    }; // check existing stock\n\n    checkDetailStock(data, product.id, location.id); //\n  });\n}\n\nvar checkDetailStock = /*#__PURE__*/function () {\n  var _ref = Object(_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])( /*#__PURE__*/_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(function _callee(data, productId, locationId) {\n    var endpoint, options, req, res;\n    return _Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            endpoint = \"https://js-strapi.keelola.net/api\" + \"/inventory-details?filters[locations][id][$eq]=\".concat(locationId, \"&filters[products][id][$eq]=\").concat(productId, \"&filters[expired_date][$eq]=2024-10-01&populate=*\");\n            options = {\n              method: \"GET\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: \"Bearer \" + cookies.token\n              }\n            };\n            _context.next = 4;\n            return fetch(endpoint, options);\n\n          case 4:\n            req = _context.sent;\n            _context.next = 7;\n            return req.json();\n\n          case 7:\n            res = _context.sent;\n\n            if (res.data.length > 0) {\n              updateAPI(res.data[0], data, productId, locationId);\n            } else {\n              createAPI(data, productId, locationId);\n            }\n\n            createInventoryHistory(data);\n\n          case 10:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function checkDetailStock(_x, _x2, _x3) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar updateAPI = /*#__PURE__*/function () {\n  var _ref2 = Object(_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])( /*#__PURE__*/_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(function _callee2(resData, data, productId, locationId) {\n    var currentStock, finalStock, newData, JSONdata, endpoint, options, req, res;\n    return _Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            currentStock = resData.attributes.stock;\n            finalStock = currentStock + data.data.stock;\n            resData.attributes.stock = finalStock;\n            resData.attributes.locations = data.data.locations;\n            resData.attributes.products = data.data.products;\n            newData = {\n              data: resData.attributes\n            };\n            JSONdata = JSON.stringify(newData);\n            endpoint = \"https://js-strapi.keelola.net/api\" + \"/inventory-details/\" + resData.id;\n            options = {\n              method: \"PUT\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: \"Bearer \" + cookies.token\n              },\n              body: JSONdata\n            };\n            _context2.next = 11;\n            return fetch(endpoint, options);\n\n          case 11:\n            req = _context2.sent;\n            _context2.next = 14;\n            return req.json();\n\n          case 14:\n            res = _context2.sent;\n\n            if (req.status === 200) {\n              createInventoryAPI(locationId, productId, data.data.stock, data);\n            }\n\n          case 16:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n\n  return function updateAPI(_x4, _x5, _x6, _x7) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nvar createAPI = /*#__PURE__*/function () {\n  var _ref3 = Object(_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])( /*#__PURE__*/_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(function _callee3(data, productId, locationId) {\n    var JSONdata, endpoint, options, req, res;\n    return _Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            JSONdata = JSON.stringify(data);\n            endpoint = \"https://js-strapi.keelola.net/api\" + \"/inventory-details\";\n            options = {\n              method: \"POST\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: \"Bearer \" + cookies.token\n              },\n              body: JSONdata\n            };\n            _context3.next = 5;\n            return fetch(endpoint, options);\n\n          case 5:\n            req = _context3.sent;\n            _context3.next = 8;\n            return req.json();\n\n          case 8:\n            res = _context3.sent;\n\n            if (req.status === 200) {\n              // check data location\n              createInventoryAPI(locationId, productId, data.data.stock, data);\n            }\n\n          case 10:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n\n  return function createAPI(_x8, _x9, _x10) {\n    return _ref3.apply(this, arguments);\n  };\n}();\n\nvar createInventoryHistory = /*#__PURE__*/function () {\n  var _ref4 = Object(_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])( /*#__PURE__*/_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(function _callee4(data) {\n    var JSONdata, endpoint, options, req, res;\n    return _Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            JSONdata = JSON.stringify(data);\n            endpoint = \"https://js-strapi.keelola.net/api\" + \"/inventory-histories\";\n            options = {\n              method: \"POST\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: \"Bearer \" + cookies.token\n              },\n              body: JSONdata\n            };\n            _context4.next = 5;\n            return fetch(endpoint, options);\n\n          case 5:\n            req = _context4.sent;\n            _context4.next = 8;\n            return req.json();\n\n          case 8:\n            res = _context4.sent;\n\n          case 9:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4);\n  }));\n\n  return function createInventoryHistory(_x11) {\n    return _ref4.apply(this, arguments);\n  };\n}(); // ======================= MASTER INVENTORY =======================\n\n\nvar createInventoryAPI = /*#__PURE__*/function () {\n  var _ref5 = Object(_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])( /*#__PURE__*/_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(function _callee5(locationId, productId, quantity, data) {\n    var endpoint, options, req, res, totalStock;\n    return _Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function _callee5$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            endpoint = \"https://js-strapi.keelola.net/api\" + \"/inventories?filters[locations][id][$eq]=\".concat(locationId, \"&filters[products][id][$eq]=\").concat(productId, \"&populate=locations\");\n            options = {\n              method: \"GET\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: \"Bearer \" + cookies.token\n              }\n            };\n            _context5.next = 4;\n            return fetch(endpoint, options);\n\n          case 4:\n            req = _context5.sent;\n            _context5.next = 7;\n            return req.json();\n\n          case 7:\n            res = _context5.sent;\n\n            if (!(res.data.length > 0)) {\n              _context5.next = 14;\n              break;\n            }\n\n            // put existing data\n            totalStock = res.data[0].attributes.total_stock + quantity;\n            _context5.next = 12;\n            return putExistingData(res.data[0].id, res.data[0].attributes, totalStock);\n\n          case 12:\n            _context5.next = 16;\n            break;\n\n          case 14:\n            _context5.next = 16;\n            return createNewData(data, locationId);\n\n          case 16:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, _callee5);\n  }));\n\n  return function createInventoryAPI(_x12, _x13, _x14, _x15) {\n    return _ref5.apply(this, arguments);\n  };\n}();\n\nvar putExistingData = /*#__PURE__*/function () {\n  var _ref6 = Object(_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])( /*#__PURE__*/_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(function _callee6(id, data, totalStock) {\n    var putData, JSONdata, endpoint, options, req;\n    return _Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function _callee6$(_context6) {\n      while (1) {\n        switch (_context6.prev = _context6.next) {\n          case 0:\n            data.total_stock = totalStock;\n            data.locations = {\n              id: data.locations.data[0].id\n            };\n            putData = {\n              data: data\n            };\n            JSONdata = JSON.stringify(putData);\n            endpoint = \"https://js-strapi.keelola.net/api\" + \"/inventories/\" + id;\n            options = {\n              method: \"PUT\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: \"Bearer \" + cookies.token\n              },\n              body: JSONdata\n            };\n            _context6.next = 8;\n            return fetch(endpoint, options);\n\n          case 8:\n            req = _context6.sent;\n\n          case 9:\n          case \"end\":\n            return _context6.stop();\n        }\n      }\n    }, _callee6);\n  }));\n\n  return function putExistingData(_x16, _x17, _x18) {\n    return _ref6.apply(this, arguments);\n  };\n}();\n\nvar createNewData = /*#__PURE__*/function () {\n  var _ref7 = Object(_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])( /*#__PURE__*/_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(function _callee7(data, locationId) {\n    var JSONdata, endpoint, options, req;\n    return _Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function _callee7$(_context7) {\n      while (1) {\n        switch (_context7.prev = _context7.next) {\n          case 0:\n            data.data.total_stock = data.data.stock;\n            data.data.locations = {\n              id: locationId\n            };\n            JSONdata = JSON.stringify(data);\n            endpoint = \"https://js-strapi.keelola.net/api\" + \"/inventories\";\n            options = {\n              method: \"POST\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: \"Bearer \" + cookies.token\n              },\n              body: JSONdata\n            };\n            _context7.next = 7;\n            return fetch(endpoint, options);\n\n          case 7:\n            req = _context7.sent;\n\n          case 8:\n          case \"end\":\n            return _context7.stop();\n        }\n      }\n    }, _callee7);\n  }));\n\n  return function createNewData(_x19, _x20) {\n    return _ref7.apply(this, arguments);\n  };\n}();\n\nvar getUserLocation = /*#__PURE__*/function () {\n  var _ref8 = Object(_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])( /*#__PURE__*/_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark(function _callee8(cookies) {\n    var endpoint, options, req, res;\n    return _Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap(function _callee8$(_context8) {\n      while (1) {\n        switch (_context8.prev = _context8.next) {\n          case 0:\n            endpoint = \"https://js-strapi.keelola.net/api\" + \"/users/me?populate=*\";\n            options = {\n              method: \"GET\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: \"Bearer \" + cookies.token\n              },\n              body: JSONdata\n            };\n            _context8.next = 4;\n            return fetch(endpoint, options);\n\n          case 4:\n            req = _context8.sent;\n            _context8.next = 7;\n            return req.json();\n\n          case 7:\n            res = _context8.sent;\n            return _context8.abrupt(\"return\", res);\n\n          case 9:\n          case \"end\":\n            return _context8.stop();\n        }\n      }\n    }, _callee8);\n  }));\n\n  return function getUserLocation(_x21) {\n    return _ref8.apply(this, arguments);\n  };\n}();\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (createInventory);\n\n/***/ }),\n\n/***/ \"AYpC\":\n/***/ (function(module, exports, __webpack_require__) {\n\n\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/dashboard/pembelian/pembelian_barang\",\n      function () {\n        return __webpack_require__(\"t4Ct\");\n      }\n    ]);\n  \n\n/***/ }),\n\n/***/ \"rg98\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return _asyncToGenerator; });\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\n/***/ }),\n\n/***/ \"t4Ct\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var antd_lib_notification__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"rR1Q\");\n/* harmony import */ var antd_lib_notification__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(antd_lib_notification__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var antd_lib_input__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"iJl9\");\n/* harmony import */ var antd_lib_input__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(antd_lib_input__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"rg98\");\n/* harmony import */ var _Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"vJKn\");\n/* harmony import */ var _Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var next_head__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(\"g4pe\");\n/* harmony import */ var next_head__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(next_head__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(\"q1tI\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var _iso_components_utility_layoutContent__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(\"kM/w\");\n/* harmony import */ var _containers_DashboardLayout_DashboardLayout__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(\"0Jbt\");\n/* harmony import */ var _iso_components_utility_layoutWrapper_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(\"PKTO\");\n/* harmony import */ var next_router__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(\"20a2\");\n/* harmony import */ var next_router__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(next_router__WEBPACK_IMPORTED_MODULE_9__);\n/* harmony import */ var _components_TitlePage_TitlePage__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(\"xBBV\");\n/* harmony import */ var _components_ReactDataTable_Purchases_PurchasingTable__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(\"kc6U\");\n/* harmony import */ var nookies__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(\"NyWP\");\n/* harmony import */ var nookies__WEBPACK_IMPORTED_MODULE_12___default = /*#__PURE__*/__webpack_require__.n(nookies__WEBPACK_IMPORTED_MODULE_12__);\n/* harmony import */ var _utility_createInventory__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(\"85bS\");\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(\"nKUr\");\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14___default = /*#__PURE__*/__webpack_require__.n(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPembelian.getInitialProps = /*#__PURE__*/function () {\n  var _ref = Object(_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__[/* default */ \"a\"])( /*#__PURE__*/_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark(function _callee(context) {\n    var cookies, data, req;\n    return _Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            cookies = nookies__WEBPACK_IMPORTED_MODULE_12___default.a.get(context);\n            _context.next = 3;\n            return fetchData(cookies);\n\n          case 3:\n            req = _context.sent;\n            _context.next = 6;\n            return req.json();\n\n          case 6:\n            data = _context.sent;\n            return _context.abrupt(\"return\", {\n              props: {\n                data: data\n              }\n            });\n\n          case 8:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function (_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar fetchData = /*#__PURE__*/function () {\n  var _ref2 = Object(_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__[/* default */ \"a\"])( /*#__PURE__*/_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark(function _callee2(cookies) {\n    var endpoint, options, req;\n    return _Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            endpoint = \"https://js-strapi.keelola.net/api\" + \"/purchasings?populate=deep\";\n            options = {\n              method: \"GET\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: \"Bearer \" + cookies.token\n              }\n            };\n            _context2.next = 4;\n            return fetch(endpoint, options);\n\n          case 4:\n            req = _context2.sent;\n            return _context2.abrupt(\"return\", req);\n\n          case 6:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n\n  return function fetchData(_x2) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nfunction Pembelian(_ref3) {\n  var props = _ref3.props;\n  var data = props.data;\n\n  var _useState = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useState\"])(data),\n      purchase = _useState[0],\n      setPurchase = _useState[1];\n\n  var _useState2 = Object(react__WEBPACK_IMPORTED_MODULE_5__[\"useState\"])(false),\n      isSearching = _useState2[0],\n      setIsSearching = _useState2[1];\n\n  var Search = antd_lib_input__WEBPACK_IMPORTED_MODULE_1___default.a.Search;\n  var router = Object(next_router__WEBPACK_IMPORTED_MODULE_9__[\"useRouter\"])();\n\n  var handleAdd = function handleAdd() {\n    router.push(\"/dashboard/pembelian/pembelian_barang/tambah\");\n  };\n\n  var handleUpdate = function handleUpdate(id) {\n    // router.push(\"/dashboard/pembelian/order_pembelian/edit/\" + id);\n    openNotificationWithIcon(\"info\", \"Work In Progress\", \"Hai, Fitur ini sedang dikerjakan. Silahkan tunggu pembaruan selanjutnya\");\n  };\n\n  var handlePageChange = /*#__PURE__*/function () {\n    var _ref4 = Object(_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__[/* default */ \"a\"])( /*#__PURE__*/_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark(function _callee3(page) {\n      var cookies, endpoint, options, req, res;\n      return _Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              cookies = nookies__WEBPACK_IMPORTED_MODULE_12___default.a.get(null, \"token\");\n              endpoint = \"https://js-strapi.keelola.net/api\" + \"/purchases?pagination[page]=\" + page;\n              options = {\n                method: \"GET\",\n                headers: {\n                  \"Content-Type\": \"application/json\",\n                  Authorization: \"Bearer \" + cookies.token\n                }\n              };\n              _context3.prev = 3;\n              _context3.next = 6;\n              return fetch(endpoint, options);\n\n            case 6:\n              req = _context3.sent;\n              _context3.next = 9;\n              return req.json();\n\n            case 9:\n              res = _context3.sent;\n\n              if (res) {\n                setPurchase(function (prevData) {\n                  return {\n                    data: filterDuplicateData(prevData.data.concat(res.data)),\n                    meta: prevData.meta\n                  };\n                });\n              } else {\n                console.log(\"something is wrong\");\n              }\n\n              _context3.next = 16;\n              break;\n\n            case 13:\n              _context3.prev = 13;\n              _context3.t0 = _context3[\"catch\"](3);\n              console.log(_context3.t0);\n\n            case 16:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, null, [[3, 13]]);\n    }));\n\n    return function handlePageChange(_x3) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var onSearch = /*#__PURE__*/function () {\n    var _ref5 = Object(_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__[/* default */ \"a\"])( /*#__PURE__*/_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark(function _callee4(e) {\n      return _Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function onSearch(_x4) {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  var searchQuery = /*#__PURE__*/function () {\n    var _ref6 = Object(_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__[/* default */ \"a\"])( /*#__PURE__*/_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark(function _callee5(keywords) {\n      return _Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }));\n\n    return function searchQuery(_x5) {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n\n  var handleCancel = /*#__PURE__*/function () {\n    var _ref7 = Object(_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__[/* default */ \"a\"])( /*#__PURE__*/_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark(function _callee6(id, row) {\n      return _Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              onChangeStatus(\"Dibatalkan\", row);\n\n            case 1:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6);\n    }));\n\n    return function handleCancel(_x6, _x7) {\n      return _ref7.apply(this, arguments);\n    };\n  }();\n\n  var onChangeStatus = function onChangeStatus(status, row) {\n    row.attributes.status = status;\n    var dataStatus = row;\n\n    if (status === \"Selesai\") {\n      // invetory handle\n      Object(_utility_createInventory__WEBPACK_IMPORTED_MODULE_13__[\"default\"])(row);\n    }\n\n    handleChangeStatus(dataStatus, dataStatus.id);\n  };\n\n  var handleChangeStatus = /*#__PURE__*/function () {\n    var _ref8 = Object(_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__[/* default */ \"a\"])( /*#__PURE__*/_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark(function _callee7(values, id) {\n      var _values$attributes, _values$attributes$do, _values$attributes2, _values$attributes2$d;\n\n      var key, _values$attributes3, purchasing_details, purchasing_payments, newValues, JSONdata, cookies, endpoint, options, req, res, response;\n\n      return _Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              // // clean object\n              delete values.attributes.purchase;\n\n              for (key in values.attributes) {\n                if (values.attributes[key] === null || values.attributes[key] === undefined) {\n                  delete values.attributes[key];\n                }\n              }\n\n              if (((_values$attributes = values.attributes) === null || _values$attributes === void 0 ? void 0 : (_values$attributes$do = _values$attributes.document) === null || _values$attributes$do === void 0 ? void 0 : _values$attributes$do.data) === null || ((_values$attributes2 = values.attributes) === null || _values$attributes2 === void 0 ? void 0 : (_values$attributes2$d = _values$attributes2.document) === null || _values$attributes2$d === void 0 ? void 0 : _values$attributes2$d.data) === undefined) {\n                (_values$attributes3 = values.attributes) === null || _values$attributes3 === void 0 ? true : delete _values$attributes3.document;\n              }\n\n              purchasing_details = [];\n              purchasing_payments = [];\n              values.attributes.purchasing_details.data.forEach(function (element) {\n                purchasing_details.push({\n                  id: element.id\n                });\n              });\n              values.attributes.purchasing_payments.data.forEach(function (element) {\n                purchasing_payments.push({\n                  id: element.id\n                });\n              });\n              values.attributes.supplier = {\n                id: values.attributes.supplier.data.id\n              };\n              values.attributes.location = {\n                id: values.attributes.location.data.id\n              };\n              values.attributes.purchasing_details = purchasing_details;\n              values.attributes.purchasing_payments = purchasing_payments;\n              newValues = {\n                data: values.attributes\n              };\n              JSONdata = JSON.stringify(newValues);\n              cookies = nookies__WEBPACK_IMPORTED_MODULE_12___default.a.get(null, \"token\");\n              endpoint = \"https://js-strapi.keelola.net/api\" + \"/purchasings/\" + id;\n              options = {\n                method: \"PUT\",\n                headers: {\n                  \"Content-Type\": \"application/json\",\n                  Authorization: \"Bearer \" + cookies.token\n                },\n                body: JSONdata\n              };\n              _context7.next = 18;\n              return fetch(endpoint, options);\n\n            case 18:\n              req = _context7.sent;\n              _context7.next = 21;\n              return req.json();\n\n            case 21:\n              res = _context7.sent;\n\n              if (!(req.status === 200)) {\n                _context7.next = 30;\n                break;\n              }\n\n              _context7.next = 25;\n              return fetchData(cookies);\n\n            case 25:\n              response = _context7.sent;\n\n              if (res.data.attributes.status === \"Dibatalkan\") {\n                router.reload();\n              } else {\n                setPurchase(response);\n              }\n\n              openNotificationWithIcon(\"success\", \"Status berhasil dirubah\", \"Status berhasil dirubah. Silahkan cek detail LPB\");\n              _context7.next = 31;\n              break;\n\n            case 30:\n              openNotificationWithIcon(\"error\", \"Status gagal dirubah\", \"Tedapat kesalahan yang menyebabkan status tidak dapat dirubah\");\n\n            case 31:\n            case \"end\":\n              return _context7.stop();\n          }\n        }\n      }, _callee7);\n    }));\n\n    return function handleChangeStatus(_x8, _x9) {\n      return _ref8.apply(this, arguments);\n    };\n  }();\n\n  var fetchData = /*#__PURE__*/function () {\n    var _ref9 = Object(_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__[/* default */ \"a\"])( /*#__PURE__*/_Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.mark(function _callee8(cookies) {\n      var endpoint, options, req, res;\n      return _Users_yudiananta_Development_NextJS_ERP_Dev_JS_Deploy_JS_Deploy_node_modules_next_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default.a.wrap(function _callee8$(_context8) {\n        while (1) {\n          switch (_context8.prev = _context8.next) {\n            case 0:\n              endpoint = \"https://js-strapi.keelola.net/api\" + \"/purchasings?populate=deep\";\n              options = {\n                method: \"GET\",\n                headers: {\n                  \"Content-Type\": \"application/json\",\n                  Authorization: \"Bearer \" + cookies.token\n                }\n              };\n              _context8.next = 4;\n              return fetch(endpoint, options);\n\n            case 4:\n              req = _context8.sent;\n              res = req.json();\n              return _context8.abrupt(\"return\", res);\n\n            case 7:\n            case \"end\":\n              return _context8.stop();\n          }\n        }\n      }, _callee8);\n    }));\n\n    return function fetchData(_x10) {\n      return _ref9.apply(this, arguments);\n    };\n  }();\n\n  var openNotificationWithIcon = function openNotificationWithIcon(type, title, message) {\n    antd_lib_notification__WEBPACK_IMPORTED_MODULE_0___default.a[type]({\n      message: title,\n      description: message\n    });\n  };\n\n  return /*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__[\"jsxs\"])(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__[\"Fragment\"], {\n    children: [/*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__[\"jsx\"])(next_head__WEBPACK_IMPORTED_MODULE_4___default.a, {\n      children: /*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__[\"jsx\"])(\"title\", {\n        children: \"Pembelian Barang\"\n      })\n    }), /*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__[\"jsx\"])(_containers_DashboardLayout_DashboardLayout__WEBPACK_IMPORTED_MODULE_7__[/* default */ \"a\"], {\n      children: /*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__[\"jsxs\"])(_iso_components_utility_layoutWrapper_js__WEBPACK_IMPORTED_MODULE_8__[/* default */ \"a\"], {\n        style: {},\n        children: [/*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__[\"jsx\"])(_components_TitlePage_TitlePage__WEBPACK_IMPORTED_MODULE_10__[/* default */ \"a\"], {\n          titleText: \"Lembar Pembelian Barang\"\n        }), /*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__[\"jsxs\"])(_iso_components_utility_layoutContent__WEBPACK_IMPORTED_MODULE_6__[/* default */ \"a\"], {\n          children: [/*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__[\"jsxs\"])(\"div\", {\n            className: \"w-full flex justify-between\",\n            children: [/*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__[\"jsx\"])(Search, {\n              className: \"\",\n              loading: isSearching,\n              onChange: function onChange(e) {\n                return onSearch(e);\n              },\n              placeholder: \"Cari Pembelian\",\n              style: {\n                width: 200\n              }\n            }), /*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__[\"jsx\"])(\"button\", {\n              onClick: handleAdd,\n              type: \"button\",\n              className: \"bg-cyan-700 rounded px-5 py-2 hover:bg-cyan-800  shadow-sm flex float-right mb-5\",\n              children: /*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__[\"jsx\"])(\"div\", {\n                className: \"text-white text-center text-sm font-bold\",\n                children: /*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__[\"jsx\"])(\"a\", {\n                  className: \"text-white no-underline text-xs sm:text-xs\",\n                  children: \"+ Tambah\"\n                })\n              })\n            })]\n          }), /*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_14__[\"jsx\"])(_components_ReactDataTable_Purchases_PurchasingTable__WEBPACK_IMPORTED_MODULE_11__[/* default */ \"a\"], {\n            data: purchase,\n            onUpdate: handleUpdate,\n            onDelete: handleCancel,\n            onPageChange: handlePageChange,\n            onChangeStatus: onChangeStatus\n          })]\n        })]\n      })\n    })]\n  });\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Pembelian);\n\n/***/ })\n\n},[[\"AYpC\",0,1,13,20,2,3,4,5,6,7,9,8,10,12,11,14,16,17,18,19,24]]]);","inputSourceMap":{"version":3,"sources":["/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/JS-Deploy/node_modules/next/dist/build/webpack/loaders/next-babel-loader.js??ref--4!/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/JS-Deploy/pages/dashboard/pembelian/utility/createInventory.js","/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/JS-Deploy/node_modules/next/dist/build/webpack/loaders/next-client-pages-loader.js?page=%2Fdashboard%2Fpembelian%2Fpembelian_barang&absolutePagePath=private-next-pages%2Fdashboard%2Fpembelian%2Fpembelian_barang%2Findex.js!","/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/JS-Deploy/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/JS-Deploy/node_modules/next/dist/build/webpack/loaders/next-babel-loader.js??ref--4!/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/JS-Deploy/pages/dashboard/pembelian/pembelian_barang/index.js"],"names":[],"mappings":";;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA4K;AACf;AACnI;AACI;AACG;AACjC;AACA;AACA;AACA;AACA,cAAc,8CAAO;;AAErB;AACA;AACA;AACA;;AAEA,qBAAqB,WAAW;AAChC;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,qCAAqC,YAAY;AACjD;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,MAAM;;AAEN,oDAAoD;AACpD,GAAG;AACH;;AAEA;AACA,aAAa,kMAAiB,eAAe,gKAAmB;AAChE;AACA,WAAW,gKAAmB;AAC9B;AACA;AACA;AACA,uBAAuB,mCAA2B;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,aAAa;AACb;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;AACA,CAAC;;AAED;AACA,cAAc,kMAAiB,eAAe,gKAAmB;AACjE;AACA,WAAW,gKAAmB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,mCAA2B;AAClD;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;AACA,CAAC;;AAED;AACA,cAAc,kMAAiB,eAAe,gKAAmB;AACjE;AACA,WAAW,gKAAmB;AAC9B;AACA;AACA;AACA;AACA,uBAAuB,mCAA2B;AAClD;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;AACA,CAAC;;AAED;AACA,cAAc,kMAAiB,eAAe,gKAAmB;AACjE;AACA,WAAW,gKAAmB;AAC9B;AACA;AACA;AACA;AACA,uBAAuB,mCAA2B;AAClD;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;AACA,CAAC,GAAG;;;AAGJ;AACA,cAAc,kMAAiB,eAAe,gKAAmB;AACjE;AACA,WAAW,gKAAmB;AAC9B;AACA;AACA;AACA,uBAAuB,mCAA2B;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;AACA,CAAC;;AAED;AACA,cAAc,kMAAiB,eAAe,gKAAmB;AACjE;AACA,WAAW,gKAAmB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,mCAA2B;AAClD;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;AACA,CAAC;;AAED;AACA,cAAc,kMAAiB,eAAe,gKAAmB;AACjE;AACA,WAAW,gKAAmB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,mCAA2B;AAClD;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;AACA,CAAC;;AAED;AACA,cAAc,kMAAiB,eAAe,gKAAmB;AACjE;AACA,WAAW,gKAAmB;AAC9B;AACA;AACA;AACA,uBAAuB,mCAA2B;AAClD;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;AACA,CAAC;;AAEc,8EAAe,E;;;;;;;;ACvb9B;AACA;AACA;AACA,eAAe,mBAAO,CAAC,MAAkE;AACzF;AACA;;;;;;;;;ACNA;AAAA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEe;AACf;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,KAAK;AACL;AACA,C;;;;;;;;AClCA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAkD;AACd;AACwI;AACf;AAChI;AACW;AAC0B;AACmB;AAChB;AAC7B;AAC2B;AAC2B;AAChE;AAC2B;AACT;AACE;AACQ;;AAE1D;AACA,aAAa,kMAAiB,eAAe,gKAAmB;AAChE;AACA,WAAW,gKAAmB;AAC9B;AACA;AACA;AACA,sBAAsB,+CAAO;AAC7B;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;AACA,CAAC;;AAED;AACA,cAAc,kMAAiB,eAAe,gKAAmB;AACjE;AACA,WAAW,gKAAmB;AAC9B;AACA;AACA;AACA,uBAAuB,mCAA2B;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;;AAEA,kBAAkB,sDAAQ;AAC1B;AACA;;AAEA,mBAAmB,sDAAQ;AAC3B;AACA;;AAEA,eAAe,qDAAM;AACrB,eAAe,6DAAS;;AAExB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,gBAAgB,kMAAiB,eAAe,gKAAmB;AACnE;AACA,aAAa,gKAAmB;AAChC;AACA;AACA;AACA,wBAAwB,+CAAO;AAC/B,yBAAyB,mCAA2B;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,eAAe;AACf;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;;AAEL;AACA;AACA;AACA,GAAG;;AAEH;AACA,gBAAgB,kMAAiB,eAAe,gKAAmB;AACnE,aAAa,gKAAmB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;;AAEL;AACA;AACA;AACA,GAAG;;AAEH;AACA,gBAAgB,kMAAiB,eAAe,gKAAmB;AACnE,aAAa,gKAAmB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;;AAEL;AACA;AACA;AACA,GAAG;;AAEH;AACA,gBAAgB,kMAAiB,eAAe,gKAAmB;AACnE,aAAa,gKAAmB;AAChC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;;AAEL;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA,MAAM,yEAAe;AACrB;;AAEA;AACA;;AAEA;AACA,gBAAgB,kMAAiB,eAAe,gKAAmB;AACnE;;AAEA;;AAEA,aAAa,gKAAmB;AAChC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,eAAe;AACf;AACA;AACA;AACA,iBAAiB;AACjB,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,+CAAO;AAC/B,yBAAyB,mCAA2B;AACpD;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,eAAe;AACf;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;;AAEL;AACA;AACA;AACA,GAAG;;AAEH;AACA,gBAAgB,kMAAiB,eAAe,gKAAmB;AACnE;AACA,aAAa,gKAAmB;AAChC;AACA;AACA;AACA,yBAAyB,mCAA2B;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;;AAEL;AACA;AACA;AACA,GAAG;;AAEH;AACA,IAAI,4DAAa;AACjB;AACA;AACA,KAAK;AACL;;AAEA,sBAAsB,+DAAK,CAAC,2DAAS;AACrC,4BAA4B,8DAAI,CAAC,gDAAI;AACrC,6BAA6B,8DAAI;AACjC;AACA,OAAO;AACP,KAAK,gBAAgB,8DAAI,CAAC,2FAAe;AACzC,6BAA6B,+DAAK,CAAC,wFAAa;AAChD,iBAAiB;AACjB,gCAAgC,8DAAI,CAAC,gFAAS;AAC9C;AACA,SAAS,gBAAgB,+DAAK,CAAC,qFAAa;AAC5C,kCAAkC,+DAAK;AACvC;AACA,oCAAoC,8DAAI;AACxC;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA,aAAa,gBAAgB,8DAAI;AACjC;AACA;AACA;AACA,qCAAqC,8DAAI;AACzC;AACA,uCAAuC,8DAAI;AAC3C;AACA;AACA,iBAAiB;AACjB,eAAe;AACf,aAAa;AACb,WAAW,gBAAgB,8DAAI,CAAC,qGAAe;AAC/C;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,SAAS;AACT,OAAO;AACP,KAAK;AACL,GAAG;AACH;;AAEe,wEAAS,E","file":"x","sourcesContent":["import _asyncToGenerator from \"/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/JS-Deploy/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _regeneratorRuntime from \"/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/JS-Deploy/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport React from \"react\";\nimport nookies from \"nookies\";\nimport * as moment from \"moment\";\n// In this scenario, we will look up for data in inventory details with params exp.date, productId, and LocationId\n// if data is already exist, then we should update the stock inventory details with the exp.date\n// if they are not, then we create a new inventory details\n// It happens with master inventory too. So basicly, we gonna check first. If exist, then UPDATE.\nvar cookies = nookies.get(null, \"token\");\n\nvar calculateTotalUnit = function calculateTotalUnit(unit, product) {\n  var total = 1;\n  var productIndex = 0;\n  var productSmallestUnit = \"\";\n\n  for (var index = 1; index < 6; index++) {\n    if (product.attributes[\"unit_\".concat(index)] === unit) {\n      productIndex = index;\n    }\n\n    if (product.attributes[\"unit_\".concat(index)]) {\n      productSmallestUnit = product.attributes[\"unit_\".concat(index)];\n    }\n  }\n\n  for (var _index = productIndex + 1; _index < 6; _index++) {\n    total = total * product.attributes[\"qty_\".concat(_index)];\n\n    if (total === 0) {\n      total = 1;\n    }\n  }\n\n  return {\n    total: total,\n    productSmallestUnit: productSmallestUnit\n  };\n};\n\nfunction createInventory(data) {\n  var purchasingDetails = data.attributes.purchasing_details.data;\n  purchasingDetails.forEach(function (element) {\n    var expiredDate = new Date(element.attributes.expired_date);\n    var batch = element.attributes.batch;\n    var unitOrder = element.attributes.unit_order;\n    var totalOrder = parseInt(element.attributes.total_order);\n    var product = element.attributes.product.data;\n    var result = calculateTotalUnit(unitOrder, product);\n    var totalQty = result.total * totalOrder;\n    var location = element.attributes.location.data;\n    var data = {\n      data: {\n        expired_date: expiredDate,\n        batch: batch,\n        products: {\n          id: product.id\n        },\n        stock: totalQty,\n        smallest_unit: result.productSmallestUnit,\n        locations: {\n          id: location.id\n        },\n        keterangan: \"Pembelian\"\n      }\n    }; // check existing stock\n\n    checkDetailStock(data, product.id, location.id); //\n  });\n}\n\nvar checkDetailStock = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(data, productId, locationId) {\n    var endpoint, options, req, res;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            endpoint = process.env.NEXT_PUBLIC_URL + \"/inventory-details?filters[locations][id][$eq]=\".concat(locationId, \"&filters[products][id][$eq]=\").concat(productId, \"&filters[expired_date][$eq]=2024-10-01&populate=*\");\n            options = {\n              method: \"GET\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: \"Bearer \" + cookies.token\n              }\n            };\n            _context.next = 4;\n            return fetch(endpoint, options);\n\n          case 4:\n            req = _context.sent;\n            _context.next = 7;\n            return req.json();\n\n          case 7:\n            res = _context.sent;\n\n            if (res.data.length > 0) {\n              updateAPI(res.data[0], data, productId, locationId);\n            } else {\n              createAPI(data, productId, locationId);\n            }\n\n            createInventoryHistory(data);\n\n          case 10:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function checkDetailStock(_x, _x2, _x3) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar updateAPI = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(resData, data, productId, locationId) {\n    var currentStock, finalStock, newData, JSONdata, endpoint, options, req, res;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            currentStock = resData.attributes.stock;\n            finalStock = currentStock + data.data.stock;\n            resData.attributes.stock = finalStock;\n            resData.attributes.locations = data.data.locations;\n            resData.attributes.products = data.data.products;\n            newData = {\n              data: resData.attributes\n            };\n            JSONdata = JSON.stringify(newData);\n            endpoint = process.env.NEXT_PUBLIC_URL + \"/inventory-details/\" + resData.id;\n            options = {\n              method: \"PUT\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: \"Bearer \" + cookies.token\n              },\n              body: JSONdata\n            };\n            _context2.next = 11;\n            return fetch(endpoint, options);\n\n          case 11:\n            req = _context2.sent;\n            _context2.next = 14;\n            return req.json();\n\n          case 14:\n            res = _context2.sent;\n\n            if (req.status === 200) {\n              createInventoryAPI(locationId, productId, data.data.stock, data);\n            }\n\n          case 16:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n\n  return function updateAPI(_x4, _x5, _x6, _x7) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nvar createAPI = /*#__PURE__*/function () {\n  var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(data, productId, locationId) {\n    var JSONdata, endpoint, options, req, res;\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            JSONdata = JSON.stringify(data);\n            endpoint = process.env.NEXT_PUBLIC_URL + \"/inventory-details\";\n            options = {\n              method: \"POST\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: \"Bearer \" + cookies.token\n              },\n              body: JSONdata\n            };\n            _context3.next = 5;\n            return fetch(endpoint, options);\n\n          case 5:\n            req = _context3.sent;\n            _context3.next = 8;\n            return req.json();\n\n          case 8:\n            res = _context3.sent;\n\n            if (req.status === 200) {\n              // check data location\n              createInventoryAPI(locationId, productId, data.data.stock, data);\n            }\n\n          case 10:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n\n  return function createAPI(_x8, _x9, _x10) {\n    return _ref3.apply(this, arguments);\n  };\n}();\n\nvar createInventoryHistory = /*#__PURE__*/function () {\n  var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(data) {\n    var JSONdata, endpoint, options, req, res;\n    return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            JSONdata = JSON.stringify(data);\n            endpoint = process.env.NEXT_PUBLIC_URL + \"/inventory-histories\";\n            options = {\n              method: \"POST\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: \"Bearer \" + cookies.token\n              },\n              body: JSONdata\n            };\n            _context4.next = 5;\n            return fetch(endpoint, options);\n\n          case 5:\n            req = _context4.sent;\n            _context4.next = 8;\n            return req.json();\n\n          case 8:\n            res = _context4.sent;\n\n          case 9:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4);\n  }));\n\n  return function createInventoryHistory(_x11) {\n    return _ref4.apply(this, arguments);\n  };\n}(); // ======================= MASTER INVENTORY =======================\n\n\nvar createInventoryAPI = /*#__PURE__*/function () {\n  var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(locationId, productId, quantity, data) {\n    var endpoint, options, req, res, totalStock;\n    return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            endpoint = process.env.NEXT_PUBLIC_URL + \"/inventories?filters[locations][id][$eq]=\".concat(locationId, \"&filters[products][id][$eq]=\").concat(productId, \"&populate=locations\");\n            options = {\n              method: \"GET\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: \"Bearer \" + cookies.token\n              }\n            };\n            _context5.next = 4;\n            return fetch(endpoint, options);\n\n          case 4:\n            req = _context5.sent;\n            _context5.next = 7;\n            return req.json();\n\n          case 7:\n            res = _context5.sent;\n\n            if (!(res.data.length > 0)) {\n              _context5.next = 14;\n              break;\n            }\n\n            // put existing data\n            totalStock = res.data[0].attributes.total_stock + quantity;\n            _context5.next = 12;\n            return putExistingData(res.data[0].id, res.data[0].attributes, totalStock);\n\n          case 12:\n            _context5.next = 16;\n            break;\n\n          case 14:\n            _context5.next = 16;\n            return createNewData(data, locationId);\n\n          case 16:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, _callee5);\n  }));\n\n  return function createInventoryAPI(_x12, _x13, _x14, _x15) {\n    return _ref5.apply(this, arguments);\n  };\n}();\n\nvar putExistingData = /*#__PURE__*/function () {\n  var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(id, data, totalStock) {\n    var putData, JSONdata, endpoint, options, req;\n    return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n      while (1) {\n        switch (_context6.prev = _context6.next) {\n          case 0:\n            data.total_stock = totalStock;\n            data.locations = {\n              id: data.locations.data[0].id\n            };\n            putData = {\n              data: data\n            };\n            JSONdata = JSON.stringify(putData);\n            endpoint = process.env.NEXT_PUBLIC_URL + \"/inventories/\" + id;\n            options = {\n              method: \"PUT\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: \"Bearer \" + cookies.token\n              },\n              body: JSONdata\n            };\n            _context6.next = 8;\n            return fetch(endpoint, options);\n\n          case 8:\n            req = _context6.sent;\n\n          case 9:\n          case \"end\":\n            return _context6.stop();\n        }\n      }\n    }, _callee6);\n  }));\n\n  return function putExistingData(_x16, _x17, _x18) {\n    return _ref6.apply(this, arguments);\n  };\n}();\n\nvar createNewData = /*#__PURE__*/function () {\n  var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7(data, locationId) {\n    var JSONdata, endpoint, options, req;\n    return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n      while (1) {\n        switch (_context7.prev = _context7.next) {\n          case 0:\n            data.data.total_stock = data.data.stock;\n            data.data.locations = {\n              id: locationId\n            };\n            JSONdata = JSON.stringify(data);\n            endpoint = process.env.NEXT_PUBLIC_URL + \"/inventories\";\n            options = {\n              method: \"POST\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: \"Bearer \" + cookies.token\n              },\n              body: JSONdata\n            };\n            _context7.next = 7;\n            return fetch(endpoint, options);\n\n          case 7:\n            req = _context7.sent;\n\n          case 8:\n          case \"end\":\n            return _context7.stop();\n        }\n      }\n    }, _callee7);\n  }));\n\n  return function createNewData(_x19, _x20) {\n    return _ref7.apply(this, arguments);\n  };\n}();\n\nvar getUserLocation = /*#__PURE__*/function () {\n  var _ref8 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8(cookies) {\n    var endpoint, options, req, res;\n    return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n      while (1) {\n        switch (_context8.prev = _context8.next) {\n          case 0:\n            endpoint = process.env.NEXT_PUBLIC_URL + \"/users/me?populate=*\";\n            options = {\n              method: \"GET\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: \"Bearer \" + cookies.token\n              },\n              body: JSONdata\n            };\n            _context8.next = 4;\n            return fetch(endpoint, options);\n\n          case 4:\n            req = _context8.sent;\n            _context8.next = 7;\n            return req.json();\n\n          case 7:\n            res = _context8.sent;\n            return _context8.abrupt(\"return\", res);\n\n          case 9:\n          case \"end\":\n            return _context8.stop();\n        }\n      }\n    }, _callee8);\n  }));\n\n  return function getUserLocation(_x21) {\n    return _ref8.apply(this, arguments);\n  };\n}();\n\nexport default createInventory;","\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/dashboard/pembelian/pembelian_barang\",\n      function () {\n        return require(\"private-next-pages/dashboard/pembelian/pembelian_barang/index.js\");\n      }\n    ]);\n  ","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}","import _notification from \"antd/lib/notification\";\nimport _Input from \"antd/lib/input\";\nimport _asyncToGenerator from \"/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/JS-Deploy/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _regeneratorRuntime from \"/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/JS-Deploy/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport Head from \"next/head\";\nimport React, { useState } from \"react\";\nimport LayoutContent from \"@iso/components/utility/layoutContent\";\nimport DashboardLayout from \"../../../../containers/DashboardLayout/DashboardLayout\";\nimport LayoutWrapper from \"@iso/components/utility/layoutWrapper.js\";\nimport { useRouter } from \"next/router\";\nimport TitlePage from \"../../../../components/TitlePage/TitlePage\";\nimport PurchasingTable from \"../../../../components/ReactDataTable/Purchases/PurchasingTable\";\nimport nookies from \"nookies\";\nimport createInventory from \"../utility/createInventory\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\n\nPembelian.getInitialProps = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(context) {\n    var cookies, data, req;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            cookies = nookies.get(context);\n            _context.next = 3;\n            return fetchData(cookies);\n\n          case 3:\n            req = _context.sent;\n            _context.next = 6;\n            return req.json();\n\n          case 6:\n            data = _context.sent;\n            return _context.abrupt(\"return\", {\n              props: {\n                data: data\n              }\n            });\n\n          case 8:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function (_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar fetchData = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(cookies) {\n    var endpoint, options, req;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            endpoint = process.env.NEXT_PUBLIC_URL + \"/purchasings?populate=deep\";\n            options = {\n              method: \"GET\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: \"Bearer \" + cookies.token\n              }\n            };\n            _context2.next = 4;\n            return fetch(endpoint, options);\n\n          case 4:\n            req = _context2.sent;\n            return _context2.abrupt(\"return\", req);\n\n          case 6:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n\n  return function fetchData(_x2) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nfunction Pembelian(_ref3) {\n  var props = _ref3.props;\n  var data = props.data;\n\n  var _useState = useState(data),\n      purchase = _useState[0],\n      setPurchase = _useState[1];\n\n  var _useState2 = useState(false),\n      isSearching = _useState2[0],\n      setIsSearching = _useState2[1];\n\n  var Search = _Input.Search;\n  var router = useRouter();\n\n  var handleAdd = function handleAdd() {\n    router.push(\"/dashboard/pembelian/pembelian_barang/tambah\");\n  };\n\n  var handleUpdate = function handleUpdate(id) {\n    // router.push(\"/dashboard/pembelian/order_pembelian/edit/\" + id);\n    openNotificationWithIcon(\"info\", \"Work In Progress\", \"Hai, Fitur ini sedang dikerjakan. Silahkan tunggu pembaruan selanjutnya\");\n  };\n\n  var handlePageChange = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(page) {\n      var cookies, endpoint, options, req, res;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              cookies = nookies.get(null, \"token\");\n              endpoint = process.env.NEXT_PUBLIC_URL + \"/purchases?pagination[page]=\" + page;\n              options = {\n                method: \"GET\",\n                headers: {\n                  \"Content-Type\": \"application/json\",\n                  Authorization: \"Bearer \" + cookies.token\n                }\n              };\n              _context3.prev = 3;\n              _context3.next = 6;\n              return fetch(endpoint, options);\n\n            case 6:\n              req = _context3.sent;\n              _context3.next = 9;\n              return req.json();\n\n            case 9:\n              res = _context3.sent;\n\n              if (res) {\n                setPurchase(function (prevData) {\n                  return {\n                    data: filterDuplicateData(prevData.data.concat(res.data)),\n                    meta: prevData.meta\n                  };\n                });\n              } else {\n                console.log(\"something is wrong\");\n              }\n\n              _context3.next = 16;\n              break;\n\n            case 13:\n              _context3.prev = 13;\n              _context3.t0 = _context3[\"catch\"](3);\n              console.log(_context3.t0);\n\n            case 16:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, null, [[3, 13]]);\n    }));\n\n    return function handlePageChange(_x3) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var onSearch = /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(e) {\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function onSearch(_x4) {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  var searchQuery = /*#__PURE__*/function () {\n    var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(keywords) {\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }));\n\n    return function searchQuery(_x5) {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n\n  var handleCancel = /*#__PURE__*/function () {\n    var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(id, row) {\n      return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              onChangeStatus(\"Dibatalkan\", row);\n\n            case 1:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6);\n    }));\n\n    return function handleCancel(_x6, _x7) {\n      return _ref7.apply(this, arguments);\n    };\n  }();\n\n  var onChangeStatus = function onChangeStatus(status, row) {\n    row.attributes.status = status;\n    var dataStatus = row;\n\n    if (status === \"Selesai\") {\n      // invetory handle\n      createInventory(row);\n    }\n\n    handleChangeStatus(dataStatus, dataStatus.id);\n  };\n\n  var handleChangeStatus = /*#__PURE__*/function () {\n    var _ref8 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7(values, id) {\n      var _values$attributes, _values$attributes$do, _values$attributes2, _values$attributes2$d;\n\n      var key, _values$attributes3, purchasing_details, purchasing_payments, newValues, JSONdata, cookies, endpoint, options, req, res, response;\n\n      return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              // // clean object\n              delete values.attributes.purchase;\n\n              for (key in values.attributes) {\n                if (values.attributes[key] === null || values.attributes[key] === undefined) {\n                  delete values.attributes[key];\n                }\n              }\n\n              if (((_values$attributes = values.attributes) === null || _values$attributes === void 0 ? void 0 : (_values$attributes$do = _values$attributes.document) === null || _values$attributes$do === void 0 ? void 0 : _values$attributes$do.data) === null || ((_values$attributes2 = values.attributes) === null || _values$attributes2 === void 0 ? void 0 : (_values$attributes2$d = _values$attributes2.document) === null || _values$attributes2$d === void 0 ? void 0 : _values$attributes2$d.data) === undefined) {\n                (_values$attributes3 = values.attributes) === null || _values$attributes3 === void 0 ? true : delete _values$attributes3.document;\n              }\n\n              purchasing_details = [];\n              purchasing_payments = [];\n              values.attributes.purchasing_details.data.forEach(function (element) {\n                purchasing_details.push({\n                  id: element.id\n                });\n              });\n              values.attributes.purchasing_payments.data.forEach(function (element) {\n                purchasing_payments.push({\n                  id: element.id\n                });\n              });\n              values.attributes.supplier = {\n                id: values.attributes.supplier.data.id\n              };\n              values.attributes.location = {\n                id: values.attributes.location.data.id\n              };\n              values.attributes.purchasing_details = purchasing_details;\n              values.attributes.purchasing_payments = purchasing_payments;\n              newValues = {\n                data: values.attributes\n              };\n              JSONdata = JSON.stringify(newValues);\n              cookies = nookies.get(null, \"token\");\n              endpoint = process.env.NEXT_PUBLIC_URL + \"/purchasings/\" + id;\n              options = {\n                method: \"PUT\",\n                headers: {\n                  \"Content-Type\": \"application/json\",\n                  Authorization: \"Bearer \" + cookies.token\n                },\n                body: JSONdata\n              };\n              _context7.next = 18;\n              return fetch(endpoint, options);\n\n            case 18:\n              req = _context7.sent;\n              _context7.next = 21;\n              return req.json();\n\n            case 21:\n              res = _context7.sent;\n\n              if (!(req.status === 200)) {\n                _context7.next = 30;\n                break;\n              }\n\n              _context7.next = 25;\n              return fetchData(cookies);\n\n            case 25:\n              response = _context7.sent;\n\n              if (res.data.attributes.status === \"Dibatalkan\") {\n                router.reload();\n              } else {\n                setPurchase(response);\n              }\n\n              openNotificationWithIcon(\"success\", \"Status berhasil dirubah\", \"Status berhasil dirubah. Silahkan cek detail LPB\");\n              _context7.next = 31;\n              break;\n\n            case 30:\n              openNotificationWithIcon(\"error\", \"Status gagal dirubah\", \"Tedapat kesalahan yang menyebabkan status tidak dapat dirubah\");\n\n            case 31:\n            case \"end\":\n              return _context7.stop();\n          }\n        }\n      }, _callee7);\n    }));\n\n    return function handleChangeStatus(_x8, _x9) {\n      return _ref8.apply(this, arguments);\n    };\n  }();\n\n  var fetchData = /*#__PURE__*/function () {\n    var _ref9 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8(cookies) {\n      var endpoint, options, req, res;\n      return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n        while (1) {\n          switch (_context8.prev = _context8.next) {\n            case 0:\n              endpoint = process.env.NEXT_PUBLIC_URL + \"/purchasings?populate=deep\";\n              options = {\n                method: \"GET\",\n                headers: {\n                  \"Content-Type\": \"application/json\",\n                  Authorization: \"Bearer \" + cookies.token\n                }\n              };\n              _context8.next = 4;\n              return fetch(endpoint, options);\n\n            case 4:\n              req = _context8.sent;\n              res = req.json();\n              return _context8.abrupt(\"return\", res);\n\n            case 7:\n            case \"end\":\n              return _context8.stop();\n          }\n        }\n      }, _callee8);\n    }));\n\n    return function fetchData(_x10) {\n      return _ref9.apply(this, arguments);\n    };\n  }();\n\n  var openNotificationWithIcon = function openNotificationWithIcon(type, title, message) {\n    _notification[type]({\n      message: title,\n      description: message\n    });\n  };\n\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsx(Head, {\n      children: /*#__PURE__*/_jsx(\"title\", {\n        children: \"Pembelian Barang\"\n      })\n    }), /*#__PURE__*/_jsx(DashboardLayout, {\n      children: /*#__PURE__*/_jsxs(LayoutWrapper, {\n        style: {},\n        children: [/*#__PURE__*/_jsx(TitlePage, {\n          titleText: \"Lembar Pembelian Barang\"\n        }), /*#__PURE__*/_jsxs(LayoutContent, {\n          children: [/*#__PURE__*/_jsxs(\"div\", {\n            className: \"w-full flex justify-between\",\n            children: [/*#__PURE__*/_jsx(Search, {\n              className: \"\",\n              loading: isSearching,\n              onChange: function onChange(e) {\n                return onSearch(e);\n              },\n              placeholder: \"Cari Pembelian\",\n              style: {\n                width: 200\n              }\n            }), /*#__PURE__*/_jsx(\"button\", {\n              onClick: handleAdd,\n              type: \"button\",\n              className: \"bg-cyan-700 rounded px-5 py-2 hover:bg-cyan-800  shadow-sm flex float-right mb-5\",\n              children: /*#__PURE__*/_jsx(\"div\", {\n                className: \"text-white text-center text-sm font-bold\",\n                children: /*#__PURE__*/_jsx(\"a\", {\n                  className: \"text-white no-underline text-xs sm:text-xs\",\n                  children: \"+ Tambah\"\n                })\n              })\n            })]\n          }), /*#__PURE__*/_jsx(PurchasingTable, {\n            data: purchase,\n            onUpdate: handleUpdate,\n            onDelete: handleCancel,\n            onPageChange: handlePageChange,\n            onChangeStatus: onChangeStatus\n          })]\n        })]\n      })\n    })]\n  });\n}\n\nexport default Pembelian;"]}}