{"ast":null,"code":"import _Select from \"antd/lib/select\";\nimport _Upload from \"antd/lib/upload\";\nimport _Button from \"antd/lib/button\";\nimport _UploadOutlined from \"@ant-design/icons/lib/icons/UploadOutlined\";\nimport _DatePicker from \"antd/lib/date-picker\";\nimport _Input from \"antd/lib/input\";\nimport _message from \"antd/lib/message\";\nimport _Form from \"antd/lib/form\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport Head from \"next/head\";\nimport React, { useState } from \"react\";\nimport LayoutContent from \"@iso/components/utility/layoutContent\";\nimport DashboardLayout from \"../../../../containers/DashboardLayout/DashboardLayout\";\nimport LayoutWrapper from \"@iso/components/utility/layoutWrapper.js\";\nimport Supplier from \"@iso/components/Form/AddOrder/SupplierForm\";\nimport TitlePage from \"../../../../components/TitlePage/TitlePage\";\nimport nookies from \"nookies\";\nimport SearchBar from \"@iso/components/Form/AddOrder/SearchBar\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport calculatePrice from \"../utility/calculatePrice\";\nimport ReturTable from \"@iso/components/ReactDataTable/Purchases/ReturTable\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\n\nRetur.getInitialProps = async context => {\n  const cookies = nookies.get(context);\n  const reqLocation = await fetchLocation(cookies);\n  const location = await reqLocation.json();\n  return {\n    props: {\n      location\n    }\n  };\n};\n\nconst fetchLocation = async cookies => {\n  const endpoint = process.env.NEXT_PUBLIC_URL + \"/locations?populate=deep\";\n  const options = {\n    method: \"GET\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Authorization: \"Bearer \" + cookies.token\n    }\n  };\n  const req = await fetch(endpoint, options);\n  return req;\n};\n\nfunction Retur({\n  props\n}) {\n  const locations = props.location.data;\n  var products = useSelector(state => state.Order);\n  const dispatch = useDispatch();\n\n  const [form] = _Form.useForm();\n\n  const {\n    0: supplier,\n    1: setSupplier\n  } = useState();\n  const {\n    0: productTotalPrice,\n    1: setProductTotalPrice\n  } = useState({});\n  const {\n    0: productSubTotal,\n    1: setProductSubTotal\n  } = useState({});\n  const {\n    0: totalPrice,\n    1: setTotalPrice\n  } = useState(0);\n  const tempList = [];\n\n  const onChangeProduct = async () => {\n    var isDuplicatedData = false;\n    tempList.find(item => {\n      productList.forEach(element => {\n        if (element.id === item.id) isDuplicatedData = true;\n      });\n    });\n\n    if (!isDuplicatedData) {\n      setProductList(productList => [...productList, tempList[0]]);\n      toast.success(\"Produk berhasil ditambahkan!\", {\n        position: toast.POSITION.TOP_RIGHT,\n        autoClose: 1000\n      });\n    }\n  };\n\n  const calculatePriceAfterDisc = row => {\n    const total = calculatePrice(row, products, productTotalPrice, productSubTotal, setTotalPrice);\n    return formatter.format(total);\n  };\n\n  var formatter = new Intl.NumberFormat(\"id-ID\", {\n    style: \"currency\",\n    currency: \"IDR\",\n    maximumFractionDigits: 0\n  });\n  const data = {\n    name: \"file\",\n    action: \"https://www.mocky.io/v2/5cc8019d300000980a055e76\",\n    headers: {\n      authorization: \"authorization-text\"\n    },\n\n    onChange(info) {\n      if (info.file.status !== \"uploading\") {\n        console.log(info.file, info.fileList);\n      }\n\n      if (info.file.status === \"done\") {\n        _message.success(`${info.file.name} file uploaded successfully`);\n      } else if (info.file.status === \"error\") {\n        _message.error(`${info.file.name} file upload failed.`);\n      }\n    }\n\n  };\n  var today = new Date();\n  var dd = String(today.getDate()).padStart(2, \"0\");\n  var mm = String(today.getMonth() + 1).padStart(2, \"0\"); //January is 0!\n\n  var yyyy = today.getFullYear();\n\n  const onFinish = () => {};\n\n  const onFinishFailed = () => {};\n\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsx(Head, {\n      children: /*#__PURE__*/_jsx(\"title\", {\n        children: \"Tambah Retur\"\n      })\n    }), /*#__PURE__*/_jsx(DashboardLayout, {\n      children: /*#__PURE__*/_jsxs(LayoutWrapper, {\n        style: {},\n        children: [/*#__PURE__*/_jsx(TitlePage, {\n          titleText: \"Tambah Retur Pembelian Barang\"\n        }), /*#__PURE__*/_jsx(LayoutContent, {\n          children: /*#__PURE__*/_jsx(_Form, {\n            form: form,\n            name: \"add_order\",\n            initialValues: {\n              remember: true\n            },\n            onFinish: onFinish,\n            onFinishFailed: onFinishFailed,\n            children: /*#__PURE__*/_jsxs(\"div\", {\n              className: \"flex flex-wrap -mx-3 mb-3\",\n              children: [/*#__PURE__*/_jsx(\"div\", {\n                className: \"w-full md:w-1/4 px-3 mb-2 md:mb-0\",\n                children: /*#__PURE__*/_jsx(Supplier, {\n                  onChangeSupplier: setSupplier\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"w-full md:w-1/4 px-3 mb-2 md:mb-0\",\n                children: /*#__PURE__*/_jsx(_Form.Item, {\n                  name: \"no_purchasing\",\n                  initialValue: `RB/ET/${dd}/${mm}/${yyyy}`,\n                  rules: [{\n                    required: true,\n                    message: \"Nomor PO tidak boleh kosong!\"\n                  }],\n                  children: /*#__PURE__*/_jsx(_Input, {\n                    style: {\n                      height: \"40px\"\n                    },\n                    placeholder: \"No.PO\"\n                  })\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"w-full md:w-1/4 px-3 mb-2 md:mb-0\",\n                children: /*#__PURE__*/_jsx(_Form.Item, {\n                  name: \"retur_date\",\n                  rules: [{\n                    required: true,\n                    message: \"Tanggal tidak boleh kosong!\"\n                  }],\n                  children: /*#__PURE__*/_jsx(_DatePicker, {\n                    placeholder: \"Tanggal Retur\",\n                    size: \"large\",\n                    format: \"DD/MM/YYYY\",\n                    style: {\n                      width: \"100%\"\n                    }\n                  })\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"w-full md:w-1/4 px-3 mb-2 md:mb-0\",\n                children: /*#__PURE__*/_jsx(_Upload, _objectSpread(_objectSpread({}, data), {}, {\n                  children: /*#__PURE__*/_jsx(_Button, {\n                    size: \"large\",\n                    icon: /*#__PURE__*/_jsx(_UploadOutlined, {}),\n                    children: \"Click to Upload\"\n                  })\n                }))\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"w-full md:w-1/4 px-3 mb-2 md:mb-0\",\n                children: /*#__PURE__*/_jsx(_Form.Item, {\n                  name: \"location\",\n                  rules: [{\n                    required: true,\n                    message: \"Lokasi tidak boleh kosong!\"\n                  }],\n                  children: /*#__PURE__*/_jsx(_Select, {\n                    placeholder: \"Pilih Lokasi\",\n                    size: \"large\",\n                    style: {\n                      width: \"100%\"\n                    },\n                    children: locations.map(element => {\n                      return /*#__PURE__*/_jsx(_Select.Option, {\n                        value: element.id,\n                        children: element.attributes.name\n                      }, element.attributes.name);\n                    })\n                  })\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"w-full md:w-4/4 px-3 mb-2 mt-2 mx-0  md:mb-0\",\n                children: /*#__PURE__*/_jsx(SearchBar, {\n                  form: form,\n                  tempList: tempList,\n                  onChange: onChangeProduct\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"w-full md:w-4/4 px-3 mb-2 mt-5 md:mb-0\",\n                children: /*#__PURE__*/_jsx(ReturTable, {\n                  products: products,\n                  productTotalPrice: productTotalPrice,\n                  setProductTotalPrice: setProductTotalPrice,\n                  calculatePriceAfterDisc: calculatePriceAfterDisc,\n                  productSubTotal: productSubTotal\n                })\n              })]\n            })\n          })\n        })]\n      })\n    })]\n  });\n}\n\nexport default Retur;","map":null,"metadata":{},"sourceType":"module"}