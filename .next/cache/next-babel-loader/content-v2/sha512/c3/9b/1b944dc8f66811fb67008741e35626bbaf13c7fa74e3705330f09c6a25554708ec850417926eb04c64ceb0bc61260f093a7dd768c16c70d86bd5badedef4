{"ast":null,"code":"import _Button from \"antd/lib/button\";\nimport _Spin from \"antd/lib/spin\";\nimport _Input from \"antd/lib/input\";\nimport _Form from \"antd/lib/form\";\nimport nookies from \"nookies\";\nimport { useState } from \"react\";\nimport Head from \"next/head\";\nimport LayoutContent from \"@iso/components/utility/layoutContent\";\nimport LayoutWrapper from \"@iso/components/utility/layoutWrapper.js\";\nimport { toast } from \"react-toastify\";\nimport { useRouter } from \"next/router\";\nimport DashboardLayout from \"../../../../../containers/DashboardLayout/DashboardLayout\";\nimport TitlePage from \"../../../../../components/TitlePage/TitlePage\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\n\nconst Edit = ({\n  props\n}) => {\n  const [form] = _Form.useForm();\n\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(false);\n  const categories = props.category.data;\n  const cookies = nookies.get(null, \"token\");\n  const router = useRouter();\n  const {\n    TextArea\n  } = _Input;\n\n  const onFinish = async values => {\n    setLoading(true);\n    const data = {\n      data: values\n    };\n    const endpoint = process.env.NEXT_PUBLIC_URL + \"/categories/\" + categories.id;\n    const JSONdata = JSON.stringify(data);\n    const options = {\n      method: \"PUT\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + cookies.token\n      },\n      body: JSONdata\n    };\n    console.log(endpoint);\n    console.log(JSONdata);\n    const req = await fetch(endpoint, options);\n    const res = await req.json();\n\n    if (req.status === 200) {\n      router.back();\n      toast.success(\"Kategori berhasil diperbarui!\", {\n        position: toast.POSITION.TOP_RIGHT\n      });\n    } else {\n      var _res$error;\n\n      (_res$error = res.error) === null || _res$error === void 0 ? void 0 : _res$error.details.errors.map(error => {\n        const ErrorMsg = error.path[0];\n        toast.error(ErrorMsg === \"category_id\" ? \"ID Kategori udah digunakan\" : \"Tidak dapat menambahkan Kategori\", {\n          position: toast.POSITION.TOP_RIGHT\n        });\n      });\n    }\n\n    setLoading(false);\n  };\n\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsx(Head, {\n      children: /*#__PURE__*/_jsx(\"title\", {\n        children: \"Edit Kategori\"\n      })\n    }), /*#__PURE__*/_jsx(DashboardLayout, {\n      children: /*#__PURE__*/_jsxs(LayoutWrapper, {\n        style: {},\n        children: [/*#__PURE__*/_jsx(TitlePage, {\n          titleText: \"Edit Kategori\"\n        }), /*#__PURE__*/_jsx(LayoutContent, {\n          children: /*#__PURE__*/_jsxs(_Form, {\n            form: form,\n            name: \"edit_category\",\n            initialValues: {\n              remember: true\n            },\n            onFinish: onFinish,\n            children: [/*#__PURE__*/_jsxs(\"div\", {\n              className: \"flex flex-wrap -mx-3 mb-6\",\n              children: [/*#__PURE__*/_jsx(\"div\", {\n                className: \"w-full md:w-1/2 px-3 mb-2 md:mb-0\",\n                children: /*#__PURE__*/_jsx(_Form.Item, {\n                  name: \"category_id\",\n                  initialValue: categories.attributes.category_id,\n                  rules: [{\n                    required: true,\n                    message: \"Kategori ID tidak boleh kosong!\"\n                  }],\n                  children: /*#__PURE__*/_jsx(_Input, {\n                    style: {\n                      height: \"50px\"\n                    },\n                    placeholder: \"ID Kategori\"\n                  })\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"w-full md:w-1/2 px-3 mb-2 md:mb-0\",\n                children: /*#__PURE__*/_jsx(_Form.Item, {\n                  initialValue: categories.attributes.name,\n                  name: \"name\",\n                  rules: [{\n                    required: true,\n                    message: \"Nama Kategori tidak boleh kosong!\"\n                  }],\n                  children: /*#__PURE__*/_jsx(_Input, {\n                    style: {\n                      height: \"50px\"\n                    },\n                    placeholder: \"Nama Kategori\"\n                  })\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"w-full md:w-full px-3 mb-2 md:mb-0\",\n                children: /*#__PURE__*/_jsx(_Form.Item, {\n                  name: \"description\",\n                  initialValue: categories.attributes.description,\n                  children: /*#__PURE__*/_jsx(TextArea, {\n                    rows: 4,\n                    placeholder: \"Deskripsi\"\n                  })\n                })\n              })]\n            }), /*#__PURE__*/_jsx(_Form.Item, {\n              children: loading ? /*#__PURE__*/_jsx(\"div\", {\n                className: \" flex float-left ml-3\",\n                children: /*#__PURE__*/_jsx(_Spin, {})\n              }) : /*#__PURE__*/_jsx(_Button, {\n                htmlType: \"submit\",\n                className: \" hover:text-white hover:bg-cyan-700 border border-cyan-700 ml-1\",\n                children: \"Submit\"\n              })\n            })]\n          })\n        })]\n      })\n    })]\n  });\n};\n\nEdit.getInitialProps = async context => {\n  const cookies = nookies.get(context);\n  const id = context.query.id;\n  const endpoint = process.env.NEXT_PUBLIC_URL + \"/categories/\" + id;\n  const options = {\n    method: \"GET\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Authorization: \"Bearer \" + cookies.token\n    }\n  };\n  const res = await fetch(endpoint, options);\n  const category = await res.json();\n  return {\n    props: {\n      category\n    }\n  };\n};\n\nexport default Edit;","map":null,"metadata":{},"sourceType":"module"}