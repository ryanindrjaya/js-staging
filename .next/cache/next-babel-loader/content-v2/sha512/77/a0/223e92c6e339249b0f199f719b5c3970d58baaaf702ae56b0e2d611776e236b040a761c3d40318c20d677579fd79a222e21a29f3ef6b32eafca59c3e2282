{"ast":null,"code":"import _Row from \"antd/lib/row\";\nimport _asyncToGenerator from \"/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/JS-Deploy/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _regeneratorRuntime from \"/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/JS-Deploy/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport Barcode from \"react-jsbarcode\";\nimport { QRCodeSVG } from \"qrcode.react\";\nimport Head from \"next/head\";\nimport React from \"react\";\nimport LayoutContent from \"@iso/components/utility/layoutContent\";\nimport LayoutWrapper from \"@iso/components/utility/layoutWrapper.js\";\nimport nookies from \"nookies\";\nimport DashboardLayout from \"../../../../../containers/DashboardLayout/DashboardLayout\";\nimport TitlePage from \"../../../../../components/TitlePage/TitlePage\";\nimport HistoryTable from \"../../../../../components/ReactDataTable/Product/HistoryTable\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\n\nHistory.getInitialProps = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(context) {\n    var cookies, test, locationId, productId, reqInventory, inventory, reqProduct, product, reqHistory, history;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            cookies = nookies.get(context);\n            test = context.query;\n            locationId = context.query.locationId;\n            productId = context.query.productId;\n            _context.next = 6;\n            return fetchInventory(cookies, productId, locationId);\n\n          case 6:\n            reqInventory = _context.sent;\n            _context.next = 9;\n            return reqInventory.json();\n\n          case 9:\n            inventory = _context.sent;\n            _context.next = 12;\n            return fetchProduct(cookies, productId, locationId);\n\n          case 12:\n            reqProduct = _context.sent;\n            _context.next = 15;\n            return reqProduct.json();\n\n          case 15:\n            product = _context.sent;\n            _context.next = 18;\n            return fetchHistory(cookies, productId, locationId);\n\n          case 18:\n            reqHistory = _context.sent;\n            _context.next = 21;\n            return reqHistory.json();\n\n          case 21:\n            history = _context.sent;\n            return _context.abrupt(\"return\", {\n              props: {\n                inventory: inventory,\n                product: product,\n                history: history\n              }\n            });\n\n          case 23:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function (_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar fetchProduct = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(cookies, productId) {\n    var endpoint, options, req;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            endpoint = process.env.NEXT_PUBLIC_URL + \"/products/\" + productId;\n            options = {\n              method: \"GET\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: \"Bearer \" + cookies.token\n              }\n            };\n            _context2.next = 4;\n            return fetch(endpoint, options);\n\n          case 4:\n            req = _context2.sent;\n            return _context2.abrupt(\"return\", req);\n\n          case 6:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n\n  return function fetchProduct(_x2, _x3) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nvar fetchInventory = /*#__PURE__*/function () {\n  var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(cookies, productId, locationId) {\n    var endpoint, options, req;\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            endpoint = process.env.NEXT_PUBLIC_URL + \"/inventories?filters[locations][id][$eq]=\".concat(locationId, \"&filters[products][id][$eq]=\").concat(productId, \"&populate=*\");\n            options = {\n              method: \"GET\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: \"Bearer \" + cookies.token\n              }\n            };\n            _context3.next = 4;\n            return fetch(endpoint, options);\n\n          case 4:\n            req = _context3.sent;\n            return _context3.abrupt(\"return\", req);\n\n          case 6:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n\n  return function fetchInventory(_x4, _x5, _x6) {\n    return _ref3.apply(this, arguments);\n  };\n}();\n\nvar fetchHistory = /*#__PURE__*/function () {\n  var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(cookies, productId, locationId) {\n    var endpoint, options, req;\n    return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            endpoint = process.env.NEXT_PUBLIC_URL + \"/inventory-details?filters[locations][id][$eq]=\".concat(locationId, \"&filters[products][id][$eq]=\").concat(productId, \"&populate=*\");\n            options = {\n              method: \"GET\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: \"Bearer \" + cookies.token\n              }\n            };\n            _context4.next = 4;\n            return fetch(endpoint, options);\n\n          case 4:\n            req = _context4.sent;\n            return _context4.abrupt(\"return\", req);\n\n          case 6:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4);\n  }));\n\n  return function fetchHistory(_x7, _x8, _x9) {\n    return _ref4.apply(this, arguments);\n  };\n}();\n\nfunction formatMyDate(value) {\n  var locale = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"id-ID\";\n  return new Date(value).toLocaleDateString(locale);\n}\n\nfunction History(_ref5) {\n  var props = _ref5.props;\n  var product = props.product.data.attributes;\n  var inventory = props.inventory.data[0].attributes;\n  var historyList = props.history.data;\n  var smallesUnit = historyList[0].attributes.smallest_unit;\n  console.log(props);\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsx(Head, {\n      children: /*#__PURE__*/_jsx(\"title\", {\n        children: \"Riwayat Produk\"\n      })\n    }), /*#__PURE__*/_jsx(DashboardLayout, {\n      children: /*#__PURE__*/_jsxs(LayoutWrapper, {\n        style: {},\n        children: [/*#__PURE__*/_jsx(TitlePage, {\n          titleText: \"Riwayat Produk\"\n        }), /*#__PURE__*/_jsx(LayoutContent, {\n          children: /*#__PURE__*/_jsxs(\"div\", {\n            children: [/*#__PURE__*/_jsxs(_Row, {\n              justify: \"space-between\",\n              children: [/*#__PURE__*/_jsxs(\"div\", {\n                children: [/*#__PURE__*/_jsx(\"div\", {\n                  className: \"font-bold text-lg mb-4 uppercase\",\n                  children: product.name\n                }), /*#__PURE__*/_jsxs(\"div\", {\n                  className: \"text-sm mb-2\",\n                  children: [\"SKU : \", product === null || product === void 0 ? void 0 : product.SKU]\n                }), /*#__PURE__*/_jsxs(\"div\", {\n                  className: \"text-sm\",\n                  children: [\"Total Stok : \", inventory === null || inventory === void 0 ? void 0 : inventory.total_stock, \" \", smallesUnit]\n                })]\n              }), /*#__PURE__*/_jsx(\"div\", {\n                children: /*#__PURE__*/_jsxs(_Row, {\n                  children: [/*#__PURE__*/_jsx(Barcode, {\n                    value: product === null || product === void 0 ? void 0 : product.SKU,\n                    options: {\n                      format: \"code128\",\n                      width: \"2px\",\n                      height: \"50px\"\n                    },\n                    renderer: \"svg\"\n                  }), /*#__PURE__*/_jsx(QRCodeSVG, {\n                    className: \"ml-5\",\n                    height: 80,\n                    width: 80,\n                    value: product === null || product === void 0 ? void 0 : product.SKU\n                  })]\n                })\n              })]\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"font-bold text-lg mt-5 mb-3 uppercase\",\n              children: \"Daftar Stok\"\n            }), /*#__PURE__*/_jsx(HistoryTable, {\n              data: historyList\n            })]\n          })\n        })]\n      })\n    })]\n  });\n}\n\nexport default History;","map":null,"metadata":{},"sourceType":"module"}