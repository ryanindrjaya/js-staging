{"ast":null,"code":"import _Form from \"antd/lib/form\";\nimport _Select from \"antd/lib/select\";\nimport nookies from \"nookies\";\nimport { useState } from \"react\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default function Manufactures({\n  onSelect,\n  initialValue,\n  selectedManufacures,\n  label\n}) {\n  var _initialValue$attribu;\n\n  const {\n    0: manufactures,\n    1: setSelectedManufactures\n  } = useState(selectedManufacures);\n  const {\n    0: data,\n    1: setData\n  } = useState([]);\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(false);\n  const cookies = nookies.get(null, \"token\");\n  const options = data === null || data === void 0 ? void 0 : data.map(d => /*#__PURE__*/_jsx(_Select.Option, {\n    children: d.label\n  }, d.value));\n\n  const handleSearchManufacure = newValue => {\n    if (newValue) {\n      setLoading(true);\n      fetchManufactures(newValue, setData);\n    } else {\n      setData([]);\n    }\n\n    setLoading(false);\n  };\n\n  const handleChangeManufactures = newValue => {\n    setSelectedManufactures(newValue);\n    onSelect(newValue);\n  };\n\n  const fetchManufactures = async (query, callback) => {\n    if (!query) {\n      callback([]);\n    } else {\n      try {\n        const endpoint = process.env.NEXT_PUBLIC_URL + `/manufactures?filters[$or][0][name][$containsi]=${query}&filters[$or][1][code][$containsi]=${query}`;\n        const options = {\n          method: \"GET\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: \"Bearer \" + cookies.token\n          }\n        };\n        const req = await fetch(endpoint, options);\n        const res = await req.json();\n\n        if (req.status == 200) {\n          const manufactureResult = res.data.map(manufacture => ({\n            label: `${manufacture.attributes.name}`,\n            value: manufacture.id\n          }));\n          callback(manufactureResult);\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    }\n  };\n\n  return /*#__PURE__*/_jsx(\"div\", {\n    className: \"w-full md:w-full mb-2 md:mb-0\",\n    children: /*#__PURE__*/_jsx(_Form.Item, {\n      name: \"manufactures\",\n      className: \"w-1/1\",\n      children: /*#__PURE__*/_jsx(_Select, {\n        value: manufactures,\n        size: \"large\",\n        defaultValue: initialValue && {\n          value: initialValue === null || initialValue === void 0 ? void 0 : initialValue.id,\n          label: initialValue === null || initialValue === void 0 ? void 0 : (_initialValue$attribu = initialValue.attributes) === null || _initialValue$attribu === void 0 ? void 0 : _initialValue$attribu.name\n        },\n        showSearch: true,\n        showArrow: false,\n        filterOption: false,\n        defaultActiveFirstOption: false,\n        placeholder: \"Pabrikasi\",\n        onChange: handleChangeManufactures,\n        onSearch: handleSearchManufacure,\n        children: options\n      })\n    })\n  });\n}","map":null,"metadata":{},"sourceType":"module"}