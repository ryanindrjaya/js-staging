{"ast":null,"code":"import _Spin from \"antd/lib/spin\";\nimport moment from \"moment\";\nimport React, { useState } from \"react\";\nimport writeXlsxFile from \"write-excel-file\";\nimport { HEADER_ROW_1, HEADER_ROW_2, columnsWidth } from \"./utils/ExcelStyles\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nexport default function ExportProduk({\n  data = [],\n  setProduct\n}) {\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(false);\n  const excelData = [HEADER_ROW_1, HEADER_ROW_2];\n\n  const exportData = async () => {\n    setLoading(true);\n    const time = moment().unix();\n\n    if (data.length > 0) {\n      const productData = data.map(product => {\n        var _attributes$category$, _attributes$category$2, _attributes$group$dat, _attributes$group$dat2, _attributes$manufactu, _attributes$manufactu2, _ref, _attributes$sub_categ, _attributes$sub_categ2;\n\n        const {\n          attributes\n        } = product; // kategori, golongan, lokasi, pabrikasi, sub kategori\n\n        const kategori = `${(_attributes$category$ = attributes.category.data) === null || _attributes$category$ === void 0 ? void 0 : _attributes$category$.attributes.category_id} - ${(_attributes$category$2 = attributes.category.data) === null || _attributes$category$2 === void 0 ? void 0 : _attributes$category$2.attributes.name}` || \"\";\n        const golongan = `${(_attributes$group$dat = attributes.group.data) === null || _attributes$group$dat === void 0 ? void 0 : _attributes$group$dat.attributes.alias} - ${(_attributes$group$dat2 = attributes.group.data) === null || _attributes$group$dat2 === void 0 ? void 0 : _attributes$group$dat2.attributes.name}` || \"\";\n        const pabrikasi = `${(_attributes$manufactu = attributes.manufacture.data) === null || _attributes$manufactu === void 0 ? void 0 : _attributes$manufactu.attributes.code} - ${(_attributes$manufactu2 = attributes.manufacture.data) === null || _attributes$manufactu2 === void 0 ? void 0 : _attributes$manufactu2.attributes.name}` || \"\";\n        const subKategori = (_ref = `${(_attributes$sub_categ = attributes.sub_category.data) === null || _attributes$sub_categ === void 0 ? void 0 : _attributes$sub_categ.attributes.sub_id} - ${(_attributes$sub_categ2 = attributes.sub_category.data) === null || _attributes$sub_categ2 === void 0 ? void 0 : _attributes$sub_categ2.attributes.name}`) !== null && _ref !== void 0 ? _ref : \"\"; // proses data lokasi\n\n        const dataLokasi = attributes.locations.data.map(location => {\n          return location.attributes.name;\n        }) || [];\n        const lokasi = dataLokasi.join(\", \") || \"\";\n        const {\n          SKU,\n          buy_price_1,\n          buy_price_2,\n          buy_price_3,\n          buy_price_4,\n          buy_price_5,\n          description,\n          disc_1_1,\n          disc_1_2,\n          disc_1_3,\n          disc_1_4,\n          disc_1_5,\n          name,\n          pricelist_1,\n          pricelist_2,\n          pricelist_3,\n          pricelist_4,\n          pricelist_5,\n          purchase_discount_1,\n          purchase_discount_2,\n          purchase_discount_3,\n          purchase_discount_4,\n          purchase_discount_5,\n          qty_1,\n          qty_2,\n          qty_3,\n          qty_4,\n          qty_5,\n          sold_price_1,\n          sold_price_2,\n          sold_price_3,\n          sold_price_4,\n          sold_price_5,\n          unit_1,\n          unit_2,\n          unit_3,\n          unit_4,\n          unit_5,\n          unit_1_dp1,\n          unit_1_dp2,\n          unit_1_dp3,\n          unit_1_dp4,\n          unit_1_dp5,\n          unit_2_dp1,\n          unit_2_dp2,\n          unit_2_dp3,\n          unit_2_dp4,\n          unit_2_dp5,\n          unit_3_dp1,\n          unit_3_dp2,\n          unit_3_dp3,\n          unit_3_dp4,\n          unit_3_dp5,\n          unit_4_dp1,\n          unit_4_dp2,\n          unit_4_dp3,\n          unit_4_dp4,\n          unit_4_dp5,\n          unit_5_dp1,\n          unit_5_dp2,\n          unit_5_dp3,\n          unit_5_dp4,\n          unit_5_dp5\n        } = attributes;\n        return [{\n          value: SKU || \"\",\n          fontSize: 11\n        }, {\n          value: name || \"\",\n          fontSize: 11\n        }, {\n          value: kategori,\n          fontSize: 11\n        }, {\n          value: subKategori,\n          fontSize: 11\n        }, {\n          value: pabrikasi,\n          fontSize: 11\n        }, {\n          value: golongan,\n          fontSize: 11\n        }, {\n          value: lokasi,\n          fontSize: 11\n        }, {\n          value: description || \"\",\n          fontSize: 11\n        }, {\n          value: unit_1 || \"\",\n          fontSize: 11\n        }, {\n          value: qty_1 || \"\",\n          fontSize: 11\n        }, {\n          value: buy_price_1 || \"\",\n          fontSize: 11\n        }, {\n          value: purchase_discount_1 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_1_dp1 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_1_dp2 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_1_dp3 || \"\",\n          fontSize: 11\n        }, {\n          value: pricelist_1 || \"\",\n          fontSize: 11\n        }, {\n          value: sold_price_1 || \"\",\n          fontSize: 11\n        }, {\n          value: disc_1_1 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_2 || \"\",\n          fontSize: 11\n        }, {\n          value: qty_2 || \"\",\n          fontSize: 11\n        }, {\n          value: buy_price_2 || \"\",\n          fontSize: 11\n        }, {\n          value: purchase_discount_2 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_2_dp1 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_2_dp2 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_2_dp3 || \"\",\n          fontSize: 11\n        }, {\n          value: pricelist_2 || \"\",\n          fontSize: 11\n        }, {\n          value: sold_price_2 || \"\",\n          fontSize: 11\n        }, {\n          value: disc_1_2 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_3 || \"\",\n          fontSize: 11\n        }, {\n          value: qty_3 || \"\",\n          fontSize: 11\n        }, {\n          value: buy_price_3 || \"\",\n          fontSize: 11\n        }, {\n          value: purchase_discount_3 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_3_dp1 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_3_dp2 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_3_dp3 || \"\",\n          fontSize: 11\n        }, {\n          value: pricelist_3 || \"\",\n          fontSize: 11\n        }, {\n          value: sold_price_3 || \"\",\n          fontSize: 11\n        }, {\n          value: disc_1_3 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_4 || \"\",\n          fontSize: 11\n        }, {\n          value: qty_4 || \"\",\n          fontSize: 11\n        }, {\n          value: buy_price_4 || \"\",\n          fontSize: 11\n        }, {\n          value: purchase_discount_4 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_4_dp1 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_4_dp2 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_4_dp3 || \"\",\n          fontSize: 11\n        }, {\n          value: pricelist_4 || \"\",\n          fontSize: 11\n        }, {\n          value: sold_price_4 || \"\",\n          fontSize: 11\n        }, {\n          value: disc_1_4 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_5 || \"\",\n          fontSize: 11\n        }, {\n          value: qty_5 || \"\",\n          fontSize: 11\n        }, {\n          value: buy_price_5 || \"\",\n          fontSize: 11\n        }, {\n          value: purchase_discount_5 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_5_dp1 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_5_dp2 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_5_dp3 || \"\",\n          fontSize: 11\n        }, {\n          value: pricelist_5 || \"\",\n          fontSize: 11\n        }, {\n          value: sold_price_5 || \"\",\n          fontSize: 11\n        }, {\n          value: disc_1_5 || \"\",\n          fontSize: 11\n        }];\n      });\n      excelData.push(...productData);\n    }\n\n    try {\n      const writeFile = await writeXlsxFile(excelData, {\n        columns: columnsWidth,\n        fileName: `Data Produk_${time}.xlsx`\n      });\n    } catch (err) {\n      console.log(err);\n    }\n\n    setLoading(false);\n  };\n\n  return /*#__PURE__*/_jsx(_Fragment, {\n    children: loading ? /*#__PURE__*/_jsx(\"div\", {\n      className: \"w-full flex justify-center items-center h-10\",\n      children: /*#__PURE__*/_jsx(_Spin, {})\n    }) : /*#__PURE__*/_jsx(\"button\", {\n      onClick: exportData,\n      type: \"button\",\n      className: \"bg-cyan-700 text-xs font-bold text-white w-full rounded h-10 hover:bg-cyan-800  shadow-sm flex items-center justify-center float-right\",\n      children: \"Export Excel\"\n    })\n  });\n}","map":null,"metadata":{},"sourceType":"module"}