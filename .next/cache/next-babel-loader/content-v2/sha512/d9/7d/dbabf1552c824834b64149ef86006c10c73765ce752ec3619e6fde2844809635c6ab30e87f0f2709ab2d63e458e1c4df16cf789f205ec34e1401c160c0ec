{"ast":null,"code":"import _Form from \"antd/lib/form\";\nimport _Select from \"antd/lib/select\";\nimport _asyncToGenerator from \"/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/ERP-Sejati/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/ERP-Sejati/components/Form/AddProduct/Categories.js\",\n    _s = $RefreshSig$();\n\nimport _regeneratorRuntime from \"/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/ERP-Sejati/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport React, { useState } from \"react\";\nimport nookies from \"nookies\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Categories(_ref) {\n  _s();\n\n  var _this = this;\n\n  var selectedCategory = _ref.selectedCategory,\n      onSelectCategory = _ref.onSelectCategory,\n      setSubCategories = _ref.setSubCategories,\n      setSelectedSubCategory = _ref.setSelectedSubCategory,\n      selectedSubCategory = _ref.selectedSubCategory,\n      initialValue = _ref.initialValue;\n\n  var _useState = useState(selectedCategory),\n      category = _useState[0],\n      setCategory = _useState[1];\n\n  var _useState2 = useState([]),\n      data = _useState2[0],\n      setData = _useState2[1];\n\n  var cookies = nookies.get(null, \"token\");\n\n  var fetchSubCategoriesById = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(id) {\n      var endpoint, options, req, res, listOfData;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              endpoint = process.env.NEXT_PUBLIC_URL + \"/sub-categories?populate[category][filters][id][$eq]=\".concat(id, \"&populate=*\");\n              options = {\n                method: \"GET\",\n                headers: {\n                  Authorization: \"Bearer \" + cookies.token\n                }\n              };\n              _context.next = 4;\n              return fetch(endpoint, options);\n\n            case 4:\n              req = _context.sent;\n              _context.next = 7;\n              return req.json();\n\n            case 7:\n              res = _context.sent;\n              listOfData = [];\n              res.data.forEach(function (element) {\n                if (element.attributes.category.data !== null) {\n                  listOfData.push(element);\n                }\n              });\n              setSubCategories(listOfData);\n\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function fetchSubCategoriesById(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var handleChangeCategory = function handleChangeCategory(newValue) {\n    setSelectedSubCategory(0);\n    fetchSubCategoriesById(newValue);\n    setCategory(newValue);\n    onSelectCategory(newValue);\n  };\n\n  var handleSearchCategory = function handleSearchCategory(newValue) {\n    if (newValue) {\n      fetchCategory(newValue, setData);\n    } else {\n      setData([]);\n    }\n  };\n\n  var options = data.map(function (d) {\n    return /*#__PURE__*/_jsxDEV(_Select.Option, {\n      children: d.label\n    }, d.value, false, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 5\n    }, _this);\n  });\n\n  var fetchCategory = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(query, callback) {\n      var endpoint, _options, req, res, categoriesResult;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              if (query) {\n                _context2.next = 4;\n                break;\n              }\n\n              callback([]);\n              _context2.next = 19;\n              break;\n\n            case 4:\n              _context2.prev = 4;\n              endpoint = process.env.NEXT_PUBLIC_URL + \"/categories?filters[$or][0][name][$contains]=\".concat(query, \"&filters[$or][1][category_id][$contains]=\").concat(query);\n              _options = {\n                method: \"GET\",\n                headers: {\n                  \"Content-Type\": \"application/json\",\n                  Authorization: \"Bearer \" + cookies.token\n                }\n              };\n              _context2.next = 9;\n              return fetch(endpoint, _options);\n\n            case 9:\n              req = _context2.sent;\n              _context2.next = 12;\n              return req.json();\n\n            case 12:\n              res = _context2.sent;\n\n              if (req.status == 200) {\n                categoriesResult = res.data.map(function (categories) {\n                  return {\n                    label: \"\".concat(categories.attributes.category_id, \" - \").concat(categories.attributes.name),\n                    value: categories.id\n                  };\n                });\n                callback(categoriesResult);\n              }\n\n              _context2.next = 19;\n              break;\n\n            case 16:\n              _context2.prev = 16;\n              _context2.t0 = _context2[\"catch\"](4);\n              console.log(_context2.t0);\n\n            case 19:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[4, 16]]);\n    }));\n\n    return function fetchCategory(_x2, _x3) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"w-full md:w-full mb-2 md:mb-0\",\n    children: /*#__PURE__*/_jsxDEV(_Form.Item, {\n      initialValue: initialValue,\n      name: \"category_id\",\n      rules: [{\n        required: true,\n        message: \"Kategori Produk tidak boleh kosong!\"\n      }],\n      children: /*#__PURE__*/_jsxDEV(_Select, {\n        size: \"large\",\n        showSearch: true,\n        value: category,\n        showArrow: false,\n        placeholder: \"Pilih Kategori\",\n        onSearch: handleSearchCategory,\n        onChange: handleChangeCategory,\n        filterOption: false,\n        defaultActiveFirstOption: false,\n        children: options\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 96,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Categories, \"6+gV0s+RvOE03TUmJM3hLeoINYs=\");\n\n_c = Categories;\n\nvar _c;\n\n$RefreshReg$(_c, \"Categories\");","map":{"version":3,"sources":["/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/ERP-Sejati/components/Form/AddProduct/Categories.js"],"names":["React","useState","nookies","Categories","selectedCategory","onSelectCategory","setSubCategories","setSelectedSubCategory","selectedSubCategory","initialValue","category","setCategory","data","setData","cookies","get","fetchSubCategoriesById","id","endpoint","process","env","NEXT_PUBLIC_URL","options","method","headers","Authorization","token","fetch","req","json","res","listOfData","forEach","element","attributes","push","handleChangeCategory","newValue","handleSearchCategory","fetchCategory","map","d","label","value","query","callback","status","categoriesResult","categories","category_id","name","console","log","required","message"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport { Form, Select } from \"antd\";\nimport nookies from \"nookies\";\n\nexport default function Categories({\n  selectedCategory,\n  onSelectCategory,\n  setSubCategories,\n  setSelectedSubCategory,\n  selectedSubCategory,\n  initialValue,\n}) {\n  const [category, setCategory] = useState(selectedCategory);\n  const [data, setData] = useState([]);\n  const cookies = nookies.get(null, \"token\");\n\n  const fetchSubCategoriesById = async (id) => {\n    const endpoint =\n      process.env.NEXT_PUBLIC_URL +\n      `/sub-categories?populate[category][filters][id][$eq]=${id}&populate=*`;\n\n    const options = {\n      method: \"GET\",\n      headers: {\n        Authorization: \"Bearer \" + cookies.token,\n      },\n    };\n\n    const req = await fetch(endpoint, options);\n    const res = await req.json();\n\n    const listOfData = [];\n\n    res.data.forEach((element) => {\n      if (element.attributes.category.data !== null) {\n        listOfData.push(element);\n      }\n    });\n\n    setSubCategories(listOfData);\n  };\n\n  const handleChangeCategory = (newValue) => {\n    setSelectedSubCategory(0);\n    fetchSubCategoriesById(newValue);\n\n    setCategory(newValue);\n    onSelectCategory(newValue);\n  };\n\n  const handleSearchCategory = (newValue) => {\n    if (newValue) {\n      fetchCategory(newValue, setData);\n    } else {\n      setData([]);\n    }\n  };\n  const options = data.map((d) => (\n    <Select.Option key={d.value}>{d.label}</Select.Option>\n  ));\n\n  const fetchCategory = async (query, callback) => {\n    if (!query) {\n      callback([]);\n    } else {\n      try {\n        const endpoint =\n          process.env.NEXT_PUBLIC_URL +\n          `/categories?filters[$or][0][name][$contains]=${query}&filters[$or][1][category_id][$contains]=${query}`;\n        const options = {\n          method: \"GET\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: \"Bearer \" + cookies.token,\n          },\n        };\n\n        const req = await fetch(endpoint, options);\n        const res = await req.json();\n\n        if (req.status == 200) {\n          const categoriesResult = res.data.map((categories) => ({\n            label: `${categories.attributes.category_id} - ${categories.attributes.name}`,\n            value: categories.id,\n          }));\n\n          callback(categoriesResult);\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    }\n  };\n\n  return (\n    <div className=\"w-full md:w-full mb-2 md:mb-0\">\n      <Form.Item\n        initialValue={initialValue}\n        name=\"category_id\"\n        rules={[\n          {\n            required: true,\n            message: \"Kategori Produk tidak boleh kosong!\",\n          },\n        ]}\n      >\n        <Select\n          size=\"large\"\n          showSearch\n          value={category}\n          showArrow={false}\n          placeholder=\"Pilih Kategori\"\n          onSearch={handleSearchCategory}\n          onChange={handleChangeCategory}\n          filterOption={false}\n          defaultActiveFirstOption={false}\n        >\n          {options}\n        </Select>\n      </Form.Item>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}