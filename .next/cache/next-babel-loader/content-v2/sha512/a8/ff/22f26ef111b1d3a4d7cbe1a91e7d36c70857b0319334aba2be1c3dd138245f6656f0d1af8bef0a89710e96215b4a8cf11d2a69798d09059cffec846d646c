{"ast":null,"code":"import _Spin from \"antd/lib/spin\";\nvar _jsxFileName = \"/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/JS-Deploy/components/Form/ExportProduk.js\";\nimport moment from \"moment\";\nimport React, { useState } from \"react\";\nimport writeXlsxFile from \"write-excel-file\";\nimport { HEADER_ROW_1, HEADER_ROW_2, columnsWidth } from \"./utils/ExcelStyles\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function ExportProduk({\n  data = [],\n  setProduct\n}) {\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(false);\n  const excelData = [HEADER_ROW_1, HEADER_ROW_2];\n\n  const exportData = async () => {\n    setLoading(true);\n    const time = moment().unix();\n\n    if (data.length > 0) {\n      const productData = data.map(product => {\n        var _attributes$category$, _attributes$category$2, _attributes$group$dat, _attributes$group$dat2, _attributes$manufactu, _attributes$manufactu2, _ref, _attributes$sub_categ, _attributes$sub_categ2;\n\n        const {\n          attributes\n        } = product; // kategori, golongan, lokasi, pabrikasi, sub kategori\n\n        const kategori = `${(_attributes$category$ = attributes.category.data) === null || _attributes$category$ === void 0 ? void 0 : _attributes$category$.attributes.category_id} - ${(_attributes$category$2 = attributes.category.data) === null || _attributes$category$2 === void 0 ? void 0 : _attributes$category$2.attributes.name}` || \"\";\n        const golongan = `${(_attributes$group$dat = attributes.group.data) === null || _attributes$group$dat === void 0 ? void 0 : _attributes$group$dat.attributes.alias} - ${(_attributes$group$dat2 = attributes.group.data) === null || _attributes$group$dat2 === void 0 ? void 0 : _attributes$group$dat2.attributes.name}` || \"\";\n        const pabrikasi = `${(_attributes$manufactu = attributes.manufacture.data) === null || _attributes$manufactu === void 0 ? void 0 : _attributes$manufactu.attributes.code} - ${(_attributes$manufactu2 = attributes.manufacture.data) === null || _attributes$manufactu2 === void 0 ? void 0 : _attributes$manufactu2.attributes.name}` || \"\";\n        const subKategori = (_ref = `${(_attributes$sub_categ = attributes.sub_category.data) === null || _attributes$sub_categ === void 0 ? void 0 : _attributes$sub_categ.attributes.sub_id} - ${(_attributes$sub_categ2 = attributes.sub_category.data) === null || _attributes$sub_categ2 === void 0 ? void 0 : _attributes$sub_categ2.attributes.name}`) !== null && _ref !== void 0 ? _ref : \"\"; // proses data lokasi\n\n        const dataLokasi = attributes.locations.data.map(location => {\n          return location.attributes.name;\n        }) || [];\n        const lokasi = dataLokasi.join(\", \") || \"\";\n        const {\n          SKU,\n          buy_price_1,\n          buy_price_2,\n          buy_price_3,\n          buy_price_4,\n          buy_price_5,\n          description,\n          disc_1_1,\n          disc_1_2,\n          disc_1_3,\n          disc_1_4,\n          disc_1_5,\n          name,\n          pricelist_1,\n          pricelist_2,\n          pricelist_3,\n          pricelist_4,\n          pricelist_5,\n          purchase_discount_1,\n          purchase_discount_2,\n          purchase_discount_3,\n          purchase_discount_4,\n          purchase_discount_5,\n          qty_1,\n          qty_2,\n          qty_3,\n          qty_4,\n          qty_5,\n          sold_price_1,\n          sold_price_2,\n          sold_price_3,\n          sold_price_4,\n          sold_price_5,\n          unit_1,\n          unit_2,\n          unit_3,\n          unit_4,\n          unit_5,\n          unit_1_dp1,\n          unit_1_dp2,\n          unit_1_dp3,\n          unit_1_dp4,\n          unit_1_dp5,\n          unit_2_dp1,\n          unit_2_dp2,\n          unit_2_dp3,\n          unit_2_dp4,\n          unit_2_dp5,\n          unit_3_dp1,\n          unit_3_dp2,\n          unit_3_dp3,\n          unit_3_dp4,\n          unit_3_dp5,\n          unit_4_dp1,\n          unit_4_dp2,\n          unit_4_dp3,\n          unit_4_dp4,\n          unit_4_dp5,\n          unit_5_dp1,\n          unit_5_dp2,\n          unit_5_dp3,\n          unit_5_dp4,\n          unit_5_dp5\n        } = attributes;\n        return [{\n          value: SKU || \"\",\n          fontSize: 11\n        }, {\n          value: name || \"\",\n          fontSize: 11\n        }, {\n          value: kategori,\n          fontSize: 11\n        }, {\n          value: subKategori,\n          fontSize: 11\n        }, {\n          value: pabrikasi,\n          fontSize: 11\n        }, {\n          value: golongan,\n          fontSize: 11\n        }, {\n          value: lokasi,\n          fontSize: 11\n        }, {\n          value: description || \"\",\n          fontSize: 11\n        }, {\n          value: unit_1 || \"\",\n          fontSize: 11\n        }, {\n          value: qty_1 || \"\",\n          fontSize: 11\n        }, {\n          value: buy_price_1 || \"\",\n          fontSize: 11\n        }, {\n          value: purchase_discount_1 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_1_dp1 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_1_dp2 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_1_dp3 || \"\",\n          fontSize: 11\n        }, {\n          value: pricelist_1 || \"\",\n          fontSize: 11\n        }, {\n          value: sold_price_1 || \"\",\n          fontSize: 11\n        }, {\n          value: disc_1_1 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_2 || \"\",\n          fontSize: 11\n        }, {\n          value: qty_2 || \"\",\n          fontSize: 11\n        }, {\n          value: buy_price_2 || \"\",\n          fontSize: 11\n        }, {\n          value: purchase_discount_2 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_2_dp1 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_2_dp2 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_2_dp3 || \"\",\n          fontSize: 11\n        }, {\n          value: pricelist_2 || \"\",\n          fontSize: 11\n        }, {\n          value: sold_price_2 || \"\",\n          fontSize: 11\n        }, {\n          value: disc_1_2 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_3 || \"\",\n          fontSize: 11\n        }, {\n          value: qty_3 || \"\",\n          fontSize: 11\n        }, {\n          value: buy_price_3 || \"\",\n          fontSize: 11\n        }, {\n          value: purchase_discount_3 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_3_dp1 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_3_dp2 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_3_dp3 || \"\",\n          fontSize: 11\n        }, {\n          value: pricelist_3 || \"\",\n          fontSize: 11\n        }, {\n          value: sold_price_3 || \"\",\n          fontSize: 11\n        }, {\n          value: disc_1_3 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_4 || \"\",\n          fontSize: 11\n        }, {\n          value: qty_4 || \"\",\n          fontSize: 11\n        }, {\n          value: buy_price_4 || \"\",\n          fontSize: 11\n        }, {\n          value: purchase_discount_4 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_4_dp1 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_4_dp2 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_4_dp3 || \"\",\n          fontSize: 11\n        }, {\n          value: pricelist_4 || \"\",\n          fontSize: 11\n        }, {\n          value: sold_price_4 || \"\",\n          fontSize: 11\n        }, {\n          value: disc_1_4 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_5 || \"\",\n          fontSize: 11\n        }, {\n          value: qty_5 || \"\",\n          fontSize: 11\n        }, {\n          value: buy_price_5 || \"\",\n          fontSize: 11\n        }, {\n          value: purchase_discount_5 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_5_dp1 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_5_dp2 || \"\",\n          fontSize: 11\n        }, {\n          value: unit_5_dp3 || \"\",\n          fontSize: 11\n        }, {\n          value: pricelist_5 || \"\",\n          fontSize: 11\n        }, {\n          value: sold_price_5 || \"\",\n          fontSize: 11\n        }, {\n          value: disc_1_5 || \"\",\n          fontSize: 11\n        }];\n      });\n      excelData.push(...productData);\n    }\n\n    try {\n      const writeFile = await writeXlsxFile(excelData, {\n        columns: columnsWidth,\n        fileName: `Data Produk_${time}.xlsx`\n      });\n    } catch (err) {\n      console.log(err);\n    }\n\n    setLoading(false);\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-full flex justify-center items-center h-10\",\n      children: /*#__PURE__*/_jsxDEV(_Spin, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 351,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 350,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: exportData,\n      type: \"button\",\n      className: \"bg-cyan-700 text-xs font-bold text-white w-full rounded h-10 hover:bg-cyan-800  shadow-sm flex items-center justify-center float-right\",\n      children: \"Export Excel\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 354,\n      columnNumber: 9\n    }, this)\n  }, void 0, false);\n}","map":{"version":3,"sources":["/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/JS-Deploy/components/Form/ExportProduk.js"],"names":["moment","React","useState","writeXlsxFile","HEADER_ROW_1","HEADER_ROW_2","columnsWidth","ExportProduk","data","setProduct","loading","setLoading","excelData","exportData","time","unix","length","productData","map","product","attributes","kategori","category","category_id","name","golongan","group","alias","pabrikasi","manufacture","code","subKategori","sub_category","sub_id","dataLokasi","locations","location","lokasi","join","SKU","buy_price_1","buy_price_2","buy_price_3","buy_price_4","buy_price_5","description","disc_1_1","disc_1_2","disc_1_3","disc_1_4","disc_1_5","pricelist_1","pricelist_2","pricelist_3","pricelist_4","pricelist_5","purchase_discount_1","purchase_discount_2","purchase_discount_3","purchase_discount_4","purchase_discount_5","qty_1","qty_2","qty_3","qty_4","qty_5","sold_price_1","sold_price_2","sold_price_3","sold_price_4","sold_price_5","unit_1","unit_2","unit_3","unit_4","unit_5","unit_1_dp1","unit_1_dp2","unit_1_dp3","unit_1_dp4","unit_1_dp5","unit_2_dp1","unit_2_dp2","unit_2_dp3","unit_2_dp4","unit_2_dp5","unit_3_dp1","unit_3_dp2","unit_3_dp3","unit_3_dp4","unit_3_dp5","unit_4_dp1","unit_4_dp2","unit_4_dp3","unit_4_dp4","unit_4_dp5","unit_5_dp1","unit_5_dp2","unit_5_dp3","unit_5_dp4","unit_5_dp5","value","fontSize","push","writeFile","columns","fileName","err","console","log"],"mappings":";;AACA,OAAOA,MAAP,MAAmB,QAAnB;AACA,OAAOC,KAAP,IAAgBC,QAAhB,QAAgC,OAAhC;AACA,OAAOC,aAAP,MAA0B,kBAA1B;AACA,SAASC,YAAT,EAAuBC,YAAvB,EAAqCC,YAArC,QAAyD,qBAAzD;;;AAEA,eAAe,SAASC,YAAT,CAAsB;AAAEC,EAAAA,IAAI,GAAG,EAAT;AAAaC,EAAAA;AAAb,CAAtB,EAAiD;AAC9D,QAAM;AAAA,OAACC,OAAD;AAAA,OAAUC;AAAV,MAAwBT,QAAQ,CAAC,KAAD,CAAtC;AACA,QAAMU,SAAS,GAAG,CAACR,YAAD,EAAeC,YAAf,CAAlB;;AAEA,QAAMQ,UAAU,GAAG,YAAY;AAC7BF,IAAAA,UAAU,CAAC,IAAD,CAAV;AACA,UAAMG,IAAI,GAAGd,MAAM,GAAGe,IAAT,EAAb;;AAEA,QAAIP,IAAI,CAACQ,MAAL,GAAc,CAAlB,EAAqB;AACnB,YAAMC,WAAW,GAAGT,IAAI,CAACU,GAAL,CAAUC,OAAD,IAAa;AAAA;;AACxC,cAAM;AAAEC,UAAAA;AAAF,YAAiBD,OAAvB,CADwC,CAGxC;;AACA,cAAME,QAAQ,GAAI,GAAD,yBAAGD,UAAU,CAACE,QAAX,CAAoBd,IAAvB,0DAAG,sBAA0BY,UAA1B,CAAqCG,WAAY,MAApD,0BAAyDH,UAAU,CAACE,QAAX,CAAoBd,IAA7E,2DAAyD,uBAA0BY,UAA1B,CAAqCI,IAAK,EAAnG,IAAwG,EAAzH;AACA,cAAMC,QAAQ,GAAI,GAAD,yBAAGL,UAAU,CAACM,KAAX,CAAiBlB,IAApB,0DAAG,sBAAuBY,UAAvB,CAAkCO,KAAM,MAA3C,0BAAgDP,UAAU,CAACM,KAAX,CAAiBlB,IAAjE,2DAAgD,uBAAuBY,UAAvB,CAAkCI,IAAK,EAAvF,IAA4F,EAA7G;AACA,cAAMI,SAAS,GAAI,GAAD,yBAAGR,UAAU,CAACS,WAAX,CAAuBrB,IAA1B,0DAAG,sBAA6BY,UAA7B,CAAwCU,IAAK,MAAhD,0BAAqDV,UAAU,CAACS,WAAX,CAAuBrB,IAA5E,2DAAqD,uBAA6BY,UAA7B,CAAwCI,IAAK,EAAlG,IAAuG,EAAzH;AACA,cAAMO,WAAW,WAAI,GAAD,yBAAGX,UAAU,CAACY,YAAX,CAAwBxB,IAA3B,0DAAG,sBAA8BY,UAA9B,CAAyCa,MAAO,MAAnD,0BAAwDb,UAAU,CAACY,YAAX,CAAwBxB,IAAhF,2DAAwD,uBAA8BY,UAA9B,CAAyCI,IAAK,EAAzG,uCAA8G,EAA/H,CAPwC,CAQxC;;AACA,cAAMU,UAAU,GACdd,UAAU,CAACe,SAAX,CAAqB3B,IAArB,CAA0BU,GAA1B,CAA+BkB,QAAD,IAAc;AAC1C,iBAAOA,QAAQ,CAAChB,UAAT,CAAoBI,IAA3B;AACD,SAFD,KAEM,EAHR;AAIA,cAAMa,MAAM,GAAGH,UAAU,CAACI,IAAX,CAAgB,IAAhB,KAAyB,EAAxC;AAEA,cAAM;AACJC,UAAAA,GADI;AAEJC,UAAAA,WAFI;AAGJC,UAAAA,WAHI;AAIJC,UAAAA,WAJI;AAKJC,UAAAA,WALI;AAMJC,UAAAA,WANI;AAOJC,UAAAA,WAPI;AAQJC,UAAAA,QARI;AASJC,UAAAA,QATI;AAUJC,UAAAA,QAVI;AAWJC,UAAAA,QAXI;AAYJC,UAAAA,QAZI;AAaJ1B,UAAAA,IAbI;AAcJ2B,UAAAA,WAdI;AAeJC,UAAAA,WAfI;AAgBJC,UAAAA,WAhBI;AAiBJC,UAAAA,WAjBI;AAkBJC,UAAAA,WAlBI;AAmBJC,UAAAA,mBAnBI;AAoBJC,UAAAA,mBApBI;AAqBJC,UAAAA,mBArBI;AAsBJC,UAAAA,mBAtBI;AAuBJC,UAAAA,mBAvBI;AAwBJC,UAAAA,KAxBI;AAyBJC,UAAAA,KAzBI;AA0BJC,UAAAA,KA1BI;AA2BJC,UAAAA,KA3BI;AA4BJC,UAAAA,KA5BI;AA6BJC,UAAAA,YA7BI;AA8BJC,UAAAA,YA9BI;AA+BJC,UAAAA,YA/BI;AAgCJC,UAAAA,YAhCI;AAiCJC,UAAAA,YAjCI;AAkCJC,UAAAA,MAlCI;AAmCJC,UAAAA,MAnCI;AAoCJC,UAAAA,MApCI;AAqCJC,UAAAA,MArCI;AAsCJC,UAAAA,MAtCI;AAuCJC,UAAAA,UAvCI;AAwCJC,UAAAA,UAxCI;AAyCJC,UAAAA,UAzCI;AA0CJC,UAAAA,UA1CI;AA2CJC,UAAAA,UA3CI;AA4CJC,UAAAA,UA5CI;AA6CJC,UAAAA,UA7CI;AA8CJC,UAAAA,UA9CI;AA+CJC,UAAAA,UA/CI;AAgDJC,UAAAA,UAhDI;AAiDJC,UAAAA,UAjDI;AAkDJC,UAAAA,UAlDI;AAmDJC,UAAAA,UAnDI;AAoDJC,UAAAA,UApDI;AAqDJC,UAAAA,UArDI;AAsDJC,UAAAA,UAtDI;AAuDJC,UAAAA,UAvDI;AAwDJC,UAAAA,UAxDI;AAyDJC,UAAAA,UAzDI;AA0DJC,UAAAA,UA1DI;AA2DJC,UAAAA,UA3DI;AA4DJC,UAAAA,UA5DI;AA6DJC,UAAAA,UA7DI;AA8DJC,UAAAA,UA9DI;AA+DJC,UAAAA;AA/DI,YAgEFhF,UAhEJ;AAiEA,eAAO,CACL;AACEiF,UAAAA,KAAK,EAAE9D,GAAG,IAAI,EADhB;AAEE+D,UAAAA,QAAQ,EAAE;AAFZ,SADK,EAKL;AACED,UAAAA,KAAK,EAAE7E,IAAI,IAAI,EADjB;AAEE8E,UAAAA,QAAQ,EAAE;AAFZ,SALK,EASL;AACED,UAAAA,KAAK,EAAEhF,QADT;AAEEiF,UAAAA,QAAQ,EAAE;AAFZ,SATK,EAaL;AACED,UAAAA,KAAK,EAAEtE,WADT;AAEEuE,UAAAA,QAAQ,EAAE;AAFZ,SAbK,EAiBL;AACED,UAAAA,KAAK,EAAEzE,SADT;AAEE0E,UAAAA,QAAQ,EAAE;AAFZ,SAjBK,EAqBL;AACED,UAAAA,KAAK,EAAE5E,QADT;AAEE6E,UAAAA,QAAQ,EAAE;AAFZ,SArBK,EAyBL;AACED,UAAAA,KAAK,EAAEhE,MADT;AAEEiE,UAAAA,QAAQ,EAAE;AAFZ,SAzBK,EA6BL;AACED,UAAAA,KAAK,EAAExD,WAAW,IAAI,EADxB;AAEEyD,UAAAA,QAAQ,EAAE;AAFZ,SA7BK,EAiCL;AACED,UAAAA,KAAK,EAAE9B,MAAM,IAAI,EADnB;AAEE+B,UAAAA,QAAQ,EAAE;AAFZ,SAjCK,EAqCL;AACED,UAAAA,KAAK,EAAExC,KAAK,IAAI,EADlB;AAEEyC,UAAAA,QAAQ,EAAE;AAFZ,SArCK,EAyCL;AACED,UAAAA,KAAK,EAAE7D,WAAW,IAAI,EADxB;AAEE8D,UAAAA,QAAQ,EAAE;AAFZ,SAzCK,EA6CL;AACED,UAAAA,KAAK,EAAE7C,mBAAmB,IAAI,EADhC;AAEE8C,UAAAA,QAAQ,EAAE;AAFZ,SA7CK,EAiDL;AACED,UAAAA,KAAK,EAAEzB,UAAU,IAAI,EADvB;AAEE0B,UAAAA,QAAQ,EAAE;AAFZ,SAjDK,EAqDL;AACED,UAAAA,KAAK,EAAExB,UAAU,IAAI,EADvB;AAEEyB,UAAAA,QAAQ,EAAE;AAFZ,SArDK,EAyDL;AACED,UAAAA,KAAK,EAAEvB,UAAU,IAAI,EADvB;AAEEwB,UAAAA,QAAQ,EAAE;AAFZ,SAzDK,EA6DL;AACED,UAAAA,KAAK,EAAElD,WAAW,IAAI,EADxB;AAEEmD,UAAAA,QAAQ,EAAE;AAFZ,SA7DK,EAiEL;AACED,UAAAA,KAAK,EAAEnC,YAAY,IAAI,EADzB;AAEEoC,UAAAA,QAAQ,EAAE;AAFZ,SAjEK,EAqEL;AACED,UAAAA,KAAK,EAAEvD,QAAQ,IAAI,EADrB;AAEEwD,UAAAA,QAAQ,EAAE;AAFZ,SArEK,EAyEL;AACED,UAAAA,KAAK,EAAE7B,MAAM,IAAI,EADnB;AAEE8B,UAAAA,QAAQ,EAAE;AAFZ,SAzEK,EA6EL;AACED,UAAAA,KAAK,EAAEvC,KAAK,IAAI,EADlB;AAEEwC,UAAAA,QAAQ,EAAE;AAFZ,SA7EK,EAiFL;AACED,UAAAA,KAAK,EAAE5D,WAAW,IAAI,EADxB;AAEE6D,UAAAA,QAAQ,EAAE;AAFZ,SAjFK,EAqFL;AACED,UAAAA,KAAK,EAAE5C,mBAAmB,IAAI,EADhC;AAEE6C,UAAAA,QAAQ,EAAE;AAFZ,SArFK,EAyFL;AACED,UAAAA,KAAK,EAAEpB,UAAU,IAAI,EADvB;AAEEqB,UAAAA,QAAQ,EAAE;AAFZ,SAzFK,EA6FL;AACED,UAAAA,KAAK,EAAEnB,UAAU,IAAI,EADvB;AAEEoB,UAAAA,QAAQ,EAAE;AAFZ,SA7FK,EAiGL;AACED,UAAAA,KAAK,EAAElB,UAAU,IAAI,EADvB;AAEEmB,UAAAA,QAAQ,EAAE;AAFZ,SAjGK,EAqGL;AACED,UAAAA,KAAK,EAAEjD,WAAW,IAAI,EADxB;AAEEkD,UAAAA,QAAQ,EAAE;AAFZ,SArGK,EAyGL;AACED,UAAAA,KAAK,EAAElC,YAAY,IAAI,EADzB;AAEEmC,UAAAA,QAAQ,EAAE;AAFZ,SAzGK,EA6GL;AACED,UAAAA,KAAK,EAAEtD,QAAQ,IAAI,EADrB;AAEEuD,UAAAA,QAAQ,EAAE;AAFZ,SA7GK,EAiHL;AACED,UAAAA,KAAK,EAAE5B,MAAM,IAAI,EADnB;AAEE6B,UAAAA,QAAQ,EAAE;AAFZ,SAjHK,EAqHL;AACED,UAAAA,KAAK,EAAEtC,KAAK,IAAI,EADlB;AAEEuC,UAAAA,QAAQ,EAAE;AAFZ,SArHK,EAyHL;AACED,UAAAA,KAAK,EAAE3D,WAAW,IAAI,EADxB;AAEE4D,UAAAA,QAAQ,EAAE;AAFZ,SAzHK,EA6HL;AACED,UAAAA,KAAK,EAAE3C,mBAAmB,IAAI,EADhC;AAEE4C,UAAAA,QAAQ,EAAE;AAFZ,SA7HK,EAiIL;AACED,UAAAA,KAAK,EAAEf,UAAU,IAAI,EADvB;AAEEgB,UAAAA,QAAQ,EAAE;AAFZ,SAjIK,EAqIL;AACED,UAAAA,KAAK,EAAEd,UAAU,IAAI,EADvB;AAEEe,UAAAA,QAAQ,EAAE;AAFZ,SArIK,EAyIL;AACED,UAAAA,KAAK,EAAEb,UAAU,IAAI,EADvB;AAEEc,UAAAA,QAAQ,EAAE;AAFZ,SAzIK,EA6IL;AACED,UAAAA,KAAK,EAAEhD,WAAW,IAAI,EADxB;AAEEiD,UAAAA,QAAQ,EAAE;AAFZ,SA7IK,EAiJL;AACED,UAAAA,KAAK,EAAEjC,YAAY,IAAI,EADzB;AAEEkC,UAAAA,QAAQ,EAAE;AAFZ,SAjJK,EAqJL;AACED,UAAAA,KAAK,EAAErD,QAAQ,IAAI,EADrB;AAEEsD,UAAAA,QAAQ,EAAE;AAFZ,SArJK,EAyJL;AACED,UAAAA,KAAK,EAAE3B,MAAM,IAAI,EADnB;AAEE4B,UAAAA,QAAQ,EAAE;AAFZ,SAzJK,EA6JL;AACED,UAAAA,KAAK,EAAErC,KAAK,IAAI,EADlB;AAEEsC,UAAAA,QAAQ,EAAE;AAFZ,SA7JK,EAiKL;AACED,UAAAA,KAAK,EAAE1D,WAAW,IAAI,EADxB;AAEE2D,UAAAA,QAAQ,EAAE;AAFZ,SAjKK,EAqKL;AACED,UAAAA,KAAK,EAAE1C,mBAAmB,IAAI,EADhC;AAEE2C,UAAAA,QAAQ,EAAE;AAFZ,SArKK,EAyKL;AACED,UAAAA,KAAK,EAAEV,UAAU,IAAI,EADvB;AAEEW,UAAAA,QAAQ,EAAE;AAFZ,SAzKK,EA6KL;AACED,UAAAA,KAAK,EAAET,UAAU,IAAI,EADvB;AAEEU,UAAAA,QAAQ,EAAE;AAFZ,SA7KK,EAiLL;AACED,UAAAA,KAAK,EAAER,UAAU,IAAI,EADvB;AAEES,UAAAA,QAAQ,EAAE;AAFZ,SAjLK,EAqLL;AACED,UAAAA,KAAK,EAAE/C,WAAW,IAAI,EADxB;AAEEgD,UAAAA,QAAQ,EAAE;AAFZ,SArLK,EAyLL;AACED,UAAAA,KAAK,EAAEhC,YAAY,IAAI,EADzB;AAEEiC,UAAAA,QAAQ,EAAE;AAFZ,SAzLK,EA6LL;AACED,UAAAA,KAAK,EAAEpD,QAAQ,IAAI,EADrB;AAEEqD,UAAAA,QAAQ,EAAE;AAFZ,SA7LK,EAiML;AACED,UAAAA,KAAK,EAAE1B,MAAM,IAAI,EADnB;AAEE2B,UAAAA,QAAQ,EAAE;AAFZ,SAjMK,EAqML;AACED,UAAAA,KAAK,EAAEpC,KAAK,IAAI,EADlB;AAEEqC,UAAAA,QAAQ,EAAE;AAFZ,SArMK,EAyML;AACED,UAAAA,KAAK,EAAEzD,WAAW,IAAI,EADxB;AAEE0D,UAAAA,QAAQ,EAAE;AAFZ,SAzMK,EA6ML;AACED,UAAAA,KAAK,EAAEzC,mBAAmB,IAAI,EADhC;AAEE0C,UAAAA,QAAQ,EAAE;AAFZ,SA7MK,EAiNL;AACED,UAAAA,KAAK,EAAEL,UAAU,IAAI,EADvB;AAEEM,UAAAA,QAAQ,EAAE;AAFZ,SAjNK,EAqNL;AACED,UAAAA,KAAK,EAAEJ,UAAU,IAAI,EADvB;AAEEK,UAAAA,QAAQ,EAAE;AAFZ,SArNK,EAyNL;AACED,UAAAA,KAAK,EAAEH,UAAU,IAAI,EADvB;AAEEI,UAAAA,QAAQ,EAAE;AAFZ,SAzNK,EA6NL;AACED,UAAAA,KAAK,EAAE9C,WAAW,IAAI,EADxB;AAEE+C,UAAAA,QAAQ,EAAE;AAFZ,SA7NK,EAiOL;AACED,UAAAA,KAAK,EAAE/B,YAAY,IAAI,EADzB;AAEEgC,UAAAA,QAAQ,EAAE;AAFZ,SAjOK,EAqOL;AACED,UAAAA,KAAK,EAAEnD,QAAQ,IAAI,EADrB;AAEEoD,UAAAA,QAAQ,EAAE;AAFZ,SArOK,CAAP;AA0OD,OA1TmB,CAApB;AA4TA1F,MAAAA,SAAS,CAAC2F,IAAV,CAAe,GAAGtF,WAAlB;AACD;;AAED,QAAI;AACF,YAAMuF,SAAS,GAAG,MAAMrG,aAAa,CAACS,SAAD,EAAY;AAC/C6F,QAAAA,OAAO,EAAEnG,YADsC;AAE/CoG,QAAAA,QAAQ,EAAG,eAAc5F,IAAK;AAFiB,OAAZ,CAArC;AAID,KALD,CAKE,OAAO6F,GAAP,EAAY;AACZC,MAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AACD;;AAEDhG,IAAAA,UAAU,CAAC,KAAD,CAAV;AACD,GA9UD;;AAgVA,sBACE;AAAA,cACGD,OAAO,gBACN;AAAK,MAAA,SAAS,EAAC,8CAAf;AAAA,6BACE;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,YADM,gBAKN;AACE,MAAA,OAAO,EAAEG,UADX;AAEE,MAAA,IAAI,EAAC,QAFP;AAGE,MAAA,SAAS,EAAC,wIAHZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AANJ,mBADF;AAiBD","sourcesContent":["import { Spin } from \"antd\";\nimport moment from \"moment\";\nimport React, { useState } from \"react\";\nimport writeXlsxFile from \"write-excel-file\";\nimport { HEADER_ROW_1, HEADER_ROW_2, columnsWidth } from \"./utils/ExcelStyles\";\n\nexport default function ExportProduk({ data = [], setProduct }) {\n  const [loading, setLoading] = useState(false);\n  const excelData = [HEADER_ROW_1, HEADER_ROW_2];\n\n  const exportData = async () => {\n    setLoading(true);\n    const time = moment().unix();\n\n    if (data.length > 0) {\n      const productData = data.map((product) => {\n        const { attributes } = product;\n\n        // kategori, golongan, lokasi, pabrikasi, sub kategori\n        const kategori = `${attributes.category.data?.attributes.category_id} - ${attributes.category.data?.attributes.name}` || \"\";\n        const golongan = `${attributes.group.data?.attributes.alias} - ${attributes.group.data?.attributes.name}` || \"\";\n        const pabrikasi = `${attributes.manufacture.data?.attributes.code} - ${attributes.manufacture.data?.attributes.name}` || \"\";\n        const subKategori = `${attributes.sub_category.data?.attributes.sub_id} - ${attributes.sub_category.data?.attributes.name}` ?? \"\";\n        // proses data lokasi\n        const dataLokasi =\n          attributes.locations.data.map((location) => {\n            return location.attributes.name;\n          }) || [];\n        const lokasi = dataLokasi.join(\", \") || \"\";\n\n        const {\n          SKU,\n          buy_price_1,\n          buy_price_2,\n          buy_price_3,\n          buy_price_4,\n          buy_price_5,\n          description,\n          disc_1_1,\n          disc_1_2,\n          disc_1_3,\n          disc_1_4,\n          disc_1_5,\n          name,\n          pricelist_1,\n          pricelist_2,\n          pricelist_3,\n          pricelist_4,\n          pricelist_5,\n          purchase_discount_1,\n          purchase_discount_2,\n          purchase_discount_3,\n          purchase_discount_4,\n          purchase_discount_5,\n          qty_1,\n          qty_2,\n          qty_3,\n          qty_4,\n          qty_5,\n          sold_price_1,\n          sold_price_2,\n          sold_price_3,\n          sold_price_4,\n          sold_price_5,\n          unit_1,\n          unit_2,\n          unit_3,\n          unit_4,\n          unit_5,\n          unit_1_dp1,\n          unit_1_dp2,\n          unit_1_dp3,\n          unit_1_dp4,\n          unit_1_dp5,\n          unit_2_dp1,\n          unit_2_dp2,\n          unit_2_dp3,\n          unit_2_dp4,\n          unit_2_dp5,\n          unit_3_dp1,\n          unit_3_dp2,\n          unit_3_dp3,\n          unit_3_dp4,\n          unit_3_dp5,\n          unit_4_dp1,\n          unit_4_dp2,\n          unit_4_dp3,\n          unit_4_dp4,\n          unit_4_dp5,\n          unit_5_dp1,\n          unit_5_dp2,\n          unit_5_dp3,\n          unit_5_dp4,\n          unit_5_dp5,\n        } = attributes;\n        return [\n          {\n            value: SKU || \"\",\n            fontSize: 11,\n          },\n          {\n            value: name || \"\",\n            fontSize: 11,\n          },\n          {\n            value: kategori,\n            fontSize: 11,\n          },\n          {\n            value: subKategori,\n            fontSize: 11,\n          },\n          {\n            value: pabrikasi,\n            fontSize: 11,\n          },\n          {\n            value: golongan,\n            fontSize: 11,\n          },\n          {\n            value: lokasi,\n            fontSize: 11,\n          },\n          {\n            value: description || \"\",\n            fontSize: 11,\n          },\n          {\n            value: unit_1 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: qty_1 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: buy_price_1 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: purchase_discount_1 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: unit_1_dp1 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: unit_1_dp2 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: unit_1_dp3 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: pricelist_1 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: sold_price_1 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: disc_1_1 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: unit_2 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: qty_2 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: buy_price_2 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: purchase_discount_2 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: unit_2_dp1 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: unit_2_dp2 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: unit_2_dp3 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: pricelist_2 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: sold_price_2 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: disc_1_2 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: unit_3 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: qty_3 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: buy_price_3 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: purchase_discount_3 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: unit_3_dp1 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: unit_3_dp2 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: unit_3_dp3 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: pricelist_3 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: sold_price_3 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: disc_1_3 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: unit_4 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: qty_4 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: buy_price_4 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: purchase_discount_4 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: unit_4_dp1 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: unit_4_dp2 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: unit_4_dp3 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: pricelist_4 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: sold_price_4 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: disc_1_4 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: unit_5 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: qty_5 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: buy_price_5 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: purchase_discount_5 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: unit_5_dp1 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: unit_5_dp2 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: unit_5_dp3 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: pricelist_5 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: sold_price_5 || \"\",\n            fontSize: 11,\n          },\n          {\n            value: disc_1_5 || \"\",\n            fontSize: 11,\n          },\n        ];\n      });\n\n      excelData.push(...productData);\n    }\n\n    try {\n      const writeFile = await writeXlsxFile(excelData, {\n        columns: columnsWidth,\n        fileName: `Data Produk_${time}.xlsx`,\n      });\n    } catch (err) {\n      console.log(err);\n    }\n\n    setLoading(false);\n  };\n\n  return (\n    <>\n      {loading ? (\n        <div className=\"w-full flex justify-center items-center h-10\">\n          <Spin />\n        </div>\n      ) : (\n        <button\n          onClick={exportData}\n          type=\"button\"\n          className=\"bg-cyan-700 text-xs font-bold text-white w-full rounded h-10 hover:bg-cyan-800  shadow-sm flex items-center justify-center float-right\"\n        >\n          Export Excel\n        </button>\n      )}\n    </>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}