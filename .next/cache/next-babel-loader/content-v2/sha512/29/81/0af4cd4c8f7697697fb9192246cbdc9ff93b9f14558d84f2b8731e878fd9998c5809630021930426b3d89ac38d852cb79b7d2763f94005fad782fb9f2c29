{"ast":null,"code":"import _asyncToGenerator from \"/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/JS-Deploy/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/JS-Deploy/node_modules/next/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _defineProperty from \"/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/JS-Deploy/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/JS-Deploy/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport jwtConfig from '@iso/config/jwt.config';\nimport jwtDecode from 'jwt-decode';\n\nvar JwtAuth = function JwtAuth() {\n  _classCallCheck(this, JwtAuth);\n\n  _defineProperty(this, \"login\", /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(userInfo) {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!(!userInfo.username || !userInfo.password)) {\n                _context.next = 2;\n                break;\n              }\n\n              return _context.abrupt(\"return\", {\n                error: 'please fill in the input'\n              });\n\n            case 2:\n              _context.next = 4;\n              return fetch(jwtConfig.fetchUrl, {\n                method: 'post',\n                headers: {\n                  Accept: 'application/json',\n                  'Content-Type': 'application/json'\n                },\n                body: JSON.stringify(userInfo)\n              }).then(function (response) {\n                return response.json();\n              }).then(function (res) {\n                var result = {};\n\n                if (res.token) {\n                  result.profile = jwtDecode(res.token);\n                  result.token = res.token;\n                  return result;\n                } else {\n                  return res;\n                }\n              })[\"catch\"](function (error) {\n                return {\n                  error: error\n                };\n              });\n\n            case 4:\n              return _context.abrupt(\"return\", _context.sent);\n\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function (_x) {\n      return _ref.apply(this, arguments);\n    };\n  }());\n};\n\nexport default new JwtAuth();","map":null,"metadata":{},"sourceType":"module"}