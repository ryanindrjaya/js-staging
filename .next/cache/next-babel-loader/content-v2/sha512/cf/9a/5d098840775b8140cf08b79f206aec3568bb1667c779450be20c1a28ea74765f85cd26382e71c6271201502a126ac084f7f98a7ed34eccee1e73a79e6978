{"ast":null,"code":"import _PrinterOutlined from \"@ant-design/icons/lib/icons/PrinterOutlined\";\nimport React from \"react\";\nimport nookies from \"nookies\";\nimport ReactToPrint from \"react-to-print\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nconst Print = ({\n  props\n}) => {\n  const name = process.env.STAKEHOLDER_NAME;\n  const noPO = props.purchases.data.attributes.no_po;\n  const date = new Date(props.purchases.data.attributes.order_date).toLocaleDateString(\"id-ID\");\n  const supplierName = props.purchases.data.attributes.supplier.data.attributes.name;\n  const supplierAddress = props.purchases.data.attributes.supplier.data.attributes.address;\n  const destination = props.purchases.data.attributes.location.data.attributes;\n  const destionationName = destination.name;\n  const destinationStreet = `${destination.street} `;\n  const destinationAddress = `${destination.city} ${destination.province} ${destination.postal_code} ${destination.country}`;\n  const items = props.purchases.data.attributes.purchase_details.data;\n  const deliveryFee = props.purchases.data.attributes.delivery_fee;\n  const TotalHarga = props.purchases.data.attributes.delivery_total;\n  var index = 0;\n\n  const getHargaSatuan = (unit, index) => {\n    var price = 0;\n    const product = props.purchases.data.attributes.purchase_details.data[index - 1].attributes.products.data[0];\n\n    for (let index = 1; index < 6; index++) {\n      if (product.attributes[`unit_${index}`] === unit) {\n        price = product.attributes[`buy_price_${index}`];\n      }\n    }\n\n    return formatter.format(price);\n  };\n\n  const getProductDisc = (unit, index) => {\n    var disc1 = 0;\n    var disc2 = 0;\n    var disc3 = 0;\n    const discInput = props.purchases.data.attributes.purchase_details.data[index - 1].attributes.disc;\n    const product = props.purchases.data.attributes.purchase_details.data[index - 1].attributes.products.data[0];\n\n    for (let index = 1; index < 6; index++) {\n      if (product.attributes[`unit_${index}`] === unit) {\n        disc1 = product.attributes[`unit_${index}_dp1`];\n        disc2 = product.attributes[`unit_${index}_dp2`];\n        disc3 = product.attributes[`unit_${index}_dp3`];\n      }\n    }\n\n    return `${formatter.format(discInput)}, ${disc1}%, ${disc2}%, ${disc3}%`;\n  };\n\n  const getSubTotal = index => {\n    var subTotal = props.purchases.data.attributes.purchase_details.data[index - 1].attributes.sub_total;\n    return formatter.format(subTotal);\n  };\n\n  const getTotalProduct = () => {\n    var total = 0;\n    props.purchases.data.attributes.purchase_details.data.forEach(element => {\n      total = total + element.attributes.sub_total;\n    });\n    return formatter.format(total);\n  };\n\n  const getAdditionalFee = () => {\n    var desc1 = props.purchases.data.attributes[`additional_fee_1_desc`];\n    var desc2 = props.purchases.data.attributes[`additional_fee_2_desc`];\n    var desc3 = props.purchases.data.attributes[`additional_fee_3_desc`];\n    var desc4 = props.purchases.data.attributes[`additional_fee_4_desc`];\n    var desc5 = props.purchases.data.attributes[`additional_fee_5_desc`];\n    var disc1 = formatter.format(props.purchases.data.attributes[`additional_fee_1_sub`]);\n    var disc2 = formatter.format(props.purchases.data.attributes[`additional_fee_2_sub`]);\n    var disc3 = formatter.format(props.purchases.data.attributes[`additional_fee_3_sub`]);\n    var disc4 = formatter.format(props.purchases.data.attributes[`additional_fee_4_sub`]);\n    var disc5 = formatter.format(props.purchases.data.attributes[`additional_fee_5_sub`]);\n    return /*#__PURE__*/_jsxs(\"div\", {\n      className: \"text-right\",\n      children: [disc1 !== \"Rp 0\" ? /*#__PURE__*/_jsxs(\"div\", {\n        children: [desc1, \" : \", disc1]\n      }) : /*#__PURE__*/_jsx(\"div\", {}), disc2 !== \"Rp 0\" ? /*#__PURE__*/_jsxs(\"div\", {\n        children: [desc2, \" : \", disc2]\n      }) : /*#__PURE__*/_jsx(\"div\", {}), disc3 !== \"Rp 0\" ? /*#__PURE__*/_jsxs(\"div\", {\n        children: [desc3, \" : \", disc3]\n      }) : /*#__PURE__*/_jsx(\"div\", {}), disc4 !== \"Rp 0\" ? /*#__PURE__*/_jsxs(\"div\", {\n        children: [desc4, \" : \", disc4]\n      }) : /*#__PURE__*/_jsx(\"div\", {}), disc5 !== \"Rp 0\" ? /*#__PURE__*/_jsxs(\"div\", {\n        children: [desc5, \" : \", disc5]\n      }) : /*#__PURE__*/_jsx(\"div\", {})]\n    });\n  };\n\n  const print = () => {\n    window.print();\n    return false;\n  };\n\n  var formatter = new Intl.NumberFormat(\"id-ID\", {\n    style: \"currency\",\n    currency: \"IDR\",\n    maximumFractionDigits: 0\n  });\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: \"m-3\",\n    children: [/*#__PURE__*/_jsx(\"div\", {\n      className: \"flex justify-end mb-5\",\n      children: /*#__PURE__*/_jsxs(\"button\", {\n        onClick: print,\n        class: \"print:hidden rounded-full bg-sky-400 px-4 py-2 font-bold text-white\",\n        children: [/*#__PURE__*/_jsx(\"span\", {\n          children: /*#__PURE__*/_jsx(_PrinterOutlined, {\n            className: \"mr-1 text-lg\"\n          })\n        }), \" \", \"Cetak Dokumen\"]\n      })\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      id: \"printableArea\",\n      className: \"flex justify-between\",\n      children: [/*#__PURE__*/_jsx(\"div\", {\n        className: \"font-bold text-lg\",\n        children: name\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        children: [/*#__PURE__*/_jsxs(\"div\", {\n          className: \"\",\n          children: [\"NO : \", noPO]\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"\",\n          children: [\"Tanggal : \", date]\n        })]\n      })]\n    }), /*#__PURE__*/_jsx(\"div\", {\n      className: \"font-bold text-lg flex justify-center mb-5\",\n      children: \"ORDER PEMBELIAN\"\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: \"flex justify-between mb-5\",\n      children: [/*#__PURE__*/_jsxs(\"div\", {\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"font-bold text-sm\",\n          children: \"KEPADA\"\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"font-bold text-sm uppercase\",\n          children: [\"Nama Supplier : \", supplierName]\n        }), /*#__PURE__*/_jsx(\"div\", {\n          children: supplierAddress\n        })]\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        children: [/*#__PURE__*/_jsxs(\"div\", {\n          className: \"font-bold  text-sm uppercase\",\n          children: [\"ALAMAT PENGIRIMAN : \", destionationName]\n        }), /*#__PURE__*/_jsx(\"div\", {\n          children: destinationStreet\n        }), /*#__PURE__*/_jsx(\"div\", {\n          children: destinationAddress\n        })]\n      })]\n    }), /*#__PURE__*/_jsx(\"div\", {\n      className: \"flex justify-between\",\n      children: /*#__PURE__*/_jsxs(\"table\", {\n        className: \"w-full\",\n        children: [/*#__PURE__*/_jsxs(\"tr\", {\n          className: \"p-2\",\n          children: [/*#__PURE__*/_jsx(\"th\", {\n            className: \"border-2 p-2\",\n            children: \"NO\"\n          }), /*#__PURE__*/_jsx(\"th\", {\n            className: \"border-2 p-2\",\n            children: \"ITEM\"\n          }), /*#__PURE__*/_jsx(\"th\", {\n            className: \"border-2 p-2\",\n            children: \"HARGA SATUAN\"\n          }), /*#__PURE__*/_jsx(\"th\", {\n            className: \"border-2 p-2\",\n            children: \"TOTAL UNIT\"\n          }), /*#__PURE__*/_jsx(\"th\", {\n            className: \"border-2 p-2\",\n            children: \"DISC\"\n          }), /*#__PURE__*/_jsx(\"th\", {\n            className: \"border-2 p-2\",\n            children: \"TOTAL HARGA\"\n          })]\n        }), items.map(element => {\n          index++;\n          return /*#__PURE__*/_jsxs(\"tr\", {\n            children: [/*#__PURE__*/_jsx(\"td\", {\n              className: \"border-2 p-2\",\n              children: index\n            }), /*#__PURE__*/_jsx(\"td\", {\n              className: \"border-2 p-2\",\n              children: element.attributes.products.data[0].attributes.name\n            }), /*#__PURE__*/_jsx(\"td\", {\n              className: \"border-2 p-2\",\n              children: getHargaSatuan(element.attributes.unit_order, index)\n            }), /*#__PURE__*/_jsxs(\"td\", {\n              className: \"border-2 p-2\",\n              children: [element.attributes.total_order, \" \", element.attributes.unit_order]\n            }), /*#__PURE__*/_jsx(\"td\", {\n              className: \"border-2 p-2\",\n              children: getProductDisc(element.attributes.unit_order, index)\n            }), /*#__PURE__*/_jsx(\"td\", {\n              className: \"border-2 p-2\",\n              children: getSubTotal(index)\n            })]\n          });\n        })]\n      })\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: \"font-bold  text-sm uppercase mt-3 flex justify-end\",\n      children: [\"TOTAL HARGA : \", getTotalProduct()]\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: \"font-bold  text-sm uppercase mt-4 flex justify-end\",\n      children: [\"BIAYA PENGIRIMAN : \", formatter.format(deliveryFee)]\n    }), /*#__PURE__*/_jsx(\"div\", {\n      className: \"font-bold  text-sm uppercase mt-4 flex justify-end\",\n      children: \"TAMBAHAN :\"\n    }), /*#__PURE__*/_jsx(\"div\", {\n      className: \" text-sm uppercase mt-2 flex justify-end\",\n      children: getAdditionalFee()\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: \"font-bold  text-sm uppercase mt-4 flex justify-end\",\n      children: [\"TOTAL PESANAN : \", formatter.format(TotalHarga)]\n    }), /*#__PURE__*/_jsx(\"div\", {\n      className: \"font-bold  text-sm uppercase mt-10 flex justify-end\",\n      children: \"HORMAT KAMI\"\n    }), /*#__PURE__*/_jsx(\"div\", {\n      className: \"font-bold  text-sm uppercase mt-10 flex justify-end\",\n      children: \"_____________________________\"\n    })]\n  });\n};\n\nPrint.getInitialProps = async context => {\n  const cookies = nookies.get(context);\n  const id = context.query.id;\n  const endpoint = process.env.NEXT_PUBLIC_URL + \"/purchases/\" + id + \"?populate=deep\";\n  const options = {\n    method: \"GET\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Authorization: \"Bearer \" + cookies.token\n    }\n  };\n  const res = await fetch(endpoint, options);\n  const purchases = await res.json();\n  return {\n    props: {\n      purchases\n    }\n  };\n};\n\nexport default Print;","map":null,"metadata":{},"sourceType":"module"}