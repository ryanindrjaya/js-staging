{"ast":null,"code":"import _Popover from \"antd/lib/popover\";\nimport _Tag from \"antd/lib/tag\";\nimport _CalculatorOutlined from \"@ant-design/icons/lib/icons/CalculatorOutlined\";\nimport _EditOutlined from \"@ant-design/icons/lib/icons/EditOutlined\";\nimport _UnorderedListOutlined from \"@ant-design/icons/lib/icons/UnorderedListOutlined\";\nimport _PrinterOutlined from \"@ant-design/icons/lib/icons/PrinterOutlined\";\nimport _Select from \"antd/lib/select\";\nimport DataTable from \"react-data-table-component\";\nimport AlertDialog from \"../../Alert/AlertCancel\";\nimport { useRouter } from \"next/router\";\nimport { IoIosSwap } from \"react-icons/io\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nexport default function ReactDataTable({\n  data,\n  onDelete,\n  onUpdate,\n  onPageChange,\n  onChangeStatus\n}) {\n  var _data$meta, _data$meta$pagination;\n\n  const router = useRouter();\n  const {\n    Option\n  } = _Select;\n  const tagRed = process.env.TAG_RED;\n  const tagGreen = process.env.TAG_GREEN;\n  const tagOrange = process.env.TAG_ORANGE;\n\n  const print = row => {\n    router.push(\"pembelian_barang/print/\" + row.id); // router.push('/dashboard')\n  };\n\n  const lihat = row => {\n    router.push(\"pembelian_barang/print/\" + row.id);\n  };\n\n  const pembayaran = row => {\n    router.push(\"pembelian_barang/pembayaran/\" + row.id);\n  };\n\n  const retur = row => {\n    router.push(\"retur/\" + row.id);\n  };\n\n  const onConfirm = (id, row) => {\n    console.log(id);\n    onDelete(id, row);\n  };\n\n  const onCancel = () => {\n    console.log(\"onCancel\");\n  };\n\n  const onEdit = id => {\n    onUpdate(id);\n  };\n\n  function formatMyDate(value, locale = \"id-ID\") {\n    return new Date(value).toLocaleDateString(locale);\n  }\n\n  var formatter = new Intl.NumberFormat(\"id-ID\", {\n    style: \"currency\",\n    currency: \"IDR\",\n    maximumFractionDigits: 0\n  });\n\n  const content = row => /*#__PURE__*/_jsxs(\"div\", {\n    children: [/*#__PURE__*/_jsx(\"div\", {\n      children: /*#__PURE__*/_jsxs(\"button\", {\n        onClick: () => print(row),\n        className: \" hover:text-cyan-700 transition-colors  text-xs font-normal py-2 px-2 rounded-md \",\n        children: [/*#__PURE__*/_jsx(_PrinterOutlined, {\n          className: \"mr-2 mt-0.5 float float-left\"\n        }), \"Cetak\"]\n      })\n    }), /*#__PURE__*/_jsx(\"div\", {\n      children: /*#__PURE__*/_jsxs(\"button\", {\n        onClick: () => lihat(row),\n        className: \" hover:text-cyan-700 transition-colors  text-xs font-normal py-2 px-2 rounded-md \",\n        children: [/*#__PURE__*/_jsx(_UnorderedListOutlined, {\n          className: \"mr-2 mt-0.5 float float-left\"\n        }), \"Lihat\"]\n      })\n    }), row.attributes.status === \"Diterima\" ? /*#__PURE__*/_jsx(\"div\", {}) : /*#__PURE__*/_jsxs(\"button\", {\n      onClick: () => onEdit(row.id),\n      className: \" hover:text-cyan-700 transition-colors  text-xs font-normal py-2 px-2 rounded-md \",\n      children: [/*#__PURE__*/_jsx(_EditOutlined, {\n        className: \"mr-2 mt-0.5 float float-left\"\n      }), \"Edit\"]\n    }), /*#__PURE__*/_jsx(AlertDialog, {\n      onCancel: onCancel,\n      onConfirm: e => onConfirm(e, row),\n      title: \"Batalkan Transaksi\",\n      message: \"Transaksi yang dibatalkan tidak dapat dikembalikan lagi. Lanjutkan?\",\n      id: row.id\n    }), /*#__PURE__*/_jsx(\"div\", {\n      className: \"mt-4\",\n      children: /*#__PURE__*/_jsxs(\"button\", {\n        onClick: () => pembayaran(row),\n        className: \" hover:text-cyan-700 transition-colors  text-xs font-normal py-2 px-2 rounded-md \",\n        children: [/*#__PURE__*/_jsx(_CalculatorOutlined, {\n          className: \"mr-2 mt-0.5 float float-left\"\n        }), \"Pembayaran\"]\n      })\n    }), /*#__PURE__*/_jsx(\"div\", {\n      children: /*#__PURE__*/_jsxs(\"button\", {\n        onClick: () => retur(row),\n        className: \" hover:text-cyan-700 transition-colors  text-xs font-normal py-2 px-2 rounded-md \",\n        children: [/*#__PURE__*/_jsx(IoIosSwap, {\n          className: \"mr-2 mt-0.5 float float-left\"\n        }), \"Retur Pembelian\"]\n      })\n    })]\n  });\n\n  const customStyles = {\n    headerStyle: {\n      textAlign: \"center\"\n    },\n    headCells: {\n      style: {\n        color: \"white\",\n        background: \"#036B82\"\n      }\n    }\n  };\n  const columns = [{\n    name: \"NO LPB\",\n    width: \"180px\",\n    selector: row => {\n      var _row$attributes$no_pu, _row$attributes;\n\n      return (_row$attributes$no_pu = (_row$attributes = row.attributes) === null || _row$attributes === void 0 ? void 0 : _row$attributes.no_purchasing) !== null && _row$attributes$no_pu !== void 0 ? _row$attributes$no_pu : \"-\";\n    }\n  }, {\n    name: \"Supplier\",\n    width: \"180px\",\n    selector: row => {\n      var _row$attributes$suppl, _row$attributes2;\n\n      return (_row$attributes$suppl = (_row$attributes2 = row.attributes) === null || _row$attributes2 === void 0 ? void 0 : _row$attributes2.supplier.data.attributes.name) !== null && _row$attributes$suppl !== void 0 ? _row$attributes$suppl : \"-\";\n    }\n  }, {\n    name: \"Nota Supplier\",\n    width: \"180px\",\n    selector: row => {\n      var _row$attributes$no_no, _row$attributes3;\n\n      return (_row$attributes$no_no = (_row$attributes3 = row.attributes) === null || _row$attributes3 === void 0 ? void 0 : _row$attributes3.no_nota_suppplier) !== null && _row$attributes$no_no !== void 0 ? _row$attributes$no_no : \"-\";\n    }\n  }, {\n    name: \"Tanggal\",\n    width: \"150px\",\n    selector: row => {\n      var _row$attributes4;\n\n      return formatMyDate((_row$attributes4 = row.attributes) === null || _row$attributes4 === void 0 ? void 0 : _row$attributes4.date_purchasing);\n    }\n  }, {\n    name: \"Lokasi\",\n    width: \"200px\",\n    selector: row => {\n      var _row$attributes5;\n\n      return (_row$attributes5 = row.attributes) === null || _row$attributes5 === void 0 ? void 0 : _row$attributes5.location.data.attributes.name;\n    }\n  }, {\n    name: \"Status\",\n    width: \"200px\",\n    selector: row => {\n      return /*#__PURE__*/_jsx(_Fragment, {\n        children: /*#__PURE__*/_jsxs(_Select, {\n          defaultValue: row.attributes.status,\n          bordered: false,\n          disabled: row.attributes.status === \"Selesai\" || row.attributes.status === \"Dibatalkan\",\n          onChange: e => onChangeStatus(e, row),\n          style: {\n            width: \"150px\"\n          },\n          children: [/*#__PURE__*/_jsx(Option, {\n            value: \"Diproses\",\n            className: \"text-black\",\n            children: /*#__PURE__*/_jsx(_Tag, {\n              color: \"default\",\n              children: \"Diproses\"\n            })\n          }, \"Diproses\"), /*#__PURE__*/_jsx(Option, {\n            value: \"Dibatalkan\",\n            className: \"text-black\",\n            children: /*#__PURE__*/_jsx(_Tag, {\n              color: \"error\",\n              children: \"Dibatalkan\"\n            })\n          }, \"Dibatalkan\"), /*#__PURE__*/_jsx(Option, {\n            value: \"Selesai\",\n            className: \"text-black\",\n            children: /*#__PURE__*/_jsx(_Tag, {\n              color: \"success\",\n              children: \"Selesai\"\n            })\n          }, \"Selesai\")]\n        })\n      });\n    }\n  }, {\n    name: \"Tempo\",\n    width: \"150px\",\n    selector: row => {\n      var _row$attributes6, _row$attributes$tempo, _row$attributes7, _row$attributes8, _row$attributes9, _row$attributes10;\n\n      var tempoDate = new Date((_row$attributes6 = row.attributes) === null || _row$attributes6 === void 0 ? void 0 : _row$attributes6.date_purchasing);\n      var tempoTime = parseInt((_row$attributes$tempo = (_row$attributes7 = row.attributes) === null || _row$attributes7 === void 0 ? void 0 : _row$attributes7.tempo_days) !== null && _row$attributes$tempo !== void 0 ? _row$attributes$tempo : 0);\n      var today = new Date();\n      var isTempo = false;\n      var statusPembayaran = (_row$attributes8 = row.attributes) === null || _row$attributes8 === void 0 ? void 0 : _row$attributes8.status_pembayaran;\n      var purchasingHistory = (_row$attributes9 = row.attributes) === null || _row$attributes9 === void 0 ? void 0 : _row$attributes9.purchasing_payments.data;\n\n      if (((_row$attributes10 = row.attributes) === null || _row$attributes10 === void 0 ? void 0 : _row$attributes10.tempo_time) === \"Hari\") {\n        tempoDate.setDate(tempoDate.getDate() + tempoTime);\n      } else {\n        tempoDate.setDate(tempoDate.getMonth() + tempoTime);\n      }\n\n      if (tempoDate < today) {\n        isTempo = true;\n      }\n\n      if (isTempo) {\n        if (statusPembayaran === \"Belum Lunas\") {\n          return /*#__PURE__*/_jsx(_Tag, {\n            color: \"red\",\n            children: \"Tempo\"\n          });\n        } else if (statusPembayaran === \"Lunas\") {\n          return /*#__PURE__*/_jsx(_Tag, {\n            color: \"green\",\n            children: \"Selesai\"\n          });\n        }\n      } else {\n        if (statusPembayaran === \"Belum Lunas\" && purchasingHistory.length > 0) {\n          return /*#__PURE__*/_jsx(_Tag, {\n            color: tagRed,\n            children: \"Tempo\"\n          });\n        } else if (statusPembayaran === \"Lunas\" && purchasingHistory.length > 0) {\n          return /*#__PURE__*/_jsx(_Tag, {\n            color: tagGreen,\n            children: \"Selesai\"\n          });\n        } else {\n          return /*#__PURE__*/_jsx(_Tag, {\n            color: tagOrange,\n            children: \"Menunggu\"\n          });\n        }\n      }\n\n      return /*#__PURE__*/_jsx(_Tag, {\n        color: tagOrange,\n        children: \"Menunggu\"\n      });\n    }\n  }, {\n    name: \"Pembayaran\",\n    width: \"150px\",\n    selector: row => {\n      var _row$attributes$purch, _row$attributes$purch2;\n\n      const lastIndex = (_row$attributes$purch = row.attributes.purchasing_payments) === null || _row$attributes$purch === void 0 ? void 0 : (_row$attributes$purch2 = _row$attributes$purch.data) === null || _row$attributes$purch2 === void 0 ? void 0 : _row$attributes$purch2.length;\n      const lastPayment = row.attributes.purchasing_payments.data[lastIndex - 1];\n\n      if ((lastPayment === null || lastPayment === void 0 ? void 0 : lastPayment.attributes.payment_remaining) === (lastPayment === null || lastPayment === void 0 ? void 0 : lastPayment.attributes.total_payment)) {\n        return /*#__PURE__*/_jsx(_Tag, {\n          color: tagRed,\n          children: \"Belum Dibayar\"\n        });\n      } else if ((lastPayment === null || lastPayment === void 0 ? void 0 : lastPayment.attributes.payment_remaining) > 0 && (lastPayment === null || lastPayment === void 0 ? void 0 : lastPayment.attributes.payment_remaining) < (lastPayment === null || lastPayment === void 0 ? void 0 : lastPayment.attributes.total_payment)) {\n        return /*#__PURE__*/_jsx(_Tag, {\n          color: tagOrange,\n          children: \"Dibayar Sebagian\"\n        });\n      } else if ((lastPayment === null || lastPayment === void 0 ? void 0 : lastPayment.attributes.payment_remaining) <= 0) {\n        return /*#__PURE__*/_jsx(_Tag, {\n          color: tagGreen,\n          children: \"Selesai\"\n        });\n      } else {\n        return /*#__PURE__*/_jsx(_Tag, {\n          color: tagOrange,\n          children: \"Dibayar Sebagian\"\n        });\n      }\n    }\n  }, {\n    name: \"Total Beli\",\n    width: \"150px\",\n    selector: row => {\n      var _row$attributes$total, _row$attributes11;\n\n      return formatter.format((_row$attributes$total = (_row$attributes11 = row.attributes) === null || _row$attributes11 === void 0 ? void 0 : _row$attributes11.total_purchasing) !== null && _row$attributes$total !== void 0 ? _row$attributes$total : 0);\n    }\n  }, {\n    name: \"Tindakan\",\n    width: \"250px\",\n    selector: row => /*#__PURE__*/_jsx(_Fragment, {\n      children: /*#__PURE__*/_jsx(_Popover, {\n        content: content(row),\n        placement: \"bottom\",\n        trigger: \"click\",\n        children: /*#__PURE__*/_jsx(\"button\", {\n          className: \" text-cyan-700  transition-colors  text-xs font-normal py-2 rounded-md \",\n          children: \"Tindakan\"\n        })\n      })\n    })\n  }];\n  return /*#__PURE__*/_jsx(DataTable, {\n    customStyles: customStyles,\n    onChangePage: onPageChange,\n    paginationRowsPerPageOptions: [10],\n    paginationTotalRows: data === null || data === void 0 ? void 0 : (_data$meta = data.meta) === null || _data$meta === void 0 ? void 0 : (_data$meta$pagination = _data$meta.pagination) === null || _data$meta$pagination === void 0 ? void 0 : _data$meta$pagination.total,\n    columns: columns,\n    data: data.data,\n    pagination: true,\n    noDataComponent: \"Belum ada data Pembelian\"\n  });\n}","map":null,"metadata":{},"sourceType":"module"}