{"ast":null,"code":"import _Row from \"antd/lib/row\";\nimport Barcode from \"react-jsbarcode\";\nimport { QRCodeSVG } from \"qrcode.react\";\nimport Head from \"next/head\";\nimport React from \"react\";\nimport LayoutContent from \"@iso/components/utility/layoutContent\";\nimport LayoutWrapper from \"@iso/components/utility/layoutWrapper.js\";\nimport nookies from \"nookies\";\nimport DashboardLayout from \"../../../../../containers/DashboardLayout/DashboardLayout\";\nimport TitlePage from \"../../../../../components/TitlePage/TitlePage\";\nimport HistoryTable from \"../../../../../components/ReactDataTable/Product/HistoryTable\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\n\nHistory.getInitialProps = async context => {\n  const cookies = nookies.get(context);\n  const test = context.query;\n  const locationId = context.query.locationId;\n  const productId = context.query.productId;\n  const reqInventory = await fetchInventory(cookies, productId, locationId);\n  const inventory = await reqInventory.json();\n  const reqProduct = await fetchProduct(cookies, productId, locationId);\n  const product = await reqProduct.json();\n  const reqHistory = await fetchHistory(cookies, productId, locationId);\n  const history = await reqHistory.json();\n  return {\n    props: {\n      inventory,\n      product,\n      history\n    }\n  };\n};\n\nconst fetchProduct = async (cookies, productId) => {\n  const endpoint = process.env.NEXT_PUBLIC_URL + `/products/` + productId;\n  const options = {\n    method: \"GET\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Authorization: \"Bearer \" + cookies.token\n    }\n  };\n  const req = await fetch(endpoint, options);\n  return req;\n};\n\nconst fetchInventory = async (cookies, productId, locationId) => {\n  const endpoint = process.env.NEXT_PUBLIC_URL + `/inventories?filters[locations][id][$eq]=${locationId}&filters[products][id][$eq]=${productId}&populate=*`;\n  const options = {\n    method: \"GET\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Authorization: \"Bearer \" + cookies.token\n    }\n  };\n  const req = await fetch(endpoint, options);\n  return req;\n};\n\nconst fetchHistory = async (cookies, productId, locationId) => {\n  const endpoint = process.env.NEXT_PUBLIC_URL + `/inventory-details?filters[locations][id][$eq]=${locationId}&filters[products][id][$eq]=${productId}&populate=*`;\n  const options = {\n    method: \"GET\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Authorization: \"Bearer \" + cookies.token\n    }\n  };\n  const req = await fetch(endpoint, options);\n  return req;\n};\n\nfunction formatMyDate(value, locale = \"id-ID\") {\n  return new Date(value).toLocaleDateString(locale);\n}\n\nfunction History({\n  props\n}) {\n  const product = props.product.data.attributes;\n  const inventory = props.inventory.data[0].attributes;\n  const historyList = props.history.data;\n  const smallesUnit = historyList[0].attributes.smallest_unit;\n  console.log(props);\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsx(Head, {\n      children: /*#__PURE__*/_jsx(\"title\", {\n        children: \"Riwayat Produk\"\n      })\n    }), /*#__PURE__*/_jsx(DashboardLayout, {\n      children: /*#__PURE__*/_jsxs(LayoutWrapper, {\n        style: {},\n        children: [/*#__PURE__*/_jsx(TitlePage, {\n          titleText: \"Riwayat Produk\"\n        }), /*#__PURE__*/_jsx(LayoutContent, {\n          children: /*#__PURE__*/_jsxs(\"div\", {\n            children: [/*#__PURE__*/_jsxs(_Row, {\n              justify: \"space-between\",\n              children: [/*#__PURE__*/_jsxs(\"div\", {\n                children: [/*#__PURE__*/_jsx(\"div\", {\n                  className: \"font-bold text-lg mb-4 uppercase\",\n                  children: product.name\n                }), /*#__PURE__*/_jsxs(\"div\", {\n                  className: \"text-sm mb-2\",\n                  children: [\"SKU : \", product === null || product === void 0 ? void 0 : product.SKU]\n                }), /*#__PURE__*/_jsxs(\"div\", {\n                  className: \"text-sm\",\n                  children: [\"Total Stok : \", inventory === null || inventory === void 0 ? void 0 : inventory.total_stock, \" \", smallesUnit]\n                })]\n              }), /*#__PURE__*/_jsx(\"div\", {\n                children: /*#__PURE__*/_jsxs(_Row, {\n                  children: [/*#__PURE__*/_jsx(Barcode, {\n                    value: product === null || product === void 0 ? void 0 : product.SKU,\n                    options: {\n                      format: \"code128\",\n                      width: \"2px\",\n                      height: \"50px\"\n                    },\n                    renderer: \"svg\"\n                  }), /*#__PURE__*/_jsx(QRCodeSVG, {\n                    className: \"ml-5\",\n                    height: 80,\n                    width: 80,\n                    value: product === null || product === void 0 ? void 0 : product.SKU\n                  })]\n                })\n              })]\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"font-bold text-lg mt-5 mb-3 uppercase\",\n              children: \"Daftar Stok\"\n            }), /*#__PURE__*/_jsx(HistoryTable, {\n              data: historyList\n            })]\n          })\n        })]\n      })\n    })]\n  });\n}\n\nexport default History;","map":null,"metadata":{},"sourceType":"module"}