{"ast":null,"code":"import Head from \"next/head\";\nimport React, { useState } from \"react\";\nimport LayoutContent from \"@iso/components/utility/layoutContent\";\nimport DashboardLayout from \"../../../containers/DashboardLayout/DashboardLayout\";\nimport LayoutWrapper from \"@iso/components/utility/layoutWrapper.js\";\nimport RoleTable from \"../../../components/ReactDataTable/RoleTable\";\nimport { useRouter } from \"next/router\";\nimport TitlePage from \"../../../components/TitlePage/TitlePage\";\nimport { toast } from \"react-toastify\";\nimport nookies from \"nookies\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\n\nconst Role = ({\n  props\n}) => {\n  console.log(props);\n  const data = props.data.roles.filter(function (value, index, arr) {\n    return index > 1;\n  });\n  const {\n    0: role,\n    1: setRole\n  } = useState(data);\n  const router = useRouter();\n\n  const handleAddUser = () => {\n    router.push(\"/dashboard/role/tambah\");\n  };\n\n  const handleDelete = async id => {\n    const endpoint = process.env.NEXT_PUBLIC_URL + \"/users-permissions/roles/\" + id;\n    const cookies = nookies.get(null, \"token\");\n    const options = {\n      method: \"DELETE\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + cookies.token\n      }\n    };\n    const req = await fetch(endpoint, options);\n    const res = await req.json();\n\n    if (res) {\n      const req = await fetchData(cookies);\n      const data = await req.json();\n      const roleData = data.roles.filter(function (value, index, arr) {\n        return index > 1;\n      });\n      setRole(roleData);\n      toast.success(\"Role berhasil dihapus\");\n    }\n  };\n\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsx(Head, {\n      children: /*#__PURE__*/_jsx(\"title\", {\n        children: \"Daftar Pengguna\"\n      })\n    }), /*#__PURE__*/_jsx(DashboardLayout, {\n      children: /*#__PURE__*/_jsxs(LayoutWrapper, {\n        style: {},\n        children: [/*#__PURE__*/_jsx(TitlePage, {\n          titleText: \"Role\"\n        }), /*#__PURE__*/_jsxs(LayoutContent, {\n          children: [/*#__PURE__*/_jsx(\"button\", {\n            onClick: handleAddUser,\n            type: \"button\",\n            className: \"bg-cyan-700 rounded px-5 py-2 hover:bg-cyan-800  shadow-sm flex float-right mb-5\",\n            children: /*#__PURE__*/_jsx(\"div\", {\n              className: \"text-white text-center text-sm font-bold\",\n              children: /*#__PURE__*/_jsx(\"a\", {\n                className: \"text-white no-underline text-xs sm:text-xs\",\n                children: \"+ Tambah\"\n              })\n            })\n          }), /*#__PURE__*/_jsx(RoleTable, {\n            roleData: role,\n            onDelete: handleDelete\n          })]\n        })]\n      })\n    })]\n  });\n};\n\nRole.getInitialProps = async context => {\n  const cookies = nookies.get(context);\n  let data;\n  const req = await fetchData(cookies);\n  data = await req.json();\n  return {\n    props: {\n      data\n    }\n  };\n};\n\nconst fetchData = async cookies => {\n  const endpoint = process.env.NEXT_PUBLIC_URL + \"/users-permissions/roles\";\n  const options = {\n    method: \"GET\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Authorization: \"Bearer \" + cookies.token\n    }\n  };\n  const req = await fetch(endpoint, options);\n  console.log(endpoint);\n  return req;\n};\n\nexport default Role;","map":null,"metadata":{},"sourceType":"module"}