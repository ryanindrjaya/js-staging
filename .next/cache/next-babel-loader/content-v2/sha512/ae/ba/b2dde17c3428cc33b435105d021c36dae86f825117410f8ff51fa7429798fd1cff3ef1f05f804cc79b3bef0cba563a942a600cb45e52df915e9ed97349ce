{"ast":null,"code":"import _Spin from \"antd/lib/spin\";\nimport _toConsumableArray from \"/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/JS-Deploy/node_modules/next/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/JS-Deploy/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _regeneratorRuntime from \"/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/JS-Deploy/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport moment from \"moment\";\nimport React, { useState } from \"react\";\nimport writeXlsxFile from \"write-excel-file\";\nimport { HEADER_ROW_1, HEADER_ROW_2, columnsWidth } from \"./utils/ExcelStyles\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nexport default function ExportProduk(_ref) {\n  var _ref$data = _ref.data,\n      data = _ref$data === void 0 ? [] : _ref$data,\n      setProduct = _ref.setProduct;\n\n  var _useState = useState(false),\n      loading = _useState[0],\n      setLoading = _useState[1];\n\n  var excelData = [HEADER_ROW_1, HEADER_ROW_2];\n\n  var exportData = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var time, productData, writeFile;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setLoading(true);\n              time = moment().unix();\n\n              if (data.length > 0) {\n                productData = data.map(function (product) {\n                  var _attributes$category$, _attributes$category$2, _attributes$group$dat, _attributes$group$dat2, _attributes$manufactu, _attributes$manufactu2, _ref3, _attributes$sub_categ, _attributes$sub_categ2;\n\n                  var attributes = product.attributes; // kategori, golongan, lokasi, pabrikasi, sub kategori\n\n                  var kategori = \"\".concat((_attributes$category$ = attributes.category.data) === null || _attributes$category$ === void 0 ? void 0 : _attributes$category$.attributes.category_id, \" - \").concat((_attributes$category$2 = attributes.category.data) === null || _attributes$category$2 === void 0 ? void 0 : _attributes$category$2.attributes.name) || \"\";\n                  var golongan = \"\".concat((_attributes$group$dat = attributes.group.data) === null || _attributes$group$dat === void 0 ? void 0 : _attributes$group$dat.attributes.alias, \" - \").concat((_attributes$group$dat2 = attributes.group.data) === null || _attributes$group$dat2 === void 0 ? void 0 : _attributes$group$dat2.attributes.name) || \"\";\n                  var pabrikasi = \"\".concat((_attributes$manufactu = attributes.manufacture.data) === null || _attributes$manufactu === void 0 ? void 0 : _attributes$manufactu.attributes.code, \" - \").concat((_attributes$manufactu2 = attributes.manufacture.data) === null || _attributes$manufactu2 === void 0 ? void 0 : _attributes$manufactu2.attributes.name) || \"\";\n                  var subKategori = (_ref3 = \"\".concat((_attributes$sub_categ = attributes.sub_category.data) === null || _attributes$sub_categ === void 0 ? void 0 : _attributes$sub_categ.attributes.sub_id, \" - \").concat((_attributes$sub_categ2 = attributes.sub_category.data) === null || _attributes$sub_categ2 === void 0 ? void 0 : _attributes$sub_categ2.attributes.name)) !== null && _ref3 !== void 0 ? _ref3 : \"\"; // proses data lokasi\n\n                  var dataLokasi = attributes.locations.data.map(function (location) {\n                    return location.attributes.name;\n                  }) || [];\n                  var lokasi = dataLokasi.join(\", \") || \"\";\n                  var SKU = attributes.SKU,\n                      buy_price_1 = attributes.buy_price_1,\n                      buy_price_2 = attributes.buy_price_2,\n                      buy_price_3 = attributes.buy_price_3,\n                      buy_price_4 = attributes.buy_price_4,\n                      buy_price_5 = attributes.buy_price_5,\n                      description = attributes.description,\n                      disc_1_1 = attributes.disc_1_1,\n                      disc_1_2 = attributes.disc_1_2,\n                      disc_1_3 = attributes.disc_1_3,\n                      disc_1_4 = attributes.disc_1_4,\n                      disc_1_5 = attributes.disc_1_5,\n                      name = attributes.name,\n                      pricelist_1 = attributes.pricelist_1,\n                      pricelist_2 = attributes.pricelist_2,\n                      pricelist_3 = attributes.pricelist_3,\n                      pricelist_4 = attributes.pricelist_4,\n                      pricelist_5 = attributes.pricelist_5,\n                      purchase_discount_1 = attributes.purchase_discount_1,\n                      purchase_discount_2 = attributes.purchase_discount_2,\n                      purchase_discount_3 = attributes.purchase_discount_3,\n                      purchase_discount_4 = attributes.purchase_discount_4,\n                      purchase_discount_5 = attributes.purchase_discount_5,\n                      qty_1 = attributes.qty_1,\n                      qty_2 = attributes.qty_2,\n                      qty_3 = attributes.qty_3,\n                      qty_4 = attributes.qty_4,\n                      qty_5 = attributes.qty_5,\n                      sold_price_1 = attributes.sold_price_1,\n                      sold_price_2 = attributes.sold_price_2,\n                      sold_price_3 = attributes.sold_price_3,\n                      sold_price_4 = attributes.sold_price_4,\n                      sold_price_5 = attributes.sold_price_5,\n                      unit_1 = attributes.unit_1,\n                      unit_2 = attributes.unit_2,\n                      unit_3 = attributes.unit_3,\n                      unit_4 = attributes.unit_4,\n                      unit_5 = attributes.unit_5,\n                      unit_1_dp1 = attributes.unit_1_dp1,\n                      unit_1_dp2 = attributes.unit_1_dp2,\n                      unit_1_dp3 = attributes.unit_1_dp3,\n                      unit_1_dp4 = attributes.unit_1_dp4,\n                      unit_1_dp5 = attributes.unit_1_dp5,\n                      unit_2_dp1 = attributes.unit_2_dp1,\n                      unit_2_dp2 = attributes.unit_2_dp2,\n                      unit_2_dp3 = attributes.unit_2_dp3,\n                      unit_2_dp4 = attributes.unit_2_dp4,\n                      unit_2_dp5 = attributes.unit_2_dp5,\n                      unit_3_dp1 = attributes.unit_3_dp1,\n                      unit_3_dp2 = attributes.unit_3_dp2,\n                      unit_3_dp3 = attributes.unit_3_dp3,\n                      unit_3_dp4 = attributes.unit_3_dp4,\n                      unit_3_dp5 = attributes.unit_3_dp5,\n                      unit_4_dp1 = attributes.unit_4_dp1,\n                      unit_4_dp2 = attributes.unit_4_dp2,\n                      unit_4_dp3 = attributes.unit_4_dp3,\n                      unit_4_dp4 = attributes.unit_4_dp4,\n                      unit_4_dp5 = attributes.unit_4_dp5,\n                      unit_5_dp1 = attributes.unit_5_dp1,\n                      unit_5_dp2 = attributes.unit_5_dp2,\n                      unit_5_dp3 = attributes.unit_5_dp3,\n                      unit_5_dp4 = attributes.unit_5_dp4,\n                      unit_5_dp5 = attributes.unit_5_dp5;\n                  return [{\n                    value: SKU || \"\",\n                    fontSize: 11\n                  }, {\n                    value: name || \"\",\n                    fontSize: 11\n                  }, {\n                    value: kategori,\n                    fontSize: 11\n                  }, {\n                    value: subKategori,\n                    fontSize: 11\n                  }, {\n                    value: pabrikasi,\n                    fontSize: 11\n                  }, {\n                    value: golongan,\n                    fontSize: 11\n                  }, {\n                    value: lokasi,\n                    fontSize: 11\n                  }, {\n                    value: description || \"\",\n                    fontSize: 11\n                  }, {\n                    value: unit_1 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: qty_1 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: buy_price_1 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: purchase_discount_1 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: unit_1_dp1 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: unit_1_dp2 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: unit_1_dp3 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: pricelist_1 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: sold_price_1 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: disc_1_1 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: unit_2 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: qty_2 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: buy_price_2 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: purchase_discount_2 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: unit_2_dp1 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: unit_2_dp2 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: unit_2_dp3 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: pricelist_2 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: sold_price_2 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: disc_1_2 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: unit_3 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: qty_3 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: buy_price_3 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: purchase_discount_3 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: unit_3_dp1 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: unit_3_dp2 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: unit_3_dp3 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: pricelist_3 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: sold_price_3 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: disc_1_3 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: unit_4 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: qty_4 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: buy_price_4 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: purchase_discount_4 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: unit_4_dp1 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: unit_4_dp2 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: unit_4_dp3 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: pricelist_4 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: sold_price_4 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: disc_1_4 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: unit_5 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: qty_5 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: buy_price_5 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: purchase_discount_5 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: unit_5_dp1 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: unit_5_dp2 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: unit_5_dp3 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: pricelist_5 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: sold_price_5 || \"\",\n                    fontSize: 11\n                  }, {\n                    value: disc_1_5 || \"\",\n                    fontSize: 11\n                  }];\n                });\n                excelData.push.apply(excelData, _toConsumableArray(productData));\n              }\n\n              _context.prev = 3;\n              _context.next = 6;\n              return writeXlsxFile(excelData, {\n                columns: columnsWidth,\n                fileName: \"Data Produk_\".concat(time, \".xlsx\")\n              });\n\n            case 6:\n              writeFile = _context.sent;\n              _context.next = 12;\n              break;\n\n            case 9:\n              _context.prev = 9;\n              _context.t0 = _context[\"catch\"](3);\n              console.log(_context.t0);\n\n            case 12:\n              setLoading(false);\n\n            case 13:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[3, 9]]);\n    }));\n\n    return function exportData() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsx(_Fragment, {\n    children: loading ? /*#__PURE__*/_jsx(\"div\", {\n      className: \"w-full flex justify-center items-center h-10\",\n      children: /*#__PURE__*/_jsx(_Spin, {})\n    }) : /*#__PURE__*/_jsx(\"button\", {\n      onClick: exportData,\n      type: \"button\",\n      className: \"bg-cyan-700 text-xs font-bold text-white w-full rounded h-10 hover:bg-cyan-800  shadow-sm flex items-center justify-center float-right\",\n      children: \"Export Excel\"\n    })\n  });\n}","map":null,"metadata":{},"sourceType":"module"}