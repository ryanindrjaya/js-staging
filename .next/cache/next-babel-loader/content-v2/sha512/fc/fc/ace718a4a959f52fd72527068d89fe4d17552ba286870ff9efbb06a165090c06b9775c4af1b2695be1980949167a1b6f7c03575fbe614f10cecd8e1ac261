{"ast":null,"code":"import _Button from \"antd/lib/button\";\nimport _Spin from \"antd/lib/spin\";\nimport _InputNumber from \"antd/lib/input-number\";\nimport _Row from \"antd/lib/row\";\nimport _Select from \"antd/lib/select\";\nimport _DatePicker from \"antd/lib/date-picker\";\nimport _notification from \"antd/lib/notification\";\nimport _defineProperty from \"/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/ERP-Sejati/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _toConsumableArray from \"/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/ERP-Sejati/node_modules/next/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _Input from \"antd/lib/input\";\nimport _Form from \"antd/lib/form\";\nimport _slicedToArray from \"/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/ERP-Sejati/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _asyncToGenerator from \"/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/ERP-Sejati/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport _regeneratorRuntime from \"/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/ERP-Sejati/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport { useState, useEffect } from \"react\";\nimport { useRouter } from \"next/router\";\nimport Head from \"next/head\";\nimport LayoutContent from \"@iso/components/utility/layoutContent\";\nimport DashboardLayout from \"@iso/containers/DashboardLayout/DashboardLayout\";\nimport LayoutWrapper from \"@iso/components/utility/layoutWrapper.js\";\nimport TitlePage from \"@iso/components/TitlePage/TitlePage\";\nimport nookies from \"nookies\";\nimport { toast } from \"react-toastify\";\nimport SearchBar from \"@iso/components/Form/AddOrder/SearchBar\";\nimport Supplier from \"@iso/components/Form/AddOrder/SupplierForm\";\nimport LPBTable from \"@iso/components/ReactDataTable/Purchases/LPBTable\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport LoadingAnimations from \"@iso/components/Animations/Loading\";\nimport moment from \"moment\";\nimport createDetailPurchasing from \"../utility/createDetail\";\nimport createPurchasing from \"../utility/createPurchasing\";\nimport calculatePrice from \"../utility/calculatePrice\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\n\nTambah.getInitialProps = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(context) {\n    var cookies, locations, purchases, order, user, req, req2, req3, req4;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            cookies = nookies.get(context);\n            _context.next = 3;\n            return fetchData(cookies);\n\n          case 3:\n            req = _context.sent;\n            _context.next = 6;\n            return req.json();\n\n          case 6:\n            locations = _context.sent;\n            _context.next = 9;\n            return fetchDataPurchasing(cookies);\n\n          case 9:\n            req2 = _context.sent;\n            _context.next = 12;\n            return req2.json();\n\n          case 12:\n            purchases = _context.sent;\n            _context.next = 15;\n            return fetchDataPurchase(cookies);\n\n          case 15:\n            req3 = _context.sent;\n            _context.next = 18;\n            return req3.json();\n\n          case 18:\n            order = _context.sent;\n            _context.next = 21;\n            return fetchUser(cookies);\n\n          case 21:\n            req4 = _context.sent;\n            _context.next = 24;\n            return req4.json();\n\n          case 24:\n            user = _context.sent;\n            return _context.abrupt(\"return\", {\n              props: {\n                order: order,\n                purchases: purchases,\n                locations: locations,\n                user: user\n              }\n            });\n\n          case 26:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function (_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar fetchData = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(cookies) {\n    var endpoint, options, req;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            endpoint = process.env.NEXT_PUBLIC_URL + \"/locations\";\n            options = {\n              method: \"GET\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: \"Bearer \" + cookies.token\n              }\n            };\n            _context2.next = 4;\n            return fetch(endpoint, options);\n\n          case 4:\n            req = _context2.sent;\n            return _context2.abrupt(\"return\", req);\n\n          case 6:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n\n  return function fetchData(_x2) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nvar fetchDataPurchasing = /*#__PURE__*/function () {\n  var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(cookies) {\n    var endpoint, options, req;\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            endpoint = process.env.NEXT_PUBLIC_URL + \"/purchasings\";\n            options = {\n              method: \"GET\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: \"Bearer \" + cookies.token\n              }\n            };\n            _context3.next = 4;\n            return fetch(endpoint, options);\n\n          case 4:\n            req = _context3.sent;\n            return _context3.abrupt(\"return\", req);\n\n          case 6:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n\n  return function fetchDataPurchasing(_x3) {\n    return _ref3.apply(this, arguments);\n  };\n}();\n\nvar fetchDataPurchase = /*#__PURE__*/function () {\n  var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(cookies) {\n    var endpoint, options, req;\n    return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            endpoint = process.env.NEXT_PUBLIC_URL + \"/purchases/?populate=deep&filters[delivery_status][$eq]=Terkirim\";\n            options = {\n              method: \"GET\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: \"Bearer \" + cookies.token\n              }\n            };\n            _context4.next = 4;\n            return fetch(endpoint, options);\n\n          case 4:\n            req = _context4.sent;\n            return _context4.abrupt(\"return\", req);\n\n          case 6:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4);\n  }));\n\n  return function fetchDataPurchase(_x4) {\n    return _ref4.apply(this, arguments);\n  };\n}();\n\nvar fetchUser = /*#__PURE__*/function () {\n  var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(cookies) {\n    var endpoint, options, req;\n    return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            endpoint = process.env.NEXT_PUBLIC_URL + \"/users/me?populate=*\";\n            options = {\n              method: \"GET\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: \"Bearer \" + cookies.token\n              }\n            };\n            _context5.next = 4;\n            return fetch(endpoint, options);\n\n          case 4:\n            req = _context5.sent;\n            return _context5.abrupt(\"return\", req);\n\n          case 6:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, _callee5);\n  }));\n\n  return function fetchUser(_x5) {\n    return _ref5.apply(this, arguments);\n  };\n}();\n\nfunction Tambah(_ref6) {\n  var _props$purchases, _props$purchases$meta;\n\n  var props = _ref6.props;\n  var products = useSelector(function (state) {\n    return state.Order;\n  });\n  var dispatch = useDispatch();\n  var locations = props.locations.data;\n  var deliveredOrder = props.order.data;\n  var selectedProduct = products === null || products === void 0 ? void 0 : products.productList;\n  var user = props.user;\n\n  var _Form$useForm = _Form.useForm(),\n      _Form$useForm2 = _slicedToArray(_Form$useForm, 1),\n      form = _Form$useForm2[0];\n\n  var _useState = useState(false),\n      loading = _useState[0],\n      setLoading = _useState[1];\n\n  var _useState2 = useState([]),\n      productList = _useState2[0],\n      setProductList = _useState2[1];\n\n  var _useState3 = useState(),\n      supplier = _useState3[0],\n      setSupplier = _useState3[1];\n\n  var _useState4 = useState(0),\n      totalPrice = _useState4[0],\n      setTotalPrice = _useState4[1];\n\n  var _useState5 = useState(0),\n      grandTotal = _useState5[0],\n      setGrandTotal = _useState5[1];\n\n  var _useState6 = useState(),\n      additionalFee = _useState6[0],\n      setAdditionalFee = _useState6[1];\n\n  var _useState7 = useState(false),\n      isFetchinData = _useState7[0],\n      setIsFetchingData = _useState7[1];\n\n  var _useState8 = useState([]),\n      listId = _useState8[0],\n      setListId = _useState8[1];\n\n  var _useState9 = useState(),\n      dataValues = _useState9[0],\n      setDataValues = _useState9[1];\n\n  var _useState10 = useState(),\n      discType = _useState10[0],\n      setDiscType = _useState10[1];\n\n  var _useState11 = useState(0),\n      discPrice = _useState11[0],\n      setDiscPrice = _useState11[1];\n\n  var _useState12 = useState(0),\n      tempoDays = _useState12[0],\n      setTempoDays = _useState12[1];\n\n  var _useState13 = useState(\"Hari\"),\n      tempoOption = _useState13[0],\n      setTempoOption = _useState13[1];\n\n  var _useState14 = useState({}),\n      productTotalPrice = _useState14[0],\n      setProductTotalPrice = _useState14[1];\n\n  var _useState15 = useState({}),\n      productSubTotal = _useState15[0],\n      setProductSubTotal = _useState15[1];\n\n  var _useState16 = useState(),\n      preorderData = _useState16[0],\n      setPreOrderData = _useState16[1];\n\n  var router = useRouter();\n  var TextArea = _Input.TextArea;\n  var today = new Date();\n  var dd = String(today.getDate()).padStart(2, \"0\");\n  var mm = String(today.getMonth() + 1).padStart(2, \"0\"); //January is 0!\n\n  var yyyy = today.getFullYear(); // DPP & PPN\n\n  var dpp = 1.11;\n  var ppn = 0; // temp\n\n  var _useState17 = useState(0),\n      biayaTambahan = _useState17[0],\n      setBiayaTambahan = _useState17[1];\n\n  var _useState18 = useState(0),\n      biayaPengiriman = _useState18[0],\n      setBiayaPengiriman = _useState18[1];\n\n  var cookies = nookies.get(null, \"token\");\n  var tempList = []; // NO PO\n\n  var totalPurchases = String(((_props$purchases = props.purchases) === null || _props$purchases === void 0 ? void 0 : (_props$purchases$meta = _props$purchases.meta) === null || _props$purchases$meta === void 0 ? void 0 : _props$purchases$meta.pagination.total) + 1).padStart(3, \"0\");\n  var formatter = new Intl.NumberFormat(\"id-ID\", {\n    style: \"currency\",\n    currency: \"IDR\",\n    maximumFractionDigits: 0\n  });\n\n  var onFinish = /*#__PURE__*/function () {\n    var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(values) {\n      return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              setLoading(true);\n              setDataValues(values);\n              setLoading(false);\n\n            case 3:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6);\n    }));\n\n    return function onFinish(_x6) {\n      return _ref7.apply(this, arguments);\n    };\n  }();\n\n  var createDetailOrder = /*#__PURE__*/function () {\n    var _ref8 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7() {\n      return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              createDetailPurchasing(dataValues, products, productTotalPrice, productSubTotal, setListId, \"/purchasing-details\");\n\n            case 1:\n            case \"end\":\n              return _context7.stop();\n          }\n        }\n      }, _callee7);\n    }));\n\n    return function createDetailOrder() {\n      return _ref8.apply(this, arguments);\n    };\n  }();\n\n  var createOrder = /*#__PURE__*/function () {\n    var _ref9 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8(values) {\n      return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n        while (1) {\n          switch (_context8.prev = _context8.next) {\n            case 0:\n              _context8.next = 2;\n              return createPurchasing(products, grandTotal, totalPrice, values, listId, discPrice, form, router);\n\n            case 2:\n            case \"end\":\n              return _context8.stop();\n          }\n        }\n      }, _callee8);\n    }));\n\n    return function createOrder(_x7) {\n      return _ref9.apply(this, arguments);\n    };\n  }();\n\n  var onChange = /*#__PURE__*/function () {\n    var _ref10 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee9() {\n      var isDuplicatedData;\n      return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n        while (1) {\n          switch (_context9.prev = _context9.next) {\n            case 0:\n              isDuplicatedData = false;\n              tempList.find(function (item) {\n                productList.forEach(function (element) {\n                  if (element.id === item.id) isDuplicatedData = true;\n                });\n              });\n\n              if (!isDuplicatedData) {\n                setProductList(function (productList) {\n                  return [].concat(_toConsumableArray(productList), [tempList[0]]);\n                });\n                toast.success(\"Produk berhasil ditambahkan!\", {\n                  position: toast.POSITION.TOP_RIGHT,\n                  autoClose: 1000\n                });\n              }\n\n            case 3:\n            case \"end\":\n              return _context9.stop();\n          }\n        }\n      }, _callee9);\n    }));\n\n    return function onChange() {\n      return _ref10.apply(this, arguments);\n    };\n  }();\n\n  var calculatePriceAfterDisc = function calculatePriceAfterDisc(row) {\n    var total = calculatePrice(row, products, productTotalPrice, productSubTotal, setTotalPrice);\n    return formatter.format(total);\n  };\n\n  var sumAdditionalPrice = function sumAdditionalPrice() {\n    var newTotal = 0;\n\n    for (var key in additionalFee) {\n      newTotal = newTotal + additionalFee[key];\n    }\n\n    var test = totalPrice + newTotal;\n    setBiayaTambahan(newTotal);\n  };\n\n  var fetchPOdata = /*#__PURE__*/function () {\n    var _ref11 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee10(id) {\n      var endpoint, options, req, res, dataPO, purchase_details, supplier, dateString, momentObj, momentString;\n      return _regeneratorRuntime.wrap(function _callee10$(_context10) {\n        while (1) {\n          switch (_context10.prev = _context10.next) {\n            case 0:\n              clearData();\n              setIsFetchingData(true);\n              endpoint = process.env.NEXT_PUBLIC_URL + \"/purchases/\".concat(id, \"?populate=deep\");\n              options = {\n                method: \"GET\",\n                headers: {\n                  \"Content-Type\": \"application/json\",\n                  Authorization: \"Bearer \" + cookies.token\n                }\n              };\n              _context10.next = 6;\n              return fetch(endpoint, options);\n\n            case 6:\n              req = _context10.sent;\n              _context10.next = 9;\n              return req.json();\n\n            case 9:\n              res = _context10.sent;\n              dataPO = res.data.attributes;\n              purchase_details = dataPO.purchase_details.data;\n              supplier = dataPO.supplier.data;\n              setDiscPrice(0);\n              setPreOrderData(res.data);\n              setSupplier(supplier);\n              setGrandTotal(dataPO.delivery_total);\n              setBiayaPengiriman(dataPO.delivery_fee);\n              dateString = dataPO.order_date;\n              momentObj = moment(dateString, \"YYYY-MM-DD\");\n              momentString = momentObj.format(\"MM-DD-YYYY\");\n              form.setFieldsValue({\n                supplier_id: \"\".concat(supplier.attributes.id_supplier, \" - \").concat(supplier.attributes.name),\n                order_date: moment(momentString),\n                location: dataPO.location.data.attributes.name,\n                tempo_days: dataPO.tempo_days,\n                tempo_time: dataPO.tempo_time,\n                additional_fee_1_desc: dataPO.additional_fee_1_desc,\n                additional_fee_2_desc: dataPO.additional_fee_2_desc,\n                additional_fee_3_desc: dataPO.additional_fee_3_desc,\n                additional_fee_4_desc: dataPO.additional_fee_4_desc,\n                additional_fee_5_desc: dataPO.additional_fee_5_desc,\n                additional_fee_1_sub: dataPO.additional_fee_1_sub,\n                additional_fee_2_sub: dataPO.additional_fee_2_sub,\n                additional_fee_3_sub: dataPO.additional_fee_3_sub,\n                additional_fee_4_sub: dataPO.additional_fee_4_sub,\n                additional_fee_5_sub: dataPO.additional_fee_5_sub,\n                additional_note: dataPO.additional_note,\n                delivery_fee: dataPO.delivery_fee,\n                disc_type: null,\n                disc_value: null,\n                DPP_active: null,\n                PPN_active: null\n              });\n              setAdditionalFee(_objectSpread(_objectSpread({}, additionalFee), {}, {\n                additional_fee_1_sub: dataPO.additional_fee_1_sub,\n                additional_fee_2_sub: dataPO.additional_fee_2_sub,\n                additional_fee_3_sub: dataPO.additional_fee_3_sub,\n                additional_fee_4_sub: dataPO.additional_fee_4_sub,\n                additional_fee_5_sub: dataPO.additional_fee_5_sub\n              }));\n              setNewGrandTotal(dataPO);\n              dispatch({\n                type: \"SET_PREORDER_DATA\",\n                data: res.data\n              });\n              purchase_details.forEach(function (element) {\n                var indexUnit = 1;\n                var unitOrder = element.attributes.unit_order;\n                var productUnit = element.attributes.products.data[0].attributes;\n\n                for (var index = 1; index < 6; index++) {\n                  if (unitOrder === productUnit[\"unit_\".concat(index)]) {\n                    indexUnit = index;\n                  }\n                }\n\n                var productId = element.attributes.products.data[0].id;\n                form.setFieldsValue({\n                  disc_rp: _defineProperty({}, productId, element.attributes.disc),\n                  jumlah_option: _defineProperty({}, productId, element.attributes.unit_order),\n                  jumlah_qty: _defineProperty({}, productId, element.attributes.total_order)\n                });\n                var test = form.getFieldsValue([\"disc_rp\", \"jumlah_option\", \"jumlah_qty\"]); // SET INITIAL PRODUCT\n\n                dispatch({\n                  type: \"SET_INITIAL_PRODUCT\",\n                  product: element.attributes.products.data[0],\n                  qty: element.attributes.total_order,\n                  unit: element.attributes.unit_order,\n                  unitIndex: indexUnit,\n                  priceUnit: element.attributes.unit_price,\n                  disc: element.attributes.disc,\n                  priceAfterDisc: element.attributes.unit_price_after_disc,\n                  subTotal: element.attributes.sub_total,\n                  d1: element.attributes.products.data[0].attributes.unit_1_dp1,\n                  d2: element.attributes.products.data[0].attributes.unit_1_dp2,\n                  d3: element.attributes.products.data[0].attributes.unit_1_dp3\n                });\n              });\n              setTimeout(function () {\n                setIsFetchingData(false);\n              }, 3000);\n\n            case 27:\n            case \"end\":\n              return _context10.stop();\n          }\n        }\n      }, _callee10);\n    }));\n\n    return function fetchPOdata(_x8) {\n      return _ref11.apply(this, arguments);\n    };\n  }();\n\n  var setNewGrandTotal = function setNewGrandTotal(data) {\n    var additionalPrice = 0;\n    var additionalPricePO = form.getFieldsValue([\"additional_fee_1_sub\", \"additional_fee_2_sub\", \"additional_fee_3_sub\", \"additional_fee_4_sub\", \"additional_fee_5_sub\"]);\n\n    for (var key in additionalPricePO) {\n      additionalPrice = additionalPrice + additionalPricePO[key];\n    }\n\n    setBiayaTambahan(additionalPrice);\n  };\n\n  var setTotalWithDisc = function setTotalWithDisc() {\n    var disc = form.getFieldsValue([\"disc_type\", \"disc_value\"]);\n\n    if (disc.disc_type === \"Tetap\") {\n      setTotalPriceWithFixedDisc(disc);\n    } else {\n      setTotalPriceWithPercentDisc(disc);\n    }\n  };\n\n  var setTotalPriceWithFixedDisc = function setTotalPriceWithFixedDisc(disc) {\n    var newTotal = 0;\n    newTotal = totalPrice - disc.disc_value;\n    setDiscPrice(newTotal);\n  };\n\n  var setTotalPriceWithPercentDisc = function setTotalPriceWithPercentDisc(disc) {\n    var newTotal = 0;\n    newTotal = totalPrice - totalPrice * disc.disc_value / 100;\n    if (newTotal < 0) newTotal = 0;\n    setDiscPrice(newTotal);\n  };\n\n  var setDPPActive = function setDPPActive(value) {\n    if (value) {\n      // fungsi gak guna karena balik lagi\n      form.setFieldsValue({\n        PPN_active: \"PPN\"\n      });\n      var newTotal = grandTotal;\n      var afterDPP = newTotal / dpp;\n      ppn = newTotal - afterDPP; // var total = afterDPP + ppn;\n    }\n  };\n\n  var clearData = function clearData() {\n    dispatch({\n      type: \"CLEAR_DATA\"\n    });\n    setTotalPrice(0);\n  };\n\n  useEffect(function () {\n    // this one is used for checking the price if the old price is same with new one.\n    // if both are same then we should not set new price for grand total.\n    // if they are not, then set new grand total\n    if (discPrice !== totalPrice && discPrice !== 0) {\n      setGrandTotal(discPrice + biayaPengiriman + biayaTambahan);\n    } else {\n      setGrandTotal(totalPrice + biayaPengiriman + biayaTambahan);\n    }\n  }, [biayaPengiriman, biayaTambahan, totalPrice, discPrice]);\n  useEffect(function () {\n    sumAdditionalPrice();\n  }, [additionalFee]);\n  useEffect(function () {\n    if (listId.length > 0) {\n      createOrder(dataValues);\n    }\n  }, [listId]);\n  useEffect(function () {\n    if (dataValues) createDetailOrder();\n  }, [dataValues]);\n  useEffect(function () {\n    // used to reset redux from value before\n    clearData();\n  }, []);\n\n  var onFinishFailed = function onFinishFailed() {\n    var error = form.getFieldsError();\n    error.forEach(function (element) {\n      if (element.errors.length > 0) {\n        console.log();\n\n        _notification[\"error\"]({\n          message: \"Field Kosong\",\n          description: element.errors[0]\n        });\n      }\n    });\n  };\n\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsx(Head, {\n      children: /*#__PURE__*/_jsx(\"title\", {\n        children: \"Tambahkan Pembelian Barang\"\n      })\n    }), /*#__PURE__*/_jsx(DashboardLayout, {\n      children: /*#__PURE__*/_jsxs(LayoutWrapper, {\n        style: {},\n        children: [/*#__PURE__*/_jsx(TitlePage, {\n          titleText: \"Tambah Lembar Pembelian Barang\"\n        }), /*#__PURE__*/_jsx(LayoutContent, {\n          children: /*#__PURE__*/_jsxs(_Form, {\n            form: form,\n            name: \"add_order\",\n            initialValues: {\n              remember: true\n            },\n            onFinish: onFinish,\n            onFinishFailed: onFinishFailed,\n            children: [/*#__PURE__*/_jsxs(\"div\", {\n              className: \"flex flex-wrap -mx-3 mb-3\",\n              children: [/*#__PURE__*/_jsx(\"div\", {\n                className: \"w-full md:w-1/4 px-3 mb-2 md:mb-0\",\n                children: /*#__PURE__*/_jsx(Supplier, {\n                  onChangeSupplier: setSupplier\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"w-full md:w-1/4 px-3 mb-2 md:mb-0\",\n                children: /*#__PURE__*/_jsx(_Form.Item, {\n                  name: \"no_purchasing\",\n                  initialValue: \"PB/ET/\".concat(totalPurchases, \"/\").concat(mm, \"/\").concat(yyyy),\n                  rules: [{\n                    required: true,\n                    message: \"Nomor PO tidak boleh kosong!\"\n                  }],\n                  children: /*#__PURE__*/_jsx(_Input, {\n                    style: {\n                      height: \"40px\"\n                    },\n                    placeholder: \"No.PO\"\n                  })\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"w-full md:w-1/4 px-3 mb-2 md:mb-0\",\n                children: /*#__PURE__*/_jsx(_Form.Item, {\n                  name: \"order_date\",\n                  rules: [{\n                    required: true,\n                    message: \"Tanggal tidak boleh kosong!\"\n                  }],\n                  children: /*#__PURE__*/_jsx(_DatePicker, {\n                    placeholder: \"Tanggal Pembelian\",\n                    size: \"large\",\n                    format: \"DD/MM/YYYY\",\n                    style: {\n                      width: \"100%\"\n                    }\n                  })\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"w-full md:w-1/4 px-3 mb-2 md:mb-0\",\n                children: /*#__PURE__*/_jsx(_Form.Item, {\n                  name: \"status\",\n                  initialValue: \"Diproses\",\n                  children: /*#__PURE__*/_jsxs(_Select, {\n                    size: \"large\",\n                    style: {\n                      width: \"100%\"\n                    },\n                    children: [/*#__PURE__*/_jsx(_Select.Option, {\n                      value: \"Diproses\",\n                      children: \"Diproses\"\n                    }, \"Diproses\"), /*#__PURE__*/_jsx(_Select.Option, {\n                      value: \"Selesai\",\n                      children: \"Selesai\"\n                    }, \"Selesai\")]\n                  })\n                })\n              }), /*#__PURE__*/_jsxs(\"div\", {\n                className: \"w-full md:w-2/4 px-3 mb-2 md:mb-0\",\n                children: [/*#__PURE__*/_jsx(\"p\", {\n                  className: \"font-bold m-0\",\n                  children: \"Alamat Supplier : \"\n                }), /*#__PURE__*/_jsxs(\"p\", {\n                  className: \"m-0\",\n                  children: [\" \", supplier === null || supplier === void 0 ? void 0 : supplier.attributes.address]\n                }), /*#__PURE__*/_jsxs(\"p\", {\n                  children: [\" \", supplier === null || supplier === void 0 ? void 0 : supplier.attributes.phone]\n                })]\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"w-full md:w-1/4 px-3 mb-2 md:mb-0\",\n                children: /*#__PURE__*/_jsx(_Form.Item, {\n                  name: \"location\",\n                  rules: [{\n                    required: true,\n                    message: \"Lokasi tidak boleh kosong!\"\n                  }],\n                  children: /*#__PURE__*/_jsx(_Select, {\n                    placeholder: \"Pilih Lokasi\",\n                    size: \"large\",\n                    style: {\n                      width: \"100%\"\n                    },\n                    children: locations.map(function (element) {\n                      return /*#__PURE__*/_jsx(_Select.Option, {\n                        value: element.id,\n                        children: element.attributes.name\n                      }, element.attributes.name);\n                    })\n                  })\n                })\n              }), /*#__PURE__*/_jsxs(\"div\", {\n                className: \"w-full md:w-1/4 px-3 mb-2 md:mb-0\",\n                children: [/*#__PURE__*/_jsx(_Form.Item, {\n                  name: \"tempo_days\",\n                  initialValue: 0,\n                  noStyle: true,\n                  children: /*#__PURE__*/_jsx(_Input, {\n                    size: \"large\",\n                    style: {\n                      width: \"50%\"\n                    },\n                    onChange: setTempoDays\n                  })\n                }), /*#__PURE__*/_jsx(_Form.Item, {\n                  name: \"tempo_time\",\n                  initialValue: \"Hari\",\n                  noStyle: true,\n                  children: /*#__PURE__*/_jsxs(_Select, {\n                    size: \"large\",\n                    onChange: setTempoOption,\n                    style: {\n                      width: \"50%\"\n                    },\n                    children: [/*#__PURE__*/_jsx(_Select.Option, {\n                      value: \"Hari\",\n                      children: \"Hari\"\n                    }, \"Hari\"), /*#__PURE__*/_jsx(_Select.Option, {\n                      value: \"Bulan\",\n                      children: \"Bulan\"\n                    }, \"Bulan\")]\n                  })\n                })]\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"w-full md:w-1/4 px-3 mb-2 mt-5 md:mb-0\",\n                children: /*#__PURE__*/_jsx(_Form.Item, {\n                  name: \"no_po\",\n                  children: /*#__PURE__*/_jsx(_Select, {\n                    placeholder: \"Pilih Nomor PO\",\n                    size: \"large\",\n                    onChange: function onChange(e) {\n                      return fetchPOdata(e);\n                    },\n                    style: {\n                      width: \"100%\"\n                    },\n                    children: deliveredOrder.map(function (element) {\n                      return /*#__PURE__*/_jsx(_Select.Option, {\n                        value: element.id,\n                        children: element.attributes.no_po\n                      }, element.id);\n                    })\n                  })\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"w-full md:w-1/4 px-3 mb-2 mt-5 md:mb-0\",\n                children: /*#__PURE__*/_jsx(_Form.Item, {\n                  name: \"no_nota_suppplier\",\n                  children: /*#__PURE__*/_jsx(_Input, {\n                    placeholder: \"No. Nota Supplier\",\n                    size: \"large\"\n                  })\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"w-full md:w-4/4 px-3 mb-2 mt-2 mx-0  md:mb-0\",\n                children: /*#__PURE__*/_jsx(SearchBar, {\n                  form: form,\n                  tempList: tempList,\n                  onChange: onChange,\n                  user: user,\n                  selectedProduct: selectedProduct,\n                  isBasedOnLocation: false\n                })\n              }), isFetchinData ? /*#__PURE__*/_jsxs(\"div\", {\n                className: \"w-full md:w-4/4 px-3 mb-2 mt-5 mx-3  md:mb-0 text-lg\",\n                children: [/*#__PURE__*/_jsx(\"div\", {\n                  className: \"w-36 h-36 flex p-4 max-w-sm mx-auto\",\n                  children: /*#__PURE__*/_jsx(LoadingAnimations, {})\n                }), /*#__PURE__*/_jsx(\"div\", {\n                  className: \"text-sm align-middle text-center animate-pulse text-slate-400\",\n                  children: \"Sedang Mengambil Data\"\n                })]\n              }) : /*#__PURE__*/_jsx(\"div\", {\n                className: \"w-full md:w-4/4 px-3 mb-2 mt-5 md:mb-0\",\n                children: /*#__PURE__*/_jsx(LPBTable, {\n                  products: products,\n                  productTotalPrice: productTotalPrice,\n                  setTotalPrice: setTotalPrice,\n                  setProductTotalPrice: setProductTotalPrice,\n                  calculatePriceAfterDisc: calculatePriceAfterDisc,\n                  productSubTotal: productSubTotal,\n                  locations: locations\n                })\n              })]\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"flex justify-end\",\n              children: /*#__PURE__*/_jsxs(\"p\", {\n                className: \"font-bold\",\n                children: [\"Total Item : \", products.productList.length, \" \"]\n              })\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"flex justify-end transition-all\",\n              children: /*#__PURE__*/_jsxs(_Row, {\n                children: [/*#__PURE__*/_jsx(\"p\", {\n                  className: \"font-bold\",\n                  children: \"Total Harga :\"\n                }), discPrice === 0 ? /*#__PURE__*/_jsx(\"p\", {}) : /*#__PURE__*/_jsx(\"p\", {\n                  className: \"font-bold text-red-500 ml-2\",\n                  children: formatter.format(discPrice)\n                }), discPrice === 0 ? /*#__PURE__*/_jsx(\"p\", {\n                  className: \"font-bold ml-2\",\n                  children: formatter.format(totalPrice)\n                }) : /*#__PURE__*/_jsx(\"p\", {\n                  className: \"font-bold line-through ml-2 \",\n                  children: formatter.format(totalPrice)\n                })]\n              })\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: \"flex flex-wrap -mx-3 mb-3\",\n              children: [/*#__PURE__*/_jsx(\"div\", {\n                className: \"w-full md:w-1/3 px-3 mt-5 md:mb-0\",\n                children: /*#__PURE__*/_jsx(_Form.Item, {\n                  name: \"disc_type\",\n                  children: /*#__PURE__*/_jsxs(_Select, {\n                    disabled: products.productList.length === 0,\n                    onChange: setDiscType,\n                    placeholder: \"Pilih Jenis Diskon\",\n                    size: \"large\",\n                    style: {\n                      width: \"100%\"\n                    },\n                    children: [/*#__PURE__*/_jsx(_Select.Option, {\n                      value: \"Tetap\",\n                      children: \"Tetap\"\n                    }, \"Tetap\"), /*#__PURE__*/_jsx(_Select.Option, {\n                      value: \"Persentase\",\n                      children: \"Persentase\"\n                    }, \"Persentase\")]\n                  })\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"w-full md:w-1/3 px-3 mt-5 md:mb-0\",\n                children: /*#__PURE__*/_jsx(_Form.Item, {\n                  name: \"disc_value\",\n                  noStyle: true,\n                  children: /*#__PURE__*/_jsx(_InputNumber, {\n                    disabled: products.productList.length === 0,\n                    onChange: setTotalWithDisc,\n                    size: \"large\",\n                    min: 0,\n                    placeholder: \"Diskon\",\n                    style: {\n                      width: \"100%\"\n                    }\n                  })\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"w-full md:w-1/3 px-3 mt-5 md:mb-0\",\n                children: /*#__PURE__*/_jsx(_Form.Item, {\n                  name: \"delivery_fee\",\n                  noStyle: true,\n                  children: /*#__PURE__*/_jsx(_InputNumber, {\n                    onChange: function onChange(e) {\n                      return setBiayaPengiriman(e);\n                    },\n                    size: \"large\",\n                    placeholder: \"Biaya Pengiriman\",\n                    style: {\n                      width: \"100%\"\n                    }\n                  })\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"w-full md:w-1/3 px-3 mt-5 md:mb-0\",\n                children: /*#__PURE__*/_jsx(_Form.Item, {\n                  name: \"DPP_active\",\n                  children: /*#__PURE__*/_jsx(_Select, {\n                    disabled: products.productList.length === 0,\n                    placeholder: \"Pakai DPP\",\n                    onChange: setDPPActive,\n                    size: \"large\",\n                    style: {\n                      width: \"100%\"\n                    },\n                    children: /*#__PURE__*/_jsx(_Select.Option, {\n                      value: \"DPP\",\n                      children: \"DPP\"\n                    }, \"DPP\")\n                  })\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"w-full md:w-1/3 px-3 mt-5 md:mb-0\",\n                children: /*#__PURE__*/_jsx(_Form.Item, {\n                  name: \"PPN_active\",\n                  children: /*#__PURE__*/_jsx(_Select, {\n                    disabled: true,\n                    placeholder: \"Pakai PPN\",\n                    size: \"large\",\n                    style: {\n                      width: \"100%\"\n                    },\n                    children: /*#__PURE__*/_jsx(_Select.Option, {\n                      value: \"PPN\",\n                      children: \"PPN\"\n                    }, \"PPN\")\n                  })\n                })\n              })]\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"flex justify-end font-bold w-full mb-3 md:w-3/4\",\n              children: /*#__PURE__*/_jsx(\"p\", {\n                children: \"Biaya Tambahan Lain-lain\"\n              })\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: \"flex justify-end\",\n              children: [/*#__PURE__*/_jsxs(\"div\", {\n                className: \"w-full md:w-1/3 px-3 mb-2 text-center md:mb-0\",\n                children: [/*#__PURE__*/_jsx(\"p\", {\n                  className: \"mb-4 font-bold\",\n                  children: \"Keterangan\"\n                }), /*#__PURE__*/_jsx(_Form.Item, {\n                  name: \"additional_fee_1_desc\",\n                  children: /*#__PURE__*/_jsx(_Input, {\n                    size: \"large\",\n                    style: {\n                      width: \"100%\"\n                    }\n                  })\n                }), /*#__PURE__*/_jsx(_Form.Item, {\n                  name: \"additional_fee_2_desc\",\n                  children: /*#__PURE__*/_jsx(_Input, {\n                    size: \"large\",\n                    style: {\n                      width: \"100%\"\n                    }\n                  })\n                }), /*#__PURE__*/_jsx(_Form.Item, {\n                  name: \"additional_fee_3_desc\",\n                  children: /*#__PURE__*/_jsx(_Input, {\n                    size: \"large\",\n                    style: {\n                      width: \"100%\"\n                    }\n                  })\n                }), /*#__PURE__*/_jsx(_Form.Item, {\n                  name: \"additional_fee_4_desc\",\n                  children: /*#__PURE__*/_jsx(_Input, {\n                    size: \"large\",\n                    style: {\n                      width: \"100%\"\n                    }\n                  })\n                }), /*#__PURE__*/_jsx(_Form.Item, {\n                  name: \"additional_fee_5_desc\",\n                  children: /*#__PURE__*/_jsx(_Input, {\n                    size: \"large\",\n                    style: {\n                      width: \"100%\"\n                    }\n                  })\n                })]\n              }), /*#__PURE__*/_jsxs(\"div\", {\n                className: \"w-full md:w-1/3 px-3 mb-2 text-center md:mb-0\",\n                children: [/*#__PURE__*/_jsx(\"p\", {\n                  className: \"mb-4 font-bold\",\n                  children: \"Jumlah\"\n                }), /*#__PURE__*/_jsx(_Form.Item, {\n                  name: \"additional_fee_1_sub\",\n                  children: /*#__PURE__*/_jsx(_InputNumber, {\n                    size: \"large\",\n                    style: {\n                      width: \"100%\"\n                    },\n                    onChange: function onChange(e) {\n                      return setAdditionalFee(_objectSpread(_objectSpread({}, additionalFee), {}, {\n                        additional_fee_1_sub: e\n                      }));\n                    }\n                  })\n                }), /*#__PURE__*/_jsx(_Form.Item, {\n                  name: \"additional_fee_2_sub\",\n                  children: /*#__PURE__*/_jsx(_InputNumber, {\n                    size: \"large\",\n                    style: {\n                      width: \"100%\"\n                    },\n                    onChange: function onChange(e) {\n                      return setAdditionalFee(_objectSpread(_objectSpread({}, additionalFee), {}, {\n                        additional_fee_2_sub: e\n                      }));\n                    }\n                  })\n                }), /*#__PURE__*/_jsx(_Form.Item, {\n                  name: \"additional_fee_3_sub\",\n                  children: /*#__PURE__*/_jsx(_InputNumber, {\n                    size: \"large\",\n                    style: {\n                      width: \"100%\"\n                    },\n                    onChange: function onChange(e) {\n                      return setAdditionalFee(_objectSpread(_objectSpread({}, additionalFee), {}, {\n                        additional_fee_3_sub: e\n                      }));\n                    }\n                  })\n                }), /*#__PURE__*/_jsx(_Form.Item, {\n                  name: \"additional_fee_4_sub\",\n                  children: /*#__PURE__*/_jsx(_InputNumber, {\n                    size: \"large\",\n                    style: {\n                      width: \"100%\"\n                    },\n                    onChange: function onChange(e) {\n                      return setAdditionalFee(_objectSpread(_objectSpread({}, additionalFee), {}, {\n                        additional_fee_4_sub: e\n                      }));\n                    }\n                  })\n                }), /*#__PURE__*/_jsx(_Form.Item, {\n                  name: \"additional_fee_5_sub\",\n                  children: /*#__PURE__*/_jsx(_InputNumber, {\n                    size: \"large\",\n                    style: {\n                      width: \"100%\"\n                    },\n                    onChange: function onChange(e) {\n                      return setAdditionalFee(_objectSpread(_objectSpread({}, additionalFee), {}, {\n                        additional_fee_5_sub: e\n                      }));\n                    }\n                  })\n                })]\n              })]\n            }), /*#__PURE__*/_jsx(\"div\", {\n              children: /*#__PURE__*/_jsxs(\"p\", {\n                className: \"font-bold flex justify-end\",\n                children: [\"Total Biaya : \", grandTotal === 0 ? formatter.format(totalPrice) : formatter.format(grandTotal)]\n              })\n            }), /*#__PURE__*/_jsx(_Form.Item, {\n              name: \"additional_note\",\n              children: /*#__PURE__*/_jsx(TextArea, {\n                rows: 4,\n                placeholder: \"Catatan Tambahan\"\n              })\n            }), /*#__PURE__*/_jsx(_Form.Item, {\n              className: \"mt-5\",\n              children: loading ? /*#__PURE__*/_jsx(\"div\", {\n                className: \" flex float-left ml-3 \",\n                children: /*#__PURE__*/_jsx(_Spin, {})\n              }) : /*#__PURE__*/_jsx(_Button, {\n                htmlType: \"submit\",\n                className: \" hover:text-white hover:bg-cyan-700 border border-cyan-700 ml-1\",\n                children: \"Tambah\"\n              })\n            })]\n          })\n        })]\n      })\n    })]\n  });\n}\n\nexport default Tambah;","map":null,"metadata":{},"sourceType":"module"}