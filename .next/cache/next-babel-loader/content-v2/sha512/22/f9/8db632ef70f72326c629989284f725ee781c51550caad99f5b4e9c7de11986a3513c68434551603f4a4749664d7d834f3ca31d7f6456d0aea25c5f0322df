{"ast":null,"code":"import _Modal from \"antd/lib/modal\";\nimport _asyncToGenerator from \"/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/ERP-Sejati/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _Input from \"antd/lib/input\";\n\nvar _jsxFileName = \"/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/ERP-Sejati/pages/dashboard/produk/index.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport _regeneratorRuntime from \"/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/ERP-Sejati/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport Head from \"next/head\";\nimport React, { useEffect, useState } from \"react\";\nimport LayoutContent from \"@iso/components/utility/layoutContent\";\nimport LayoutWrapper from \"@iso/components/utility/layoutWrapper.js\";\nimport { useRouter } from \"next/router\";\nimport { toast } from \"react-toastify\";\nimport nookies from \"nookies\";\nimport DashboardLayout from \"../../../containers/DashboardLayout/DashboardLayout\";\nimport TitlePage from \"../../../components/TitlePage/TitlePage\";\nimport ProductTable from \"../../../components/ReactDataTable/ProductTable\";\nimport ProductModal from \"../../../components/Modal/ProductModal\";\nimport UnitTableView from \"../../../components/ReactDataTable/Product/UnitsTableView\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nvar Product = function Product(_ref) {\n  _s();\n\n  var props = _ref.props;\n  var data = props.data;\n\n  var _useState = useState(false),\n      isLoading = _useState[0],\n      setIsLoading = _useState[1];\n\n  var _useState2 = useState(data),\n      product = _useState2[0],\n      setProduct = _useState2[1];\n\n  var _useState3 = useState(),\n      modalProduct = _useState3[0],\n      setModalProduct = _useState3[1];\n\n  var _useState4 = useState(false),\n      isSearching = _useState4[0],\n      setIsSearching = _useState4[1];\n\n  var _useState5 = useState(false),\n      visible = _useState5[0],\n      setVisible = _useState5[1];\n\n  var router = useRouter();\n\n  var _useState6 = useState(),\n      inventory = _useState6[0],\n      setInventory = _useState6[1];\n\n  var Search = _Input.Search;\n\n  var onSearch = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(e) {\n      var req, res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!(e.target.value.length >= 2)) {\n                _context.next = 12;\n                break;\n              }\n\n              setIsSearching(true);\n              _context.next = 4;\n              return searchQuery(e.target.value);\n\n            case 4:\n              req = _context.sent;\n              _context.next = 7;\n              return req.json();\n\n            case 7:\n              res = _context.sent;\n              setProduct(res);\n              setIsSearching(false);\n              _context.next = 14;\n              break;\n\n            case 12:\n              setProduct(data);\n              setIsSearching(false);\n\n            case 14:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function onSearch(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var searchQuery = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(keywords) {\n      var endpoint, cookies, options, req;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              endpoint = process.env.NEXT_PUBLIC_URL + \"/products?filters[$or][0][name][$contains]=\" + keywords + \"&filters[$or][1][SKU][$contains]=\" + keywords + \"&populate=*\";\n              cookies = nookies.get(null, \"token\");\n              options = {\n                method: \"GET\",\n                headers: {\n                  \"Content-Type\": \"application/json\",\n                  Authorization: \"Bearer \" + cookies.token\n                }\n              };\n              _context2.next = 5;\n              return fetch(endpoint, options);\n\n            case 5:\n              req = _context2.sent;\n              return _context2.abrupt(\"return\", req);\n\n            case 7:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function searchQuery(_x2) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var handleAdd = function handleAdd() {\n    console.log(\"\");\n    router.push(\"/dashboard/produk/tambah\");\n  };\n\n  var handleView = function handleView() {\n    router.push(\"/dashboard/produk/lihat\");\n  };\n\n  var handleUpdate = function handleUpdate(id) {\n    console.log(\"\");\n    router.push(\"/dashboard/produk/edit/\" + id);\n  };\n\n  var handleDelete = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(id) {\n      var endpoint, cookies, options, req, res, _req, _res;\n\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              endpoint = process.env.NEXT_PUBLIC_URL + \"/products/\" + id;\n              cookies = nookies.get(null, \"token\");\n              options = {\n                method: \"DELETE\",\n                headers: {\n                  \"Content-Type\": \"application/json\",\n                  Authorization: \"Bearer \" + cookies.token\n                }\n              };\n              _context3.next = 5;\n              return fetch(endpoint, options);\n\n            case 5:\n              req = _context3.sent;\n              _context3.next = 8;\n              return req.json();\n\n            case 8:\n              res = _context3.sent;\n\n              if (!res) {\n                _context3.next = 18;\n                break;\n              }\n\n              _context3.next = 12;\n              return fetchData(cookies);\n\n            case 12:\n              _req = _context3.sent;\n              _context3.next = 15;\n              return _req.json();\n\n            case 15:\n              _res = _context3.sent;\n              toast.success(\"Produk berhasil dihapus\");\n              setProduct(_res);\n\n            case 18:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function handleDelete(_x3) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var handlePageChange = /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(page) {\n      var cookies, endpoint, options, req, res;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              cookies = nookies.get(null, \"token\");\n              endpoint = process.env.NEXT_PUBLIC_URL + \"/products?pagination[page]=\" + page;\n              options = {\n                method: \"GET\",\n                headers: {\n                  \"Content-Type\": \"application/json\",\n                  Authorization: \"Bearer \" + cookies.token\n                }\n              };\n              _context4.prev = 3;\n              _context4.next = 6;\n              return fetch(endpoint, options);\n\n            case 6:\n              req = _context4.sent;\n              _context4.next = 9;\n              return req.json();\n\n            case 9:\n              res = _context4.sent;\n\n              if (res) {\n                setProduct(function (prevData) {\n                  return {\n                    data: filterDuplicateData(prevData.data.concat(res.data)),\n                    meta: prevData.meta\n                  };\n                });\n              } else {\n                console.log(\"something is wrong\");\n              }\n\n              _context4.next = 16;\n              break;\n\n            case 13:\n              _context4.prev = 13;\n              _context4.t0 = _context4[\"catch\"](3);\n              console.log(_context4.t0);\n\n            case 16:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4, null, [[3, 13]]);\n    }));\n\n    return function handlePageChange(_x4) {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  var filterDuplicateData = function filterDuplicateData(arr) {\n    var seen = new Set();\n    var filteredArr = arr.filter(function (el) {\n      var duplicate = seen.has(el.id);\n      seen.add(el.id);\n      return !duplicate;\n    });\n    return filteredArr;\n  };\n\n  var fetchInventory = /*#__PURE__*/function () {\n    var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(data) {\n      var cookies, endpoint, options, req, res;\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              setIsLoading(true);\n              cookies = nookies.get(null, \"token\");\n              endpoint = process.env.NEXT_PUBLIC_URL + \"/inventories?filters[products][id][$eq]=\".concat(data.id, \"&populate=locations\");\n              options = {\n                method: \"GET\",\n                headers: {\n                  \"Content-Type\": \"application/json\",\n                  Authorization: \"Bearer \" + cookies.token\n                }\n              };\n              _context5.next = 6;\n              return fetch(endpoint, options);\n\n            case 6:\n              req = _context5.sent;\n              _context5.next = 9;\n              return req.json();\n\n            case 9:\n              res = _context5.sent;\n              // return req;\n              // console.log(res);\n              setInventory(res.data); //\n\n            case 11:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }));\n\n    return function fetchInventory(_x5) {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n\n  var openModal = /*#__PURE__*/function () {\n    var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(e, data) {\n      return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              // console.log(\"test\", data);\n              setVisible(e);\n              fetchInventory(data);\n\n            case 2:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6);\n    }));\n\n    return function openModal(_x6, _x7) {\n      return _ref7.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    console.log(\"inventory\", inventory);\n    setIsLoading(false);\n  }, [inventory]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Head, {\n      children: /*#__PURE__*/_jsxDEV(\"title\", {\n        children: \"Produk\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(DashboardLayout, {\n      children: /*#__PURE__*/_jsxDEV(LayoutWrapper, {\n        style: {},\n        children: [/*#__PURE__*/_jsxDEV(TitlePage, {\n          titleText: \"Produk\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(LayoutContent, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-full flex justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(Search, {\n              className: \"\",\n              loading: isSearching,\n              onChange: function onChange(e) {\n                return onSearch(e);\n              },\n              placeholder: \"Cari Produk\",\n              style: {\n                width: 200\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 185,\n              columnNumber: 15\n            }, _this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: handleAdd,\n              type: \"button\",\n              className: \"bg-cyan-700 rounded px-5 py-2 hover:bg-cyan-800  shadow-sm flex float-right mb-5\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-white text-center text-sm font-bold\",\n                children: /*#__PURE__*/_jsxDEV(\"a\", {\n                  className: \"text-white no-underline text-xs sm:text-xs\",\n                  children: \"+ Tambah\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 200,\n                  columnNumber: 19\n                }, _this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 199,\n                columnNumber: 17\n              }, _this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 194,\n              columnNumber: 15\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 184,\n            columnNumber: 13\n          }, _this), /*#__PURE__*/_jsxDEV(_Modal, {\n            className: \"rounded-lg m-5\",\n            head: true,\n            width: \"90%\",\n            centered: true,\n            visible: visible,\n            onOk: function onOk() {\n              return setVisible(false);\n            },\n            onCancel: function onCancel() {\n              return setVisible(false);\n            },\n            bodyStyle: {\n              borderRadius: \"20px\",\n              backgroundColor: \"#fff\"\n            },\n            style: {\n              backgroundColor: \"#fff\"\n            },\n            footer: null,\n            children: /*#__PURE__*/_jsxDEV(ProductModal, {\n              data: modalProduct,\n              isLoading: isLoading,\n              inventory: inventory\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 224,\n              columnNumber: 15\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 207,\n            columnNumber: 13\n          }, _this), /*#__PURE__*/_jsxDEV(ProductTable, {\n            data: product,\n            onDelete: handleDelete,\n            onUpdate: handleUpdate,\n            onPageChange: handlePageChange,\n            setIsVisible: openModal,\n            setViewModalProduct: setModalProduct\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 231,\n            columnNumber: 13\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 11\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 7\n    }, _this)]\n  }, void 0, true);\n};\n\n_s(Product, \"GgdJmsnnCagMu/oVCrxbV48ak+Y=\", false, function () {\n  return [useRouter];\n});\n\n_c = Product;\n\nProduct.getInitialProps = /*#__PURE__*/function () {\n  var _ref8 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7(context) {\n    var cookies, data, req;\n    return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n      while (1) {\n        switch (_context7.prev = _context7.next) {\n          case 0:\n            cookies = nookies.get(context);\n            _context7.next = 3;\n            return fetchData(cookies);\n\n          case 3:\n            req = _context7.sent;\n            _context7.next = 6;\n            return req.json();\n\n          case 6:\n            data = _context7.sent;\n            return _context7.abrupt(\"return\", {\n              props: {\n                data: data\n              }\n            });\n\n          case 8:\n          case \"end\":\n            return _context7.stop();\n        }\n      }\n    }, _callee7);\n  }));\n\n  return function (_x8) {\n    return _ref8.apply(this, arguments);\n  };\n}();\n\nvar fetchData = /*#__PURE__*/function () {\n  var _ref9 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8(cookies) {\n    var endpoint, options, req;\n    return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n      while (1) {\n        switch (_context8.prev = _context8.next) {\n          case 0:\n            endpoint = process.env.NEXT_PUBLIC_URL + \"/products?populate=*\";\n            options = {\n              method: \"GET\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: \"Bearer \" + cookies.token\n              }\n            };\n            _context8.next = 4;\n            return fetch(endpoint, options);\n\n          case 4:\n            req = _context8.sent;\n            return _context8.abrupt(\"return\", req);\n\n          case 6:\n          case \"end\":\n            return _context8.stop();\n        }\n      }\n    }, _callee8);\n  }));\n\n  return function fetchData(_x9) {\n    return _ref9.apply(this, arguments);\n  };\n}();\n\nexport default Product;\n\nvar _c;\n\n$RefreshReg$(_c, \"Product\");","map":{"version":3,"sources":["/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/ERP-Sejati/pages/dashboard/produk/index.js"],"names":["Head","React","useEffect","useState","LayoutContent","LayoutWrapper","useRouter","toast","nookies","DashboardLayout","TitlePage","ProductTable","ProductModal","UnitTableView","Product","props","data","isLoading","setIsLoading","product","setProduct","modalProduct","setModalProduct","isSearching","setIsSearching","visible","setVisible","router","inventory","setInventory","Search","onSearch","e","target","value","length","searchQuery","req","json","res","keywords","endpoint","process","env","NEXT_PUBLIC_URL","cookies","get","options","method","headers","Authorization","token","fetch","handleAdd","console","log","push","handleView","handleUpdate","id","handleDelete","fetchData","success","handlePageChange","page","prevData","filterDuplicateData","concat","meta","arr","seen","Set","filteredArr","filter","el","duplicate","has","add","fetchInventory","openModal","width","borderRadius","backgroundColor","getInitialProps","context"],"mappings":"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","sourcesContent":["import Head from \"next/head\";\nimport React, { useEffect, useState } from \"react\";\nimport LayoutContent from \"@iso/components/utility/layoutContent\";\nimport LayoutWrapper from \"@iso/components/utility/layoutWrapper.js\";\nimport { useRouter } from \"next/router\";\nimport { toast } from \"react-toastify\";\nimport nookies from \"nookies\";\nimport DashboardLayout from \"../../../containers/DashboardLayout/DashboardLayout\";\nimport TitlePage from \"../../../components/TitlePage/TitlePage\";\nimport { Input, Modal } from \"antd\";\nimport ProductTable from \"../../../components/ReactDataTable/ProductTable\";\nimport ProductModal from \"../../../components/Modal/ProductModal\";\nimport UnitTableView from \"../../../components/ReactDataTable/Product/UnitsTableView\";\n\nconst Product = ({ props }) => {\n  const data = props.data;\n  const [isLoading, setIsLoading] = useState(false);\n  const [product, setProduct] = useState(data);\n  const [modalProduct, setModalProduct] = useState();\n  const [isSearching, setIsSearching] = useState(false);\n  const [visible, setVisible] = useState(false);\n  const router = useRouter();\n  const [inventory, setInventory] = useState();\n  const { Search } = Input;\n\n  const onSearch = async (e) => {\n    if (e.target.value.length >= 2) {\n      setIsSearching(true);\n\n      const req = await searchQuery(e.target.value);\n      const res = await req.json();\n\n      setProduct(res);\n      setIsSearching(false);\n    } else {\n      setProduct(data);\n      setIsSearching(false);\n    }\n  };\n\n  const searchQuery = async (keywords) => {\n    const endpoint =\n      process.env.NEXT_PUBLIC_URL +\n      \"/products?filters[$or][0][name][$contains]=\" +\n      keywords +\n      \"&filters[$or][1][SKU][$contains]=\" +\n      keywords +\n      \"&populate=*\";\n\n    const cookies = nookies.get(null, \"token\");\n    const options = {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + cookies.token,\n      },\n    };\n\n    const req = await fetch(endpoint, options);\n    return req;\n  };\n\n  const handleAdd = () => {\n    console.log(\"\");\n    router.push(\"/dashboard/produk/tambah\");\n  };\n\n  const handleView = () => {\n    router.push(\"/dashboard/produk/lihat\");\n  };\n\n  const handleUpdate = (id) => {\n    console.log(\"\");\n    router.push(\"/dashboard/produk/edit/\" + id);\n  };\n\n  const handleDelete = async (id) => {\n    const endpoint = process.env.NEXT_PUBLIC_URL + \"/products/\" + id;\n    const cookies = nookies.get(null, \"token\");\n\n    const options = {\n      method: \"DELETE\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + cookies.token,\n      },\n    };\n\n    const req = await fetch(endpoint, options);\n    const res = await req.json();\n    if (res) {\n      const req = await fetchData(cookies);\n      const res = await req.json();\n      toast.success(\"Produk berhasil dihapus\");\n      setProduct(res);\n    }\n  };\n\n  const handlePageChange = async (page) => {\n    const cookies = nookies.get(null, \"token\");\n    const endpoint =\n      process.env.NEXT_PUBLIC_URL + \"/products?pagination[page]=\" + page;\n\n    const options = {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + cookies.token,\n      },\n    };\n\n    try {\n      const req = await fetch(endpoint, options);\n      const res = await req.json();\n      if (res) {\n        setProduct((prevData) => ({\n          data: filterDuplicateData(prevData.data.concat(res.data)),\n          meta: prevData.meta,\n        }));\n      } else {\n        console.log(\"something is wrong\");\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const filterDuplicateData = (arr) => {\n    const seen = new Set();\n\n    const filteredArr = arr.filter((el) => {\n      const duplicate = seen.has(el.id);\n      seen.add(el.id);\n      return !duplicate;\n    });\n\n    return filteredArr;\n  };\n\n  const fetchInventory = async (data) => {\n    setIsLoading(true);\n    const cookies = nookies.get(null, \"token\");\n    const endpoint =\n      process.env.NEXT_PUBLIC_URL +\n      `/inventories?filters[products][id][$eq]=${data.id}&populate=locations`;\n    const options = {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + cookies.token,\n      },\n    };\n\n    const req = await fetch(endpoint, options);\n    const res = await req.json();\n    // return req;\n    // console.log(res);\n\n    setInventory(res.data);\n\n    //\n  };\n\n  const openModal = async (e, data) => {\n    // console.log(\"test\", data);\n    setVisible(e);\n    fetchInventory(data);\n  };\n\n  useEffect(() => {\n    console.log(\"inventory\", inventory);\n    setIsLoading(false);\n  }, [inventory]);\n\n  return (\n    <>\n      <Head>\n        <title>Produk</title>\n      </Head>\n      <DashboardLayout>\n        <LayoutWrapper style={{}}>\n          <TitlePage titleText={\"Produk\"} />\n          <LayoutContent>\n            <div className=\"w-full flex justify-between\">\n              <Search\n                className=\"\"\n                loading={isSearching}\n                onChange={(e) => onSearch(e)}\n                placeholder=\"Cari Produk\"\n                style={{\n                  width: 200,\n                }}\n              />\n              <button\n                onClick={handleAdd}\n                type=\"button\"\n                className=\"bg-cyan-700 rounded px-5 py-2 hover:bg-cyan-800  shadow-sm flex float-right mb-5\"\n              >\n                <div className=\"text-white text-center text-sm font-bold\">\n                  <a className=\"text-white no-underline text-xs sm:text-xs\">\n                    + Tambah\n                  </a>\n                </div>\n              </button>\n            </div>\n\n            <Modal\n              className=\"rounded-lg m-5\"\n              head\n              width={\"90%\"}\n              centered\n              visible={visible}\n              onOk={() => setVisible(false)}\n              onCancel={() => setVisible(false)}\n              bodyStyle={{\n                borderRadius: \"20px\",\n                backgroundColor: \"#fff\",\n              }}\n              style={{\n                backgroundColor: \"#fff\",\n              }}\n              footer={null}\n            >\n              <ProductModal\n                data={modalProduct}\n                isLoading={isLoading}\n                inventory={inventory}\n              />\n            </Modal>\n\n            <ProductTable\n              data={product}\n              onDelete={handleDelete}\n              onUpdate={handleUpdate}\n              onPageChange={handlePageChange}\n              setIsVisible={openModal}\n              setViewModalProduct={setModalProduct}\n            />\n          </LayoutContent>\n        </LayoutWrapper>\n      </DashboardLayout>\n    </>\n  );\n};\n\nProduct.getInitialProps = async (context) => {\n  const cookies = nookies.get(context);\n  let data;\n\n  const req = await fetchData(cookies);\n  data = await req.json();\n\n  return {\n    props: {\n      data,\n    },\n  };\n};\n\nconst fetchData = async (cookies) => {\n  const endpoint = process.env.NEXT_PUBLIC_URL + \"/products?populate=*\";\n  const options = {\n    method: \"GET\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Authorization: \"Bearer \" + cookies.token,\n    },\n  };\n\n  const req = await fetch(endpoint, options);\n  return req;\n};\n\nexport default Product;\n"]},"metadata":{},"sourceType":"module"}