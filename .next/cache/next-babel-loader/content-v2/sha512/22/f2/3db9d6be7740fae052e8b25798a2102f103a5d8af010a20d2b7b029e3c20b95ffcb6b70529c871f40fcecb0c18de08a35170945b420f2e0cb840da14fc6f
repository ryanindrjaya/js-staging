{"ast":null,"code":"import _asyncToGenerator from \"/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/ERP-Sejati/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/ERP-Sejati/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/ERP-Sejati/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _regeneratorRuntime from \"/Users/yudiananta/Development/NextJS/ERP Dev/JS Deploy/ERP-Sejati/node_modules/next/node_modules/@babel/runtime/regenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React from 'react';\nimport Button from '@iso/components/uielements/button';\nimport Input from '@iso/components/uielements/input';\nimport Modal from '@iso/components/Feedback/Modal';\nimport { notification } from '@iso/components';\nimport { signInWithEmail, signUpWithEmailAndPassword, resetPassword } from '@iso/lib/firebase/firebase.authentication.util';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nexport default function FirebaseForm(props) {\n  var _React$useState = React.useState({\n    visible: false,\n    email: 'demo@gmail.com',\n    password: 'demodemo',\n    confirmLoading: false\n  }),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      state = _React$useState2[0],\n      setState = _React$useState2[1];\n\n  var handleChange = function handleChange(e) {\n    var _e$target = e.target,\n        name = _e$target.name,\n        value = _e$target.value;\n    setState(_objectSpread(_objectSpread({}, state), {}, _defineProperty({}, name, value)));\n  };\n\n  var showModal = function showModal() {\n    setState(_objectSpread(_objectSpread({}, state), {}, {\n      visible: true\n    }));\n  };\n\n  var handleCancel = function handleCancel(e) {\n    setState(_objectSpread(_objectSpread({}, state), {}, {\n      visible: false\n    }));\n  };\n\n  var handleLogin = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var email, password, user, message, token;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              email = state.email, password = state.password;\n\n              if (email && password) {\n                _context.next = 4;\n                break;\n              }\n\n              notification('error', 'Please fill in email. and password');\n              return _context.abrupt(\"return\");\n\n            case 4:\n              setState(_objectSpread(_objectSpread({}, state), {}, {\n                confirmLoading: true\n              }));\n\n              if (!props.signup) {\n                _context.next = 17;\n                break;\n              }\n\n              _context.prev = 6;\n              _context.next = 9;\n              return signUpWithEmailAndPassword(email, password).then(function (authUser) {\n                user = authUser.user;\n                console.log(user, 'User');\n              });\n\n            case 9:\n              _context.next = 15;\n              break;\n\n            case 11:\n              _context.prev = 11;\n              _context.t0 = _context[\"catch\"](6);\n              message = _context.t0.message;\n              console.log(_context.t0.message, 'Error');\n\n            case 15:\n              _context.next = 26;\n              break;\n\n            case 17:\n              _context.prev = 17;\n              _context.next = 20;\n              return signInWithEmail(email, password).then(function (authUser) {\n                user = authUser.user;\n              });\n\n            case 20:\n              _context.next = 26;\n              break;\n\n            case 22:\n              _context.prev = 22;\n              _context.t1 = _context[\"catch\"](17);\n              message = _context.t1.message;\n              console.log(_context.t1.message, 'Error');\n\n            case 26:\n              if (!user) {\n                _context.next = 34;\n                break;\n              }\n\n              _context.next = 29;\n              return user.getIdToken();\n\n            case 29:\n              token = _context.sent;\n              props.login(token);\n              props.history.push('/dashboard');\n              _context.next = 36;\n              break;\n\n            case 34:\n              notification('error', message);\n              setState(_objectSpread(_objectSpread({}, state), {}, {\n                confirmLoading: false\n              }));\n\n            case 36:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[6, 11], [17, 22]]);\n    }));\n\n    return function handleLogin() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var handleResetPassword = function handleResetPassword() {\n    var email = state.email;\n\n    if (!email) {\n      notification('error', \"Please fill in email.\");\n      return;\n    }\n\n    resetPassword(email).then(function () {\n      return notification('success', \"Password reset email sent to \".concat(email, \".\"));\n    })[\"catch\"](function (error) {\n      return notification('error', 'Email address not found.');\n    });\n  };\n\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsx(Button, {\n      type: \"primary\",\n      onClick: showModal,\n      className: \"btnFirebase\",\n      children: props.signup ? 'Sign up with Firebase' : 'Sign in with Firebase'\n    }), /*#__PURE__*/_jsx(Modal, {\n      title: props.signup ? 'Sign up with Firebase' : 'Sign in with Firebase',\n      visible: state.visible,\n      confirmLoading: state.confirmLoading,\n      onCancel: handleCancel,\n      onOk: handleLogin,\n      className: \"isoFirebaseLoginModal\",\n      cancelText: \"Cancel\",\n      okText: props.signup ? 'Sign Up' : 'Login',\n      children: /*#__PURE__*/_jsxs(\"form\", {\n        children: [/*#__PURE__*/_jsxs(\"div\", {\n          className: \"isoInputWrapper\",\n          children: [/*#__PURE__*/_jsx(\"label\", {\n            children: \"Email\"\n          }), /*#__PURE__*/_jsx(Input, {\n            name: \"email\",\n            size: \"large\",\n            placeholder: \"Email\",\n            value: state.email,\n            onChange: handleChange\n          })]\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"isoInputWrapper\",\n          style: {\n            marginBottom: 10\n          },\n          children: [/*#__PURE__*/_jsx(\"label\", {\n            children: \"Password\"\n          }), /*#__PURE__*/_jsx(Input, {\n            name: \"password\",\n            type: \"password\",\n            size: \"large\",\n            placeholder: \"Password\",\n            value: state.password,\n            onChange: handleChange\n          })]\n        }), /*#__PURE__*/_jsx(\"span\", {\n          className: \"isoResetPass\",\n          onClick: handleResetPassword,\n          children: \"Reset Password\"\n        })]\n      })\n    })]\n  });\n}","map":null,"metadata":{},"sourceType":"module"}